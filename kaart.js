function z(){return function(){throw new Error("Unimplemented abstract method.")}()}var yu=0;function V(r){return r.ol_uid||(r.ol_uid=String(++yu))}var po="6.9.0";var xu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Xa=function(r){xu(e,r);function e(t){var i=this,n="v"+po.split("-")[0],a="Assertion failed. See https://openlayers.org/en/"+n+"/doc/errors/#"+t+" for details.";return i=r.call(this,a)||this,i.code=t,i.name="AssertionError",i.message=a,i}return e}(Error);function X(r,e){if(!r)throw new Xa(e)}function vo(r,e,t){for(var i,n,a=t||ge,s=0,o=r.length,h=!1;s<o;)i=s+(o-s>>1),n=+a(r[i],e),n<0?s=i+1:(o=i,h=!n);return h?s:~s}function ge(r,e){return r>e?1:r<e?-1:0}function Or(r,e,t){var i=r.length;if(r[0]<=e)return 0;if(e<=r[i-1])return i-1;var n=void 0;if(t>0){for(n=1;n<i;++n)if(r[n]<e)return n-1}else if(t<0){for(n=1;n<i;++n)if(r[n]<=e)return n}else for(n=1;n<i;++n){if(r[n]==e)return n;if(r[n]<e)return typeof t=="function"?t(e,r[n-1],r[n])>0?n-1:n:r[n-1]-e<e-r[n]?n-1:n}return i-1}function _o(r,e,t){for(;e<t;){var i=r[e];r[e]=r[t],r[t]=i,++e,--t}}function ye(r,e){for(var t=Array.isArray(e)?e:[e],i=t.length,n=0;n<i;n++)r[r.length]=t[n]}function oe(r,e){var t=r.length;if(t!==e.length)return!1;for(var i=0;i<t;i++)if(r[i]!==e[i])return!1;return!0}function mo(r,e,t){var i=e||ge;return r.every(function(n,a){if(a===0)return!0;var s=i(r[a-1],n);return!(s>0||t&&s===0)})}var nt=typeof Object.assign=="function"?Object.assign:function(r,e){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(r),i=1,n=arguments.length;i<n;++i){var a=arguments[i];if(a!=null)for(var s in a)a.hasOwnProperty(s)&&(t[s]=a[s])}return t};function qe(r){for(var e in r)delete r[e]}var Mn=typeof Object.values=="function"?Object.values:function(r){var e=[];for(var t in r)e.push(r[t]);return e};function Ke(r){var e;for(e in r)return!1;return!e}function H(r,e,t,i,n){if(i&&i!==r&&(t=t.bind(i)),n){var a=t;t=function(){r.removeEventListener(e,t),a.apply(this,arguments)}}var s={target:r,type:e,listener:t};return r.addEventListener(e,t),s}function Di(r,e,t,i){return H(r,e,t,i,!0)}function Q(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),qe(r))}var kt=function(){function r(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return r.prototype.preventDefault=function(){this.defaultPrevented=!0},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r}(),Tn=function(){function r(){this.disposed=!1}return r.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},r.prototype.disposeInternal=function(){},r}();function He(){return!0}function Rr(){return!1}function he(){}function go(r){var e=!1,t,i,n;return function(){var a=Array.prototype.slice.call(arguments);return(!e||this!==n||!oe(a,i))&&(e=!0,n=this,i=a,t=r.apply(this,arguments)),t}}var Eu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jt=function(r){Eu(e,r);function e(t){var i=r.call(this)||this;return i.eventTarget_=t,i.pendingRemovals_=null,i.dispatching_=null,i.listeners_=null,i}return e.prototype.addEventListener=function(t,i){if(!(!t||!i)){var n=this.listeners_||(this.listeners_={}),a=n[t]||(n[t]=[]);a.indexOf(i)===-1&&a.push(i)}},e.prototype.dispatchEvent=function(t){var i=typeof t=="string"?new kt(t):t,n=i.type;i.target||(i.target=this.eventTarget_||this);var a=this.listeners_&&this.listeners_[n],s;if(a){var o=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,h[n]=0),++o[n];for(var l=0,u=a.length;l<u;++l)if("handleEvent"in a[l]?s=a[l].handleEvent(i):s=a[l].call(this,i),s===!1||i.propagationStopped){s=!1;break}if(--o[n],o[n]===0){var f=h[n];for(delete h[n];f--;)this.removeEventListener(n,he);delete o[n]}return s}},e.prototype.disposeInternal=function(){this.listeners_&&qe(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,i){var n=this.listeners_&&this.listeners_[t];if(n){var a=n.indexOf(i);a!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[a]=he,++this.pendingRemovals_[t]):(n.splice(a,1),n.length===0&&delete this.listeners_[t]))}},e}(Tn);var D={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};var Mu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gi=function(r){Mu(e,r);function e(){var t=r.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(D.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,i){if(Array.isArray(t)){for(var n=t.length,a=new Array(n),s=0;s<n;++s)a[s]=H(this,t[s],i);return a}else return H(this,t,i)},e.prototype.onceInternal=function(t,i){var n;if(Array.isArray(t)){var a=t.length;n=new Array(a);for(var s=0;s<a;++s)n[s]=Di(this,t[s],i)}else n=Di(this,t,i);return i.ol_key=n,n},e.prototype.unInternal=function(t,i){var n=i.ol_key;if(n)Tu(n);else if(Array.isArray(t))for(var a=0,s=t.length;a<s;++a)this.removeEventListener(t[a],i);else this.removeEventListener(t,i)},e}(Jt);gi.prototype.on;gi.prototype.once;gi.prototype.un;function Tu(r){if(Array.isArray(r))for(var e=0,t=r.length;e<t;++e)Q(r[e]);else Q(r)}var je={PROPERTYCHANGE:"propertychange"},yo=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xo=function(r){yo(e,r);function e(t,i,n){var a=r.call(this,t)||this;return a.key=i,a.oldValue=n,a}return e}(kt),yt=function(r){yo(e,r);function e(t){var i=r.call(this)||this;return i.on,i.once,i.un,V(i),i.values_=null,t!==void 0&&i.setProperties(t),i}return e.prototype.get=function(t){var i;return this.values_&&this.values_.hasOwnProperty(t)&&(i=this.values_[t]),i},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&nt({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,i){var n;n="change:"+t,this.dispatchEvent(new xo(n,t,i)),n=je.PROPERTYCHANGE,this.dispatchEvent(new xo(n,t,i))},e.prototype.addChangeListener=function(t,i){this.addEventListener("change:"+t,i)},e.prototype.removeChangeListener=function(t,i){this.removeEventListener("change:"+t,i)},e.prototype.set=function(t,i,n){var a=this.values_||(this.values_={});if(n)a[t]=i;else{var s=a[t];a[t]=i,s!==i&&this.notify(t,s)}},e.prototype.setProperties=function(t,i){for(var n in t)this.set(n,t[n],i)},e.prototype.applyProperties=function(t){!t.values_||nt(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,i){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],Ke(this.values_)&&(this.values_=null),i||this.notify(t,n)}},e}(gi);var It={ADD:"add",REMOVE:"remove"},Eo=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Mo={LENGTH:"length"},Cn=function(r){Eo(e,r);function e(t,i,n){var a=r.call(this,t)||this;return a.element=i,a.index=n,a}return e}(kt),Ot=function(r){Eo(e,r);function e(t,i){var n=r.call(this)||this;n.on,n.once,n.un;var a=i||{};if(n.unique_=!!a.unique,n.array_=t||[],n.unique_)for(var s=0,o=n.array_.length;s<o;++s)n.assertUnique_(n.array_[s],s);return n.updateLength_(),n}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var i=0,n=t.length;i<n;++i)this.push(t[i]);return this},e.prototype.forEach=function(t){for(var i=this.array_,n=0,a=i.length;n<a;++n)t(i[n],n,i)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Mo.LENGTH)},e.prototype.insertAt=function(t,i){this.unique_&&this.assertUnique_(i),this.array_.splice(t,0,i),this.updateLength_(),this.dispatchEvent(new Cn(It.ADD,i,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var i=this.getLength();return this.insertAt(i,t),this.getLength()},e.prototype.remove=function(t){for(var i=this.array_,n=0,a=i.length;n<a;++n)if(i[n]===t)return this.removeAt(n)},e.prototype.removeAt=function(t){var i=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Cn(It.REMOVE,i,t)),i},e.prototype.setAt=function(t,i){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(i,t);var a=this.array_[t];this.array_[t]=i,this.dispatchEvent(new Cn(It.REMOVE,a,t)),this.dispatchEvent(new Cn(It.ADD,i,t))}else{for(var s=n;s<t;++s)this.insertAt(s,void 0);this.insertAt(t,i)}},e.prototype.updateLength_=function(){this.set(Mo.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,i){for(var n=0,a=this.array_.length;n<a;++n)if(this.array_[n]===t&&n!==i)throw new Xa(58)},e}(yt);function A(r,e,t){return Math.min(Math.max(r,e),t)}var To=function(){var r;return"cosh"in Math?r=Math.cosh:r=function(e){var t=Math.exp(e);return(t+1/t)/2},r}(),Co=function(){var r;return"log2"in Math?r=Math.log2:r=function(e){return Math.log(e)*Math.LOG2E},r}();function Sn(r,e,t,i,n,a){var s=n-t,o=a-i;if(s!==0||o!==0){var h=((r-t)*s+(e-i)*o)/(s*s+o*o);h>1?(t=n,i=a):h>0&&(t+=s*h,i+=o*h)}return $e(r,e,t,i)}function $e(r,e,t,i){var n=t-r,a=i-e;return n*n+a*a}function So(r){for(var e=r.length,t=0;t<e;t++){for(var i=t,n=Math.abs(r[t][t]),a=t+1;a<e;a++){var s=Math.abs(r[a][t]);s>n&&(n=s,i=a)}if(n===0)return null;var o=r[i];r[i]=r[t],r[t]=o;for(var h=t+1;h<e;h++)for(var l=-r[h][t]/r[t][t],u=t;u<e+1;u++)t==u?r[h][u]=0:r[h][u]+=l*r[t][u]}for(var f=new Array(e),c=e-1;c>=0;c--){f[c]=r[c][e]/r[c][c];for(var p=c-1;p>=0;p--)r[p][e]-=r[p][c]*f[c]}return f}function Ni(r){return r*Math.PI/180}function le(r,e){var t=r%e;return t*e<0?t+e:t}function Qt(r,e,t){return r+t*(e-r)}var te={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};var ue={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},at={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"},Cu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ua=function(r){Cu(e,r);function e(t){var i=r.call(this)||this;i.on,i.once,i.un;var n=nt({},t);return typeof t.properties=="object"&&(delete n.properties,nt(n,t.properties)),n[at.OPACITY]=t.opacity!==void 0?t.opacity:1,X(typeof n[at.OPACITY]=="number",64),n[at.VISIBLE]=t.visible!==void 0?t.visible:!0,n[at.Z_INDEX]=t.zIndex,n[at.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:Infinity,n[at.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,n[at.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-Infinity,n[at.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:Infinity,i.className_=n.className!==void 0?t.className:"ol-layer",delete n.className,i.setProperties(n),i.state_=null,i}return e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var i=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return i.opacity=A(Math.round(this.getOpacity()*100)/100,0,1),i.sourceState=this.getSourceState(),i.visible=this.getVisible(),i.extent=this.getExtent(),i.zIndex=n===void 0&&!i.managed?Infinity:n,i.maxResolution=this.getMaxResolution(),i.minResolution=Math.max(this.getMinResolution(),0),i.minZoom=this.getMinZoom(),i.maxZoom=this.getMaxZoom(),this.state_=i,i},e.prototype.getLayersArray=function(t){return z()},e.prototype.getLayerStatesArray=function(t){return z()},e.prototype.getExtent=function(){return this.get(at.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(at.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(at.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(at.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(at.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(at.OPACITY)},e.prototype.getSourceState=function(){return z()},e.prototype.getVisible=function(){return this.get(at.VISIBLE)},e.prototype.getZIndex=function(){return this.get(at.Z_INDEX)},e.prototype.setExtent=function(t){this.set(at.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(at.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(at.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(at.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(at.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){X(typeof t=="number",64),this.set(at.OPACITY,t)},e.prototype.setVisible=function(t){this.set(at.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(at.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),r.prototype.disposeInternal.call(this)},e}(yt),Su=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),In=function(r){Su(e,r);function e(t){var i=this,n=nt({},t);delete n.source,i=r.call(this,n)||this,i.on,i.once,i.un,i.mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,t.render&&(i.render=t.render),t.map&&i.setMap(t.map),i.addChangeListener(at.SOURCE,i.handleSourcePropertyChange_);var a=t.source?t.source:null;return i.setSource(a),i}return e.prototype.getLayersArray=function(t){var i=t||[];return i.push(this),i},e.prototype.getLayerStatesArray=function(t){var i=t||[];return i.push(this.getLayerState()),i},e.prototype.getSource=function(){return this.get(at.SOURCE)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():te.UNDEFINED},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Q(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=H(t,D.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(i){return i([])})},e.prototype.render=function(t,i){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,i)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Q(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Q(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=H(t,ue.PRECOMPOSE,function(i){var n=i,a=n.frameState.layerStatesArray,s=this.getLayerState(!1);X(!a.some(function(o){return o.layer===s.layer}),67),a.push(s)},this),this.mapRenderKey_=H(this,D.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(at.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),r.prototype.disposeInternal.call(this)},e}(Ua);function wr(r,e){if(!r.visible)return!1;var t=e.resolution;if(t<r.minResolution||t>=r.maxResolution)return!1;var i=e.zoom;return i>r.minZoom&&i<=r.maxZoom}var Iu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),On=function(r){Iu(e,r);function e(t,i,n,a){var s=r.call(this,t)||this;return s.inversePixelTransform=i,s.frameState=n,s.context=a,s}return e}(kt);var Ou=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gi=function(r){Ou(e,r);function e(t){var i=r.call(this)||this;if(i.on,i.once,i.un,i.id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addChangeListener(i.geometryName_,i.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){var n=t;i.setGeometry(n)}else{var a=t;i.setProperties(a)}return i}return e.prototype.clone=function(){var t=new e(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Q(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=H(t,D.CHANGE,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?Ru(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()},e}(yt);function Ru(r){if(typeof r=="function")return r;var e;if(Array.isArray(r))e=r;else{X(typeof r.getZIndex=="function",41);var t=r;e=[t]}return function(){return e}}var xe=function(){function r(e){var t=e||{};this.color_=t.color!==void 0?t.color:null}return r.prototype.clone=function(){var e=this.getColor();return new r({color:Array.isArray(e)?e.slice():e||void 0})},r.prototype.getColor=function(){return this.color_},r.prototype.setColor=function(e){this.color_=e},r}();var J={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var k={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};function Ee(r,e,t,i,n,a){for(var s=a||[],o=0,h=e;h<t;h+=i){var l=r[h],u=r[h+1];s[o++]=n[0]*l+n[2]*u+n[4],s[o++]=n[1]*l+n[3]*u+n[5]}return a&&s.length!=o&&(s.length=o),s}function Rn(r,e,t,i,n,a,s){for(var o=s||[],h=Math.cos(n),l=Math.sin(n),u=a[0],f=a[1],c=0,p=e;p<t;p+=i){var d=r[p]-u,v=r[p+1]-f;o[c++]=u+d*h-v*l,o[c++]=f+d*l+v*h;for(var _=p+2;_<p+i;++_)o[c++]=r[_]}return s&&o.length!=c&&(o.length=c),o}function Io(r,e,t,i,n,a,s,o){for(var h=o||[],l=s[0],u=s[1],f=0,c=e;c<t;c+=i){var p=r[c]-l,d=r[c+1]-u;h[f++]=l+n*p,h[f++]=u+a*d;for(var v=c+2;v<c+i;++v)h[f++]=r[v]}return o&&h.length!=f&&(h.length=f),h}function Oo(r,e,t,i,n,a,s){for(var o=s||[],h=0,l=e;l<t;l+=i){o[h++]=r[l]+n,o[h++]=r[l+1]+a;for(var u=l+2;u<l+i;++u)o[h++]=r[u]}return s&&o.length!=h&&(o.length=h),o}var Rt={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ee={};ee[Rt.RADIANS]=6370997/(2*Math.PI);ee[Rt.DEGREES]=2*Math.PI*6370997/360;ee[Rt.FEET]=.3048;ee[Rt.METERS]=1;ee[Rt.USFEET]=1200/3937;var Ro=function(){function r(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return r.prototype.canWrapX=function(){return this.canWrapX_},r.prototype.getCode=function(){return this.code_},r.prototype.getExtent=function(){return this.extent_},r.prototype.getUnits=function(){return this.units_},r.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ee[this.units_]},r.prototype.getWorldExtent=function(){return this.worldExtent_},r.prototype.getAxisOrientation=function(){return this.axisOrientation_},r.prototype.isGlobal=function(){return this.global_},r.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},r.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},r.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},r.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},r.prototype.setWorldExtent=function(e){this.worldExtent_=e},r.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},r.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},r}(),wu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Lr=6378137,ki=Math.PI*Lr,Lu=[-ki,-ki,ki,ki],Pu=[-180,-85,180,85],wn=Lr*Math.log(Math.tan(Math.PI/2)),Bi=function(r){wu(e,r);function e(t){return r.call(this,{code:t,units:Rt.METERS,extent:Lu,global:!0,worldExtent:Pu,getPointResolution:function(i,n){return i/To(n[1]/Lr)}})||this}return e}(Ro),wo=[new Bi("EPSG:3857"),new Bi("EPSG:102100"),new Bi("EPSG:102113"),new Bi("EPSG:900913"),new Bi("http://www.opengis.net/def/crs/EPSG/0/3857"),new Bi("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Au(r,e,t){var i=r.length,n=t>1?t:2,a=e;a===void 0&&(n>2?a=r.slice():a=new Array(i));for(var s=0;s<i;s+=n){a[s]=ki*r[s]/180;var o=Lr*Math.log(Math.tan(Math.PI*(+r[s+1]+90)/360));o>wn?o=wn:o<-wn&&(o=-wn),a[s+1]=o}return a}function bu(r,e,t){var i=r.length,n=t>1?t:2,a=e;a===void 0&&(n>2?a=r.slice():a=new Array(i));for(var s=0;s<i;s+=n)a[s]=180*r[s]/ki,a[s+1]=360*Math.atan(Math.exp(r[s+1]/Lr))/Math.PI-90;return a}var ju=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fu=6378137,Lo=[-180,-90,180,90],Du=Math.PI*Fu/180,yi=function(r){ju(e,r);function e(t,i){return r.call(this,{code:t,units:Rt.DEGREES,extent:Lo,axisOrientation:i,global:!0,metersPerUnit:Du,worldExtent:Lo})||this}return e}(Ro),Po=[new yi("CRS:84"),new yi("EPSG:4326","neu"),new yi("urn:ogc:def:crs:OGC:1.3:CRS84"),new yi("urn:ogc:def:crs:OGC:2:84"),new yi("http://www.opengis.net/def/crs/OGC/1.3/CRS84","neu"),new yi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new yi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],za={};function Nu(r){return za[r]||za[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Gu(r,e){za[r]=e}var Xi={};function Ln(r,e,t){var i=r.getCode(),n=e.getCode();i in Xi||(Xi[i]={}),Xi[i][n]=t}function ku(r,e){var t;return r in Xi&&e in Xi[r]&&(t=Xi[r][e]),t}var Bu=63710088e-1;function Ao(r,e,t){var i=t||Bu,n=Ni(r[1]),a=Ni(e[1]),s=(a-n)/2,o=Ni(e[0]-r[0])/2,h=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(a);return 2*i*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function Wa(r,e,t){var i;if(e!==void 0){for(var n=0,a=r.length;n<a;++n)e[n]=r[n];i=e}else i=r.slice();return i}function bo(r,e,t){if(e!==void 0&&r!==e){for(var i=0,n=r.length;i<n;++i)e[i]=r[i];r=e}return r}function Xu(r){Gu(r.getCode(),r),Ln(r,r,Wa)}function Uu(r){r.forEach(Xu)}function vt(r){return typeof r=="string"?Nu(r):r||null}function Va(r,e,t,i){r=vt(r);var n,a=r.getPointResolutionFunc();if(a){if(n=a(e,t),i&&i!==r.getUnits()){var s=r.getMetersPerUnit();s&&(n=n*s/ee[i])}}else{var o=r.getUnits();if(o==Rt.DEGREES&&!i||i==Rt.DEGREES)n=e;else{var h=Ya(r,vt("EPSG:4326"));if(h===bo&&o!==Rt.DEGREES)n=e*r.getMetersPerUnit();else{var l=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];l=h(l,l,2);var u=Ao(l.slice(0,2),l.slice(2,4)),f=Ao(l.slice(4,6),l.slice(6,8));n=(u+f)/2}var s=i?ee[i]:r.getMetersPerUnit();s!==void 0&&(n/=s)}}return n}function jo(r){Uu(r),r.forEach(function(e){r.forEach(function(t){e!==t&&Ln(e,t,Wa)})})}function zu(r,e,t,i){r.forEach(function(n){e.forEach(function(a){Ln(n,a,t),Ln(a,n,i)})})}function Pn(r,e){return r?typeof r=="string"?vt(r):r:vt(e)}function qa(r,e){return Za(r,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function Vt(r,e){if(r===e)return!0;var t=r.getUnits()===e.getUnits();if(r.getCode()===e.getCode())return t;var i=Ya(r,e);return i===Wa&&t}function Ya(r,e){var t=r.getCode(),i=e.getCode(),n=ku(t,i);return n||(n=bo),n}function fe(r,e){var t=vt(r),i=vt(e);return Ya(t,i)}function Za(r,e,t){var i=fe(e,t);return i(r,void 0,r.length)}var Wu=null;function Fo(){return Wu}function Pr(r,e){return r}function ce(r,e){return r}function An(r,e){return r}function Me(r,e){return r}function Yu(){jo(wo),jo(Po),zu(Po,wo,Au,bu)}Yu();var Ui=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",Do=Ui.indexOf("firefox")!==-1,k0=Ui.indexOf("safari")!==-1&&Ui.indexOf("chrom")==-1,No=Ui.indexOf("webkit")!==-1&&Ui.indexOf("edge")==-1,Go=Ui.indexOf("macintosh")!==-1,Ka=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,Je=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,ko=typeof Image!="undefined"&&Image.prototype.decode,Ha=function(){var r=!1;try{var e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return r}();var z0=new Array(6);function bt(){return[1,0,0,1,0,0]}function Bo(r,e){var t=r[0],i=r[1],n=r[2],a=r[3],s=r[4],o=r[5],h=e[0],l=e[1],u=e[2],f=e[3],c=e[4],p=e[5];return r[0]=t*h+n*l,r[1]=i*h+a*l,r[2]=t*u+n*f,r[3]=i*u+a*f,r[4]=t*c+n*p+s,r[5]=i*c+a*p+o,r}function Vu(r,e,t,i,n,a,s){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=a,r[5]=s,r}function Xo(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function ht(r,e){var t=e[0],i=e[1];return e[0]=r[0]*t+r[2]*i+r[4],e[1]=r[1]*t+r[3]*i+r[5],e}function Uo(r,e,t){return Vu(r,e,0,0,t,0,0)}function jt(r,e,t,i,n,a,s,o){var h=Math.sin(a),l=Math.cos(a);return r[0]=i*l,r[1]=n*h,r[2]=-i*h,r[3]=n*l,r[4]=s*i*l-o*i*h+e,r[5]=s*n*h+o*n*l+t,r}function zi(r,e){var t=Zu(e);X(t!==0,32);var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],h=e[5];return r[0]=s/t,r[1]=-n/t,r[2]=-a/t,r[3]=i/t,r[4]=(a*h-s*o)/t,r[5]=-(i*h-n*o)/t,r}function Zu(r){return r[0]*r[3]-r[1]*r[2]}var zo;function bn(r){var e="matrix("+r.join(", ")+")";if(Je)return e;var t=zo||(zo=document.createElement("div"));return t.style.transform=e,t.style.transform}var Wi={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},_t={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function $a(r){for(var e=Tt(),t=0,i=r.length;t<i;++t)xi(e,r[t]);return e}function qu(r,e,t){var i=Math.min.apply(null,r),n=Math.min.apply(null,e),a=Math.max.apply(null,r),s=Math.max.apply(null,e);return Bt(i,n,a,s,t)}function Ar(r,e,t){return t?(t[0]=r[0]-e,t[1]=r[1]-e,t[2]=r[2]+e,t[3]=r[3]+e,t):[r[0]-e,r[1]-e,r[2]+e,r[3]+e]}function jn(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r.slice()}function Ei(r,e,t){var i,n;return e<r[0]?i=r[0]-e:r[2]<e?i=e-r[2]:i=0,t<r[1]?n=r[1]-t:r[3]<t?n=t-r[3]:n=0,i*i+n*n}function mt(r,e){return Yi(r,e[0],e[1])}function wt(r,e){return r[0]<=e[0]&&e[2]<=r[2]&&r[1]<=e[1]&&e[3]<=r[3]}function Yi(r,e,t){return r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]}function Fn(r,e){var t=r[0],i=r[1],n=r[2],a=r[3],s=e[0],o=e[1],h=_t.UNKNOWN;return s<t?h=h|_t.LEFT:s>n&&(h=h|_t.RIGHT),o<i?h=h|_t.BELOW:o>a&&(h=h|_t.ABOVE),h===_t.UNKNOWN&&(h=_t.INTERSECTING),h}function Tt(){return[Infinity,Infinity,-Infinity,-Infinity]}function Bt(r,e,t,i,n){return n?(n[0]=r,n[1]=e,n[2]=t,n[3]=i,n):[r,e,t,i]}function Vi(r){return Bt(Infinity,Infinity,-Infinity,-Infinity,r)}function Wo(r,e){var t=r[0],i=r[1];return Bt(t,i,t,i,e)}function Yo(r,e,t,i,n){var a=Vi(n);return Ja(a,r,e,t,i)}function Zt(r,e){return r[0]==e[0]&&r[2]==e[2]&&r[1]==e[1]&&r[3]==e[3]}function Vo(r,e,t){return Math.abs(r[0]-e[0])<t&&Math.abs(r[2]-e[2])<t&&Math.abs(r[1]-e[1])<t&&Math.abs(r[3]-e[3])<t}function Zo(r,e){return e[0]<r[0]&&(r[0]=e[0]),e[2]>r[2]&&(r[2]=e[2]),e[1]<r[1]&&(r[1]=e[1]),e[3]>r[3]&&(r[3]=e[3]),r}function xi(r,e){e[0]<r[0]&&(r[0]=e[0]),e[0]>r[2]&&(r[2]=e[0]),e[1]<r[1]&&(r[1]=e[1]),e[1]>r[3]&&(r[3]=e[1])}function Ja(r,e,t,i,n){for(;t<i;t+=n)Ku(r,e[t],e[t+1]);return r}function Ku(r,e,t){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}function Dn(r,e){var t;return t=e(Zi(r)),t||(t=e(qi(r)),t)||(t=e(Ki(r)),t)||(t=e(de(r)),t)?t:!1}function Nn(r){var e=0;return Te(r)||(e=Z(r)*ft(r)),e}function Zi(r){return[r[0],r[1]]}function qi(r){return[r[2],r[1]]}function xt(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function qo(r,e){var t;return e===Wi.BOTTOM_LEFT?t=Zi(r):e===Wi.BOTTOM_RIGHT?t=qi(r):e===Wi.TOP_LEFT?t=de(r):e===Wi.TOP_RIGHT?t=Ki(r):X(!1,13),t}function br(r,e,t,i,n){var a=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),h=Math.sin(t),l=a*o,u=a*h,f=s*o,c=s*h,p=r[0],d=r[1],v=p-l+c,_=p-l-c,m=p+l-c,g=p+l+c,y=d-u-f,x=d-u+f,E=d+u+f,M=d+u-f;return Bt(Math.min(v,_,m,g),Math.min(y,x,E,M),Math.max(v,_,m,g),Math.max(y,x,E,M),n)}function ft(r){return r[3]-r[1]}function qt(r,e,t){var i=t||Tt();return ct(r,e)?(r[0]>e[0]?i[0]=r[0]:i[0]=e[0],r[1]>e[1]?i[1]=r[1]:i[1]=e[1],r[2]<e[2]?i[2]=r[2]:i[2]=e[2],r[3]<e[3]?i[3]=r[3]:i[3]=e[3]):Vi(i),i}function de(r){return[r[0],r[3]]}function Ki(r){return[r[2],r[3]]}function Z(r){return r[2]-r[0]}function ct(r,e){return r[0]<=e[2]&&r[2]>=e[0]&&r[1]<=e[3]&&r[3]>=e[1]}function Te(r){return r[2]<r[0]||r[3]<r[1]}function Ko(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r}function Ho(r,e,t){var i=!1,n=Fn(r,e),a=Fn(r,t);if(n===_t.INTERSECTING||a===_t.INTERSECTING)i=!0;else{var s=r[0],o=r[1],h=r[2],l=r[3],u=e[0],f=e[1],c=t[0],p=t[1],d=(p-f)/(c-u),v=void 0,_=void 0;!!(a&_t.ABOVE)&&!(n&_t.ABOVE)&&(v=c-(p-l)/d,i=v>=s&&v<=h),!i&&!!(a&_t.RIGHT)&&!(n&_t.RIGHT)&&(_=p-(c-h)*d,i=_>=o&&_<=l),!i&&!!(a&_t.BELOW)&&!(n&_t.BELOW)&&(v=c-(p-o)/d,i=v>=s&&v<=h),!i&&!!(a&_t.LEFT)&&!(n&_t.LEFT)&&(_=p-(c-s)*d,i=_>=o&&_<=l)}return i}function Hi(r,e,t,i){var n=[];if(i>1)for(var a=r[2]-r[0],s=r[3]-r[1],o=0;o<i;++o)n.push(r[0]+a*o/i,r[1],r[2],r[1]+s*o/i,r[2]-a*o/i,r[3],r[0],r[3]-s*o/i);else n=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]];e(n,n,2);for(var h=[],l=[],o=0,u=n.length;o<u;o+=2)h.push(n[o]),l.push(n[o+1]);return qu(h,l,t)}function Gn(r,e){var t=e.getExtent(),i=xt(r);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){var n=Z(t),a=Math.floor((i[0]-t[0])/n),s=a*n;r[0]-=s,r[2]-=s}return r}var Hu=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$o=bt(),$u=function(r){Hu(e,r);function e(){var t=r.call(this)||this;return t.extent_=Tt(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=go(function(i,n,a){if(!a)return this.getSimplifiedGeometry(n);var s=this.clone();return s.applyTransform(a),s.getSimplifiedGeometry(n)}),t}return e.prototype.simplifyTransformed=function(t,i){return this.simplifyTransformedInternal(this.getRevision(),t,i)},e.prototype.clone=function(){return z()},e.prototype.closestPointXY=function(t,i,n,a){return z()},e.prototype.containsXY=function(t,i){var n=this.getClosestPoint([t,i]);return n[0]===t&&n[1]===i},e.prototype.getClosestPoint=function(t,i){var n=i||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,Infinity),n},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return z()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var i=this.computeExtent(this.extent_);(isNaN(i[0])||isNaN(i[1]))&&Vi(i),this.extentRevision_=this.getRevision()}return Ko(this.extent_,t)},e.prototype.rotate=function(t,i){z()},e.prototype.scale=function(t,i,n){z()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return z()},e.prototype.getType=function(){return z()},e.prototype.applyTransform=function(t){z()},e.prototype.intersectsExtent=function(t){return z()},e.prototype.translate=function(t,i){z()},e.prototype.transform=function(t,i){var n=vt(t),a=n.getUnits()==Rt.TILE_PIXELS?function(s,o,h){var l=n.getExtent(),u=n.getWorldExtent(),f=ft(u)/ft(l);return jt($o,u[0],u[3],f,-f,0,0,0),Ee(s,0,s.length,h,$o,o),fe(n,i)(s,o,h)}:fe(n,i);return this.applyTransform(a),this},e}(yt),Ju=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fe=function(r){Ju(e,r);function e(){var t=r.call(this)||this;return t.layout=J.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return Yo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return z()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var i=this.getSimplifiedGeometryInternal(t),n=i.getFlatCoordinates();return n.length<this.flatCoordinates.length?i:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,i){this.stride=Jo(t),this.layout=t,this.flatCoordinates=i},e.prototype.setCoordinates=function(t,i){z()},e.prototype.setLayout=function(t,i,n){var a;if(t)a=Jo(t);else{for(var s=0;s<n;++s)if(i.length===0){this.layout=J.XY,this.stride=2;return}else i=i[0];a=i.length,t=Qu(a)}this.layout=t,this.stride=a},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,i){var n=this.getFlatCoordinates();if(n){var a=this.getStride();Rn(n,0,n.length,a,t,i,n),this.changed()}},e.prototype.scale=function(t,i,n){var a=i;a===void 0&&(a=t);var s=n;s||(s=xt(this.getExtent()));var o=this.getFlatCoordinates();if(o){var h=this.getStride();Io(o,0,o.length,h,t,a,s,o),this.changed()}},e.prototype.translate=function(t,i){var n=this.getFlatCoordinates();if(n){var a=this.getStride();Oo(n,0,n.length,a,t,i,n),this.changed()}},e}($u);function Qu(r){var e;return r==2?e=J.XY:r==3?e=J.XYZ:r==4&&(e=J.XYZM),e}function Jo(r){var e;return r==J.XY?e=2:r==J.XYZ||r==J.XYM?e=3:r==J.XYZM&&(e=4),e}function Qo(r,e,t){var i=r.getFlatCoordinates();if(i){var n=r.getStride();return Ee(i,0,i.length,n,e,t)}else return null}function th(r,e,t,i,n){var a=Dn(n,function(s){return!Qe(r,e,t,i,s[0],s[1])});return!a}function Qe(r,e,t,i,n,a){for(var s=0,o=r[t-i],h=r[t-i+1];e<t;e+=i){var l=r[e],u=r[e+1];h<=a?u>a&&(l-o)*(a-h)-(n-o)*(u-h)>0&&s++:u<=a&&(l-o)*(a-h)-(n-o)*(u-h)<0&&s--,o=l,h=u}return s!==0}function kn(r,e,t,i,n,a){if(t.length===0||!Qe(r,e,t[0],i,n,a))return!1;for(var s=1,o=t.length;s<o;++s)if(Qe(r,t[s-1],t[s],i,n,a))return!1;return!0}function eh(r,e,t,i,n,a,s){var o=r[e],h=r[e+1],l=r[t]-o,u=r[t+1]-h,f;if(l===0&&u===0)f=e;else{var c=((n-o)*l+(a-h)*u)/(l*l+u*u);if(c>1)f=t;else if(c>0){for(var p=0;p<i;++p)s[p]=Qt(r[e+p],r[t+p],c);s.length=i;return}else f=e}for(var p=0;p<i;++p)s[p]=r[f+p];s.length=i}function jr(r,e,t,i,n){var a=r[e],s=r[e+1];for(e+=i;e<t;e+=i){var o=r[e],h=r[e+1],l=$e(a,s,o,h);l>n&&(n=l),a=o,s=h}return n}function Bn(r,e,t,i,n){for(var a=0,s=t.length;a<s;++a){var o=t[a];n=jr(r,e,o,i,n),e=o}return n}function Fr(r,e,t,i,n,a,s,o,h,l,u){if(e==t)return l;var f,c;if(n===0)if(c=$e(s,o,r[e],r[e+1]),c<l){for(f=0;f<i;++f)h[f]=r[e+f];return h.length=i,c}else return l;for(var p=u||[NaN,NaN],d=e+i;d<t;)if(eh(r,d-i,d,i,s,o,p),c=$e(s,o,p[0],p[1]),c<l){for(l=c,f=0;f<i;++f)h[f]=p[f];h.length=i,d+=i}else d+=i*Math.max((Math.sqrt(c)-Math.sqrt(l))/n|0,1);if(a&&(eh(r,t-i,e,i,s,o,p),c=$e(s,o,p[0],p[1]),c<l)){for(l=c,f=0;f<i;++f)h[f]=p[f];h.length=i}return l}function Xn(r,e,t,i,n,a,s,o,h,l,u){for(var f=u||[NaN,NaN],c=0,p=t.length;c<p;++c){var d=t[c];l=Fr(r,e,d,i,n,a,s,o,h,l,f),e=d}return l}function Qa(r,e,t,i,n){var a;for(e+=i;e<t;e+=i)if(a=n(r.slice(e-i,e),r.slice(e,e+i)),a)return a;return!1}function Dr(r,e,t,i,n){var a=Ja(Tt(),r,e,t,i);return ct(n,a)?wt(n,a)||a[0]>=n[0]&&a[2]<=n[2]||a[1]>=n[1]&&a[3]<=n[3]?!0:Qa(r,e,t,i,function(s,o){return Ho(n,s,o)}):!1}function ih(r,e,t,i,n){for(var a=0,s=t.length;a<s;++a){if(Dr(r,e,t[a],i,n))return!0;e=t[a]}return!1}function tf(r,e,t,i,n){return!!(Dr(r,e,t,i,n)||Qe(r,e,t,i,n[0],n[1])||Qe(r,e,t,i,n[0],n[3])||Qe(r,e,t,i,n[2],n[1])||Qe(r,e,t,i,n[2],n[3]))}function rh(r,e,t,i,n){if(!tf(r,e,t[0],i,n))return!1;if(t.length===1)return!0;for(var a=1,s=t.length;a<s;++a)if(th(r,t[a-1],t[a],i,n)&&!Dr(r,t[a-1],t[a],i,n))return!1;return!0}function nh(r,e,t,i){for(var n=0,a=t.length;n<a;++n)r[e++]=t[n];return e}function Nr(r,e,t,i){for(var n=0,a=t.length;n<a;++n)for(var s=t[n],o=0;o<i;++o)r[e++]=s[o];return e}function Un(r,e,t,i,n){for(var a=n||[],s=0,o=0,h=t.length;o<h;++o){var l=Nr(r,e,t[o],i);a[s++]=l,e=l}return a.length=s,a}function Gr(r,e,t,i,n,a,s){var o=(t-e)/i;if(o<3){for(;e<t;e+=i)a[s++]=r[e],a[s++]=r[e+1];return s}var h=new Array(o);h[0]=1,h[o-1]=1;for(var l=[e,t-i],u=0;l.length>0;){for(var f=l.pop(),c=l.pop(),p=0,d=r[c],v=r[c+1],_=r[f],m=r[f+1],g=c+i;g<f;g+=i){var y=r[g],x=r[g+1],E=Sn(y,x,d,v,_,m);E>p&&(u=g,p=E)}p>n&&(h[(u-e)/i]=1,c+i<u&&l.push(c,u),u+i<f&&l.push(u,f))}for(var g=0;g<o;++g)h[g]&&(a[s++]=r[e+g*i],a[s++]=r[e+g*i+1]);return s}function ah(r,e,t,i,n,a,s,o){for(var h=0,l=t.length;h<l;++h){var u=t[h];s=Gr(r,e,u,i,n,a,s),o.push(s),e=u}return s}function ti(r,e){return e*Math.round(r/e)}function ef(r,e,t,i,n,a,s){if(e==t)return s;var o=ti(r[e],n),h=ti(r[e+1],n);e+=i,a[s++]=o,a[s++]=h;var l,u;do if(l=ti(r[e],n),u=ti(r[e+1],n),e+=i,e==t)return a[s++]=l,a[s++]=u,s;while(l==o&&u==h);for(;e<t;){var f=ti(r[e],n),c=ti(r[e+1],n);if(e+=i,!(f==l&&c==u)){var p=l-o,d=u-h,v=f-o,_=c-h;if(p*_==d*v&&(p<0&&v<p||p==v||p>0&&v>p)&&(d<0&&_<d||d==_||d>0&&_>d)){l=f,u=c;continue}a[s++]=l,a[s++]=u,o=l,h=u,l=f,u=c}}return a[s++]=l,a[s++]=u,s}function sh(r,e,t,i,n,a,s,o){for(var h=0,l=t.length;h<l;++h){var u=t[h];s=ef(r,e,u,i,n,a,s),o.push(s),e=u}return s}function Ce(r,e,t,i,n){for(var a=n!==void 0?n:[],s=0,o=e;o<t;o+=i)a[s++]=r.slice(o,o+i);return a.length=s,a}function ei(r,e,t,i,n){for(var a=n!==void 0?n:[],s=0,o=0,h=t.length;o<h;++o){var l=t[o];a[s++]=Ce(r,e,l,i,a[s]),e=l}return a.length=s,a}function ts(r,e,t,i,n){for(var a=n!==void 0?n:[],s=0,o=0,h=t.length;o<h;++o){var l=t[o];a[s++]=ei(r,e,l,i,a[s]),e=l[l.length-1]}return a.length=s,a}function zn(r,e,t,i,n,a,s){var o,h,l=(t-e)/i;if(l===1)o=e;else if(l===2)o=e,h=n;else if(l!==0){for(var u=r[e],f=r[e+1],c=0,p=[0],d=e+i;d<t;d+=i){var v=r[d],_=r[d+1];c+=Math.sqrt((v-u)*(v-u)+(_-f)*(_-f)),p.push(c),u=v,f=_}var m=n*c,g=vo(p,m);g<0?(h=(m-p[-g-2])/(p[-g-1]-p[-g-2]),o=e+(-g-2)*i):o=e+g*i}for(var y=s>1?s:2,x=a||new Array(y),d=0;d<y;++d)x[d]=o===void 0?NaN:h===void 0?r[o+d]:Qt(r[o+d],r[o+i+d],h);return x}function Wn(r,e,t,i,n,a){if(t==e)return null;var s;if(n<r[e+i-1])return a?(s=r.slice(e,e+i),s[i-1]=n,s):null;if(r[t-1]<n)return a?(s=r.slice(t-i,t),s[i-1]=n,s):null;if(n==r[e+i-1])return r.slice(e,e+i);for(var o=e/i,h=t/i;o<h;){var l=o+h>>1;n<r[(l+1)*i-1]?h=l:o=l+1}var u=r[o*i-1];if(n==u)return r.slice((o-1)*i,(o-1)*i+i);var f=r[(o+1)*i-1],c=(n-u)/(f-u);s=[];for(var p=0;p<i-1;++p)s.push(Qt(r[(o-1)*i+p],r[o*i+p],c));return s.push(n),s}function oh(r,e,t,i,n,a,s){if(s)return Wn(r,e,t[t.length-1],i,n,a);var o;if(n<r[i-1])return a?(o=r.slice(0,i),o[i-1]=n,o):null;if(r[r.length-1]<n)return a?(o=r.slice(r.length-i),o[i-1]=n,o):null;for(var h=0,l=t.length;h<l;++h){var u=t[h];if(e!=u){if(n<r[e+i-1])return null;if(n<=r[u-1])return Wn(r,e,u,i,n,!1);e=u}}return null}function Yn(r,e,t,i){for(var n=r[e],a=r[e+1],s=0,o=e+i;o<t;o+=i){var h=r[o],l=r[o+1];s+=Math.sqrt((h-n)*(h-n)+(l-a)*(l-a)),n=h,a=l}return s}var rf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),$i=function(r){rf(e,r);function e(t,i){var n=r.call(this)||this;return n.flatMidpoint_=null,n.flatMidpointRevision_=-1,n.maxDelta_=-1,n.maxDeltaRevision_=-1,i!==void 0&&!Array.isArray(t[0])?n.setFlatCoordinates(i,t):n.setCoordinates(t,i),n}return e.prototype.appendCoordinate=function(t){this.flatCoordinates?ye(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,n,a){return a<Ei(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,i,n,a))},e.prototype.forEachSegment=function(t){return Qa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,i){if(this.layout!=J.XYM&&this.layout!=J.XYZM)return null;var n=i!==void 0?i:!1;return Wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n)},e.prototype.getCoordinates=function(){return Ce(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,i){return zn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,this.stride)},e.prototype.getLength=function(){return Yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,J.XY)},e.prototype.getType=function(){return k.LINE_STRING},e.prototype.intersectsExtent=function(t){return Dr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Nr(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Fe);var nf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Se=function(r){nf(e,r);function e(t,i){var n=r.call(this)||this;return n.setCoordinates(t,i),n}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,n,a){var s=this.flatCoordinates,o=$e(t,i,s[0],s[1]);if(o<a){for(var h=this.stride,l=0;l<h;++l)n[l]=s[l];return n.length=h,o}else return a},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Wo(this.flatCoordinates,t)},e.prototype.getType=function(){return k.POINT},e.prototype.intersectsExtent=function(t){return Yi(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=nh(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Fe);var Ie=function(){function r(e){var t=e||{};this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}return r.prototype.clone=function(){var e=this.getColor();return new r({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},r.prototype.getColor=function(){return this.color_},r.prototype.getLineCap=function(){return this.lineCap_},r.prototype.getLineDash=function(){return this.lineDash_},r.prototype.getLineDashOffset=function(){return this.lineDashOffset_},r.prototype.getLineJoin=function(){return this.lineJoin_},r.prototype.getMiterLimit=function(){return this.miterLimit_},r.prototype.getWidth=function(){return this.width_},r.prototype.setColor=function(e){this.color_=e},r.prototype.setLineCap=function(e){this.lineCap_=e},r.prototype.setLineDash=function(e){this.lineDash_=e},r.prototype.setLineDashOffset=function(e){this.lineDashOffset_=e},r.prototype.setLineJoin=function(e){this.lineJoin_=e},r.prototype.setMiterLimit=function(e){this.miterLimit_=e},r.prototype.setWidth=function(e){this.width_=e},r}();var tt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function es(r){return r[0]>0&&r[1]>0}function hh(r,e,t){return t===void 0&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function Ct(r,e){return Array.isArray(r)?r:(e===void 0?e=[r,r]:(e[0]=r,e[1]=r),e)}var Vn=function(){function r(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ct(e.scale),this.displacement_=e.displacement}return r.prototype.clone=function(){var e=this.getScale();return new r({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},r.prototype.getOpacity=function(){return this.opacity_},r.prototype.getRotateWithView=function(){return this.rotateWithView_},r.prototype.getRotation=function(){return this.rotation_},r.prototype.getScale=function(){return this.scale_},r.prototype.getScaleArray=function(){return this.scaleArray_},r.prototype.getDisplacement=function(){return this.displacement_},r.prototype.getAnchor=function(){return z()},r.prototype.getImage=function(e){return z()},r.prototype.getHitDetectionImage=function(){return z()},r.prototype.getPixelRatio=function(e){return 1},r.prototype.getImageState=function(){return z()},r.prototype.getImageSize=function(){return z()},r.prototype.getOrigin=function(){return z()},r.prototype.getSize=function(){return z()},r.prototype.setOpacity=function(e){this.opacity_=e},r.prototype.setRotateWithView=function(e){this.rotateWithView_=e},r.prototype.setRotation=function(e){this.rotation_=e},r.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Ct(e)},r.prototype.listenImageChange=function(e){z()},r.prototype.load=function(){z()},r.prototype.unlistenImageChange=function(e){z()},r}();var af=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,sf=/^([a-z]*)$|^hsla?\(.*\)$/i;function Zn(r){return typeof r=="string"?r:is(r)}function of(r){var e=document.createElement("div");if(e.style.color=r,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var lf=function(){var r=1024,e={},t=0;return function(i){var n;if(e.hasOwnProperty(i))n=e[i];else{if(t>=r){var a=0;for(var s in e)(a++&3)==0&&(delete e[s],--t)}n=hf(i),e[i]=n,++t}return n}}();function qn(r){return Array.isArray(r)?r:lf(r)}function hf(r){var e,t,i,n,a;if(sf.exec(r)&&(r=of(r)),af.exec(r)){var s=r.length-1,o=void 0;s<=4?o=1:o=2;var h=s===4||s===8;e=parseInt(r.substr(1+0*o,o),16),t=parseInt(r.substr(1+1*o,o),16),i=parseInt(r.substr(1+2*o,o),16),h?n=parseInt(r.substr(1+3*o,o),16):n=255,o==1&&(e=(e<<4)+e,t=(t<<4)+t,i=(i<<4)+i,h&&(n=(n<<4)+n)),a=[e,t,i,n/255]}else r.indexOf("rgba(")==0?(a=r.slice(5,-1).split(",").map(Number),lh(a)):r.indexOf("rgb(")==0?(a=r.slice(4,-1).split(",").map(Number),a.push(1),lh(a)):X(!1,14);return a}function lh(r){return r[0]=A(r[0]+.5|0,0,255),r[1]=A(r[1]+.5|0,0,255),r[2]=A(r[2]+.5|0,0,255),r[3]=A(r[3],0,1),r}function is(r){var e=r[0];e!=(e|0)&&(e=e+.5|0);var t=r[1];t!=(t|0)&&(t=t+.5|0);var i=r[2];i!=(i|0)&&(i=i+.5|0);var n=r[3]===void 0?1:r[3];return"rgba("+e+","+t+","+i+","+n+")"}function Kt(r){return Array.isArray(r)?is(r):r}function Et(r,e,t,i){var n;return t&&t.length?n=t.shift():Je?n=new OffscreenCanvas(r||300,e||300):(n=document.createElement("canvas"),n.style.all="unset"),r&&(n.width=r),e&&(n.height=e),n.getContext("2d",i)}function rs(r,e){var t=e.parentNode;t&&t.replaceChild(r,e)}function Kn(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function uh(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function fh(r,e){for(var t=r.childNodes,i=0;;++i){var n=t[i],a=e[i];if(!n&&!a)break;if(n!==a){if(!n){r.appendChild(a);continue}if(!a){r.removeChild(n),--i;continue}r.insertBefore(a,n)}}}var kr="ol-hidden",Br="ol-unselectable",Hn="ol-control",ns="ol-collapsed",uf=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),ch=["style","variant","weight","size","lineHeight","family"],as=function(r){var e=r.match(uf);if(!e)return null;for(var t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},i=0,n=ch.length;i<n;++i){var a=e[i+1];a!==void 0&&(t[ch[i]]=a)}return t.families=t.family.split(/,\s?/),t};function Ji(r){return r===1?"":String(Math.round(r*100)/100)}var $n="10px sans-serif",ie="#000",Qi="round",Mi=[],Ti=0,De="round",ii=10,ri="#000",Ci="center",tr="middle",ni=[0,0,0,0],ai=1,Oe=new yt,ff=new Jt;ff.setSize=function(){console.warn("labelCache is deprecated.")};var er=null,ss,os={},dh=function(){var r=100,e="32px ",t=["monospace","serif"],i=t.length,n="wmytzilWMYTZIL@#/&?$%10",a,s;function o(l,u,f){for(var c=!0,p=0;p<i;++p){var d=t[p];if(s=Jn(l+" "+u+" "+e+d,n),f!=d){var v=Jn(l+" "+u+" "+e+f+","+d,n);c=c&&v!=s}}return!!c}function h(){for(var l=!0,u=Oe.getKeys(),f=0,c=u.length;f<c;++f){var p=u[f];Oe.get(p)<r&&(o.apply(this,p.split(`
`))?(qe(os),er=null,ss=void 0,Oe.set(p,r)):(Oe.set(p,Oe.get(p)+1,!0),l=!1))}l&&(clearInterval(a),a=void 0)}return function(l){var u=as(l);if(!!u)for(var f=u.families,c=0,p=f.length;c<p;++c){var d=f[c],v=u.style+`
`+u.weight+`
`+d;Oe.get(v)===void 0&&(Oe.set(v,r,!0),o(u.style,u.weight,d)||(Oe.set(v,0,!0),a===void 0&&(a=setInterval(h,32))))}}}(),vh=function(){var r;return function(e){var t=os[e];if(t==null){if(Je){var i=as(e),n=ph(e,"g"),a=isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight);t=a*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=e,document.body.appendChild(r),t=r.offsetHeight,document.body.removeChild(r);os[e]=t}return t}}();function ph(r,e){return er||(er=Et(1,1)),r!=ss&&(er.font=r,ss=er.font),er.measureText(e)}function Jn(r,e){return ph(r,e).width}function hs(r,e,t){if(e in t)return t[e];var i=Jn(r,e);return t[e]=i,i}function _h(r,e,t){for(var i=e.length,n=0,a=0;a<i;++a){var s=Jn(r,e[a]);n=Math.max(n,s),t.push(s)}return n}function mh(r,e,t,i,n,a,s,o,h,l,u){r.save(),t!==1&&(r.globalAlpha*=t),e&&r.setTransform.apply(r,e),i.contextInstructions?(r.translate(h,l),r.scale(u[0],u[1]),cf(i,r)):u[0]<0||u[1]<0?(r.translate(h,l),r.scale(u[0],u[1]),r.drawImage(i,n,a,s,o,0,0,s,o)):r.drawImage(i,n,a,s,o,h,l,s*u[0],o*u[1]),r.restore()}function cf(r,e){for(var t=r.contextInstructions,i=0,n=t.length;i<n;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}var df=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pf=function(r){df(e,r);function e(t){var i=this,n=t.rotateWithView!==void 0?t.rotateWithView:!1;return i=r.call(this,{opacity:1,rotateWithView:n,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0]})||this,i.canvas_=void 0,i.hitDetectionCanvas_=null,i.fill_=t.fill!==void 0?t.fill:null,i.origin_=[0,0],i.points_=t.points,i.radius_=t.radius!==void 0?t.radius:t.radius1,i.radius2_=t.radius2,i.angle_=t.angle!==void 0?t.angle:0,i.stroke_=t.stroke!==void 0?t.stroke:null,i.anchor_=null,i.size_=null,i.renderOptions_=null,i.render(),i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_},e.prototype.getImage=function(t){var i=this.canvas_[t];if(!i){var n=this.renderOptions_,a=Et(n.size*t,n.size*t);this.draw_(n,a,t),i=a.canvas,this.canvas_[t]=i}return i},e.prototype.getPixelRatio=function(t){return t},e.prototype.getImageSize=function(){return this.size_},e.prototype.getImageState=function(){return tt.LOADED},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t){},e.prototype.calculateLineJoinSize_=function(t,i,n){if(i===0||this.points_===Infinity||t!=="bevel"&&t!=="miter")return i;var a=this.radius_,s=this.radius2_===void 0?a:this.radius2_;if(a<s){var o=a;a=s,s=o}var h=this.radius2_===void 0?this.points_:this.points_*2,l=2*Math.PI/h,u=s*Math.sin(l),f=Math.sqrt(s*s-u*u),c=a-f,p=Math.sqrt(u*u+c*c),d=p/u;if(t==="miter"&&d<=n)return d*i;var v=i/2/d,_=i/2*(c/p),m=Math.sqrt((a+v)*(a+v)+_*_),g=m-a;if(this.radius2_===void 0||t==="bevel")return g*2;var y=a*Math.sin(l),x=Math.sqrt(a*a-y*y),E=s-x,M=Math.sqrt(y*y+E*E),C=M/y;if(C<=n){var T=C*i/2-s-a;return 2*Math.max(g,T)}return g*2},e.prototype.createRenderOptions=function(){var t=De,i=0,n=null,a=0,s,o=0;this.stroke_&&(s=this.stroke_.getColor(),s===null&&(s=ri),s=Kt(s),o=this.stroke_.getWidth(),o===void 0&&(o=ai),n=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),t=this.stroke_.getLineJoin(),t===void 0&&(t=De),i=this.stroke_.getMiterLimit(),i===void 0&&(i=ii));var h=this.calculateLineJoinSize_(t,o,i),l=Math.max(this.radius_,this.radius2_||0),u=Math.ceil(2*l+h);return{strokeStyle:s,strokeWidth:o,size:u,lineDash:n,lineDashOffset:a,lineJoin:t,miterLimit:i}},e.prototype.render=function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size,i=this.getDisplacement();this.canvas_={},this.anchor_=[t/2-i[0],t/2+i[1]],this.size_=[t,t]},e.prototype.draw_=function(t,i,n){if(i.scale(n,n),i.translate(t.size/2,t.size/2),this.createPath_(i),this.fill_){var a=this.fill_.getColor();a===null&&(a=ie),i.fillStyle=Kt(a),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e.prototype.createHitDetectionCanvas_=function(t){if(this.fill_){var i=this.fill_.getColor(),n=0;if(typeof i=="string"&&(i=qn(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0){var a=Et(t.size,t.size);this.hitDetectionCanvas_=a.canvas,this.drawHitDetectionCanvas_(t,a)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))},e.prototype.createPath_=function(t){var i=this.points_,n=this.radius_;if(i===Infinity)t.arc(0,0,n,0,2*Math.PI);else{var a=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(i*=2);for(var s=this.angle_-Math.PI/2,o=2*Math.PI/i,h=0;h<i;h++){var l=s+h*o,u=h%2==0?n:a;t.lineTo(u*Math.cos(l),u*Math.sin(l))}t.closePath()}},e.prototype.drawHitDetectionCanvas_=function(t,i){i.translate(t.size/2,t.size/2),this.createPath_(i),i.fillStyle=ie,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke())},e}(Vn),vf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gh=function(r){vf(e,r);function e(t){var i=this,n=t||{};return i=r.call(this,{points:Infinity,fill:n.fill,radius:n.radius,stroke:n.stroke,scale:n.scale!==void 0?n.scale:1,rotation:n.rotation!==void 0?n.rotation:0,rotateWithView:n.rotateWithView!==void 0?n.rotateWithView:!1,displacement:n.displacement!==void 0?n.displacement:[0,0]})||this,i}return e.prototype.clone=function(){var t=this.getScale(),i=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return i.setOpacity(this.getOpacity()),i},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(pf);var Ne=function(){function r(e){var t=e||{};this.geometry_=null,this.geometryFunction_=yh,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}return r.prototype.clone=function(){var e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new r({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},r.prototype.getRenderer=function(){return this.renderer_},r.prototype.setRenderer=function(e){this.renderer_=e},r.prototype.setHitDetectionRenderer=function(e){this.hitDetectionRenderer_=e},r.prototype.getHitDetectionRenderer=function(){return this.hitDetectionRenderer_},r.prototype.getGeometry=function(){return this.geometry_},r.prototype.getGeometryFunction=function(){return this.geometryFunction_},r.prototype.getFill=function(){return this.fill_},r.prototype.setFill=function(e){this.fill_=e},r.prototype.getImage=function(){return this.image_},r.prototype.setImage=function(e){this.image_=e},r.prototype.getStroke=function(){return this.stroke_},r.prototype.setStroke=function(e){this.stroke_=e},r.prototype.getText=function(){return this.text_},r.prototype.setText=function(e){this.text_=e},r.prototype.getZIndex=function(){return this.zIndex_},r.prototype.setGeometry=function(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=yh,this.geometry_=e},r.prototype.setZIndex=function(e){this.zIndex_=e},r}();function xh(r){var e;if(typeof r=="function")e=r;else{var t;if(Array.isArray(r))t=r;else{X(typeof r.getZIndex=="function",41);var i=r;t=[i]}e=function(){return t}}return e}var ls=null;function Eh(r,e){if(!ls){var t=new xe({color:"rgba(255,255,255,0.4)"}),i=new Ie({color:"#3399CC",width:1.25});ls=[new Ne({image:new gh({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return ls}function yh(r){return r.getGeometry()}var Qn={POINT:"point",LINE:"line"};var _f="#333",ir=function(){function r(e){var t=e||{};this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Ct(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new xe({color:_f}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:Qn.POINT,this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}return r.prototype.clone=function(){var e=this.getScale();return new r({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},r.prototype.getOverflow=function(){return this.overflow_},r.prototype.getFont=function(){return this.font_},r.prototype.getMaxAngle=function(){return this.maxAngle_},r.prototype.getPlacement=function(){return this.placement_},r.prototype.getOffsetX=function(){return this.offsetX_},r.prototype.getOffsetY=function(){return this.offsetY_},r.prototype.getFill=function(){return this.fill_},r.prototype.getRotateWithView=function(){return this.rotateWithView_},r.prototype.getRotation=function(){return this.rotation_},r.prototype.getScale=function(){return this.scale_},r.prototype.getScaleArray=function(){return this.scaleArray_},r.prototype.getStroke=function(){return this.stroke_},r.prototype.getText=function(){return this.text_},r.prototype.getTextAlign=function(){return this.textAlign_},r.prototype.getTextBaseline=function(){return this.textBaseline_},r.prototype.getBackgroundFill=function(){return this.backgroundFill_},r.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},r.prototype.getPadding=function(){return this.padding_},r.prototype.setOverflow=function(e){this.overflow_=e},r.prototype.setFont=function(e){this.font_=e},r.prototype.setMaxAngle=function(e){this.maxAngle_=e},r.prototype.setOffsetX=function(e){this.offsetX_=e},r.prototype.setOffsetY=function(e){this.offsetY_=e},r.prototype.setPlacement=function(e){this.placement_=e},r.prototype.setRotateWithView=function(e){this.rotateWithView_=e},r.prototype.setFill=function(e){this.fill_=e},r.prototype.setRotation=function(e){this.rotation_=e},r.prototype.setScale=function(e){this.scale_=e,this.scaleArray_=Ct(e!==void 0?e:1)},r.prototype.setStroke=function(e){this.stroke_=e},r.prototype.setText=function(e){this.text_=e},r.prototype.setTextAlign=function(e){this.textAlign_=e},r.prototype.setTextBaseline=function(e){this.textBaseline_=e},r.prototype.setBackgroundFill=function(e){this.backgroundFill_=e},r.prototype.setBackgroundStroke=function(e){this.backgroundStroke_=e},r.prototype.setPadding=function(e){this.padding_=e},r}();function Th(r,e,t,i,n){Mh(r,e,t||0,i||r.length-1,n||mf)}function Mh(r,e,t,i,n){for(;i>t;){if(i-t>600){var a=i-t+1,s=e-t+1,o=Math.log(a),h=.5*Math.exp(2*o/3),l=.5*Math.sqrt(o*h*(a-h)/a)*(s-a/2<0?-1:1),u=Math.max(t,Math.floor(e-s*h/a+l)),f=Math.min(i,Math.floor(e+(a-s)*h/a+l));Mh(r,e,u,f,n)}var c=r[e],p=t,d=i;for(Xr(r,t,e),n(r[i],c)>0&&Xr(r,t,i);p<d;){for(Xr(r,p,d),p++,d--;n(r[p],c)<0;)p++;for(;n(r[d],c)>0;)d--}n(r[t],c)===0?Xr(r,t,d):(d++,Xr(r,d,i)),d<=e&&(t=d+1),e<=d&&(i=d-1)}}function Xr(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}function mf(r,e){return r<e?-1:r>e?1:0}var Ch=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data,i=[];if(!ea(e,t))return i;let n=this.toBBox,a=[];for(;t;){for(let s=0;s<t.children.length;s++){let o=t.children[s],h=t.leaf?n(o):o;ea(e,h)&&(t.leaf?i.push(o):fs(e,h)?this._all(o,i):a.push(o))}t=a.pop()}return i}collides(e){let t=this.data;if(!ea(e,t))return!1;let i=[];for(;t;){for(let n=0;n<t.children.length;n++){let a=t.children[n],s=t.leaf?this.toBBox(a):a;if(ea(e,s)){if(t.leaf||fs(e,s))return!0;i.push(a)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){let i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=nr([]),this}remove(e,t){if(!e)return this;let i=this.data,n=this.toBBox(e),a=[],s=[],o,h,l;for(;i||a.length;){if(i||(i=a.pop(),h=a[a.length-1],o=s.pop(),l=!0),i.leaf){let u=gf(e,i.children,t);if(u!==-1)return i.children.splice(u,1),a.push(i),this._condense(a),this}!l&&!i.leaf&&fs(i,n)?(a.push(i),s.push(o),o=0,h=i,i=i.children[0]):h?(o++,i=h.children[o],l=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){let i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,n){let a=i-t+1,s=this._maxEntries,o;if(a<=s)return o=nr(e.slice(t,i+1)),rr(o,this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),o=nr([]),o.leaf=!1,o.height=n;let h=Math.ceil(a/s),l=h*Math.ceil(Math.sqrt(s));Sh(e,t,i,l,this.compareMinX);for(let u=t;u<=i;u+=l){let f=Math.min(u+l-1,i);Sh(e,u,f,h,this.compareMinY);for(let c=u;c<=f;c+=h){let p=Math.min(c+h-1,f);o.children.push(this._build(e,c,p,n-1))}}return rr(o,this.toBBox),o}_chooseSubtree(e,t,i,n){for(;n.push(t),!(t.leaf||n.length-1===i);){let a=Infinity,s=Infinity,o;for(let h=0;h<t.children.length;h++){let l=t.children[h],u=us(l),f=Ef(e,l)-u;f<s?(s=f,a=u<a?u:a,o=l):f===s&&u<a&&(a=u,o=l)}t=o||t.children[0]}return t}_insert(e,t,i){let n=i?e:this.toBBox(e),a=[],s=this._chooseSubtree(n,this.data,t,a);for(s.children.push(e),zr(s,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)}_split(e,t){let i=e[t],n=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,n);let s=this._chooseSplitIndex(i,a,n),o=nr(i.children.splice(s,i.children.length-s));o.height=i.height,o.leaf=i.leaf,rr(i,this.toBBox),rr(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o)}_splitRoot(e,t){this.data=nr([e,t]),this.data.height=e.height+1,this.data.leaf=!1,rr(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let n,a=Infinity,s=Infinity;for(let o=t;o<=i-t;o++){let h=Ur(e,0,o,this.toBBox),l=Ur(e,o,i,this.toBBox),u=Mf(h,l),f=us(h)+us(l);u<a?(a=u,n=o,s=f<s?f:s):u===a&&f<s&&(s=f,n=o)}return n||i-t}_chooseSplitAxis(e,t,i){let n=e.leaf?this.compareMinX:yf,a=e.leaf?this.compareMinY:xf,s=this._allDistMargin(e,t,i,n),o=this._allDistMargin(e,t,i,a);s<o&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);let a=this.toBBox,s=Ur(e,0,t,a),o=Ur(e,i-t,i,a),h=ta(s)+ta(o);for(let l=t;l<i-t;l++){let u=e.children[l];zr(s,e.leaf?a(u):u),h+=ta(s)}for(let l=i-t-1;l>=t;l--){let u=e.children[l];zr(o,e.leaf?a(u):u),h+=ta(o)}return h}_adjustParentBBoxes(e,t,i){for(let n=i;n>=0;n--)zr(t[n],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():rr(e[t],this.toBBox)}};function gf(r,e,t){if(!t)return e.indexOf(r);for(let i=0;i<e.length;i++)if(t(r,e[i]))return i;return-1}function rr(r,e){Ur(r,0,r.children.length,e,r)}function Ur(r,e,t,i,n){n||(n=nr(null)),n.minX=Infinity,n.minY=Infinity,n.maxX=-Infinity,n.maxY=-Infinity;for(let a=e;a<t;a++){let s=r.children[a];zr(n,r.leaf?i(s):s)}return n}function zr(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function yf(r,e){return r.minX-e.minX}function xf(r,e){return r.minY-e.minY}function us(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function ta(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Ef(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function Mf(r,e){let t=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),n=Math.min(r.maxX,e.maxX),a=Math.min(r.maxY,e.maxY);return Math.max(0,n-t)*Math.max(0,a-i)}function fs(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function ea(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function nr(r){return{children:r,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function Sh(r,e,t,i,n){let a=[e,t];for(;a.length;){if(t=a.pop(),e=a.pop(),t-e<=i)continue;let s=e+Math.ceil((t-e)/i/2)*i;Th(r,s,e,t,n),a.push(e,s,s,t)}}var ia=Ch;var cs=function(){function r(){}return r.prototype.drawCustom=function(e,t,i,n){},r.prototype.drawGeometry=function(e){},r.prototype.setStyle=function(e){},r.prototype.drawCircle=function(e,t){},r.prototype.drawFeature=function(e,t){},r.prototype.drawGeometryCollection=function(e,t){},r.prototype.drawLineString=function(e,t){},r.prototype.drawMultiLineString=function(e,t){},r.prototype.drawMultiPoint=function(e,t){},r.prototype.drawMultiPolygon=function(e,t){},r.prototype.drawPoint=function(e,t){},r.prototype.drawPolygon=function(e,t){},r.prototype.drawText=function(e,t){},r.prototype.setFillStrokeStyle=function(e,t){},r.prototype.setImageStyle=function(e,t){},r.prototype.setTextStyle=function(e,t){},r}(),lt={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},Tf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ra=function(r){Tf(e,r);function e(t,i,n,a,s,o,h){var l=r.call(this)||this;return l.context_=t,l.pixelRatio_=i,l.extent_=n,l.transform_=a,l.viewRotation_=s,l.squaredTolerance_=o,l.userTransform_=h,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=bt(),l}return e.prototype.drawImages_=function(t,i,n,a){if(!!this.image_){var s=Ee(t,i,n,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var f=0,c=s.length;f<c;f+=2){var p=s[f]-this.imageAnchorX_,d=s[f+1]-this.imageAnchorY_;if(u!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){var v=p+this.imageAnchorX_,_=d+this.imageAnchorY_;jt(h,v,_,1,1,u,-v,-_),o.setTransform.apply(o,h),o.translate(v,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,p,d,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}},e.prototype.drawText_=function(t,i,n,a){if(!(!this.textState_||this.text_==="")){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var s=Ee(t,i,n,a,this.transform_,this.pixelCoordinates_),o=this.context_,h=this.textRotation_;for(this.textRotateWithView_&&(h+=this.viewRotation_);i<n;i+=a){var l=s[i]+this.textOffsetX_,u=s[i+1]+this.textOffsetY_;if(h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1){var f=jt(this.tmpLocalTransform_,l,u,1,1,h,-l,-u);o.setTransform.apply(o,f),o.translate(l,u),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)}else this.textStrokeState_&&o.strokeText(this.text_,l,u),this.textFillState_&&o.fillText(this.text_,l,u)}}},e.prototype.moveToLineTo_=function(t,i,n,a,s){var o=this.context_,h=Ee(t,i,n,a,this.transform_,this.pixelCoordinates_);o.moveTo(h[0],h[1]);var l=h.length;s&&(l-=2);for(var u=2;u<l;u+=2)o.lineTo(h[u],h[u+1]);return s&&o.closePath(),n},e.prototype.drawRings_=function(t,i,n,a){for(var s=0,o=n.length;s<o;++s)i=this.moveToLineTo_(t,i,n[s],a,!0);return i},e.prototype.drawCircle=function(t){if(!!ct(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=Qo(t,this.transform_,this.pixelCoordinates_),n=i[2]-i[0],a=i[3]-i[1],s=Math.sqrt(n*n+a*a),o=this.context_;o.beginPath(),o.arc(i[0],i[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){var i=t.getType();switch(i){case k.POINT:this.drawPoint(t);break;case k.LINE_STRING:this.drawLineString(t);break;case k.POLYGON:this.drawPolygon(t);break;case k.MULTI_POINT:this.drawMultiPoint(t);break;case k.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case k.MULTI_POLYGON:this.drawMultiPolygon(t);break;case k.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case k.CIRCLE:this.drawCircle(t);break}},e.prototype.drawFeature=function(t,i){var n=i.getGeometryFunction()(t);!n||!ct(this.extent_,n.getExtent())||(this.setStyle(i),this.drawGeometry(n))},e.prototype.drawGeometryCollection=function(t){for(var i=t.getGeometriesArray(),n=0,a=i.length;n<a;++n)this.drawGeometry(i[n])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(i,0,i.length,n),this.text_!==""&&this.drawText_(i,0,i.length,n)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(i,0,i.length,n),this.text_!==""&&this.drawText_(i,0,i.length,n)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates();i.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),i.stroke()}if(this.text_!==""){var a=t.getFlatMidpoint();this.drawText_(a,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var i=t.getExtent();if(!!ct(this.extent_,i)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,a=t.getFlatCoordinates(),s=0,o=t.getEnds(),h=t.getStride();n.beginPath();for(var l=0,u=o.length;l<u;++l)s=this.moveToLineTo_(a,s,o[l],h,!1);n.stroke()}if(this.text_!==""){var f=t.getFlatMidpoints();this.drawText_(f,0,f.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_;i.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ct(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getOrientedFlatCoordinates(),a=0,s=t.getEndss(),o=t.getStride();i.beginPath();for(var h=0,l=s.length;h<l;++h){var u=s[h];a=this.drawRings_(n,a,u,o)}this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(this.text_!==""){var f=t.getFlatInteriorPoints();this.drawText_(f,0,f.length,2)}}},e.prototype.setContextFillState_=function(t){var i=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,i.fillStyle=t.fillStyle):(i.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var i=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,i.lineCap=t.lineCap),i.setLineDash&&(oe(n.lineDash,t.lineDash)||i.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,i.lineDashOffset=t.lineDashOffset)),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,i.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,i.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,i.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,i.strokeStyle=t.strokeStyle)):(i.lineCap=t.lineCap,i.setLineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineJoin=t.lineJoin,i.lineWidth=t.lineWidth,i.miterLimit=t.miterLimit,i.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var i=this.context_,n=this.contextTextState_,a=t.textAlign?t.textAlign:Ci;n?(n.font!=t.font&&(n.font=t.font,i.font=t.font),n.textAlign!=a&&(n.textAlign=a,i.textAlign=a),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,i.textBaseline=t.textBaseline)):(i.font=t.font,i.textAlign=a,i.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,i){var n=this;if(!t)this.fillState_=null;else{var a=t.getColor();this.fillState_={fillStyle:Kt(a||ie)}}if(!i)this.strokeState_=null;else{var s=i.getColor(),o=i.getLineCap(),h=i.getLineDash(),l=i.getLineDashOffset(),u=i.getLineJoin(),f=i.getWidth(),c=i.getMiterLimit(),p=h||Mi;this.strokeState_={lineCap:o!==void 0?o:Qi,lineDash:this.pixelRatio_===1?p:p.map(function(d){return d*n.pixelRatio_}),lineDashOffset:(l||Ti)*this.pixelRatio_,lineJoin:u!==void 0?u:De,lineWidth:(f!==void 0?f:ai)*this.pixelRatio_,miterLimit:c!==void 0?c:ii,strokeStyle:Kt(s||ri)}}},e.prototype.setImageStyle=function(t){var i;if(!t||!(i=t.getSize())){this.image_=null;return}var n=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*this.pixelRatio_,this.imageAnchorY_=n[1]*this.pixelRatio_,this.imageHeight_=i[1]*this.pixelRatio_,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScaleArray(),this.imageWidth_=i[0]*this.pixelRatio_},e.prototype.setTextStyle=function(t){if(!t)this.text_="";else{var i=t.getFill();if(!i)this.textFillState_=null;else{var n=i.getColor();this.textFillState_={fillStyle:Kt(n||ie)}}var a=t.getStroke();if(!a)this.textStrokeState_=null;else{var s=a.getColor(),o=a.getLineCap(),h=a.getLineDash(),l=a.getLineDashOffset(),u=a.getLineJoin(),f=a.getWidth(),c=a.getMiterLimit();this.textStrokeState_={lineCap:o!==void 0?o:Qi,lineDash:h||Mi,lineDashOffset:l||Ti,lineJoin:u!==void 0?u:De,lineWidth:f!==void 0?f:ai,miterLimit:c!==void 0?c:ii,strokeStyle:Kt(s||ri)}}var p=t.getFont(),d=t.getOffsetX(),v=t.getOffsetY(),_=t.getRotateWithView(),m=t.getRotation(),g=t.getScaleArray(),y=t.getText(),x=t.getTextAlign(),E=t.getTextBaseline();this.textState_={font:p!==void 0?p:$n,textAlign:x!==void 0?x:Ci,textBaseline:E!==void 0?E:tr},this.text_=y!==void 0?y:"",this.textOffsetX_=d!==void 0?this.pixelRatio_*d:0,this.textOffsetY_=v!==void 0?this.pixelRatio_*v:0,this.textRotateWithView_=_!==void 0?_:!1,this.textRotation_=m!==void 0?m:0,this.textScale_=[this.pixelRatio_*g[0],this.pixelRatio_*g[1]]}},e}(cs),Cf=.5,Ih={Point:Lf,LineString:Of,Polygon:Af,MultiPoint:Pf,MultiLineString:Rf,MultiPolygon:wf,GeometryCollection:If,Circle:Sf};function Oh(r,e){return parseInt(V(r),10)-parseInt(V(e),10)}function aa(r,e){var t=na(r,e);return t*t}function na(r,e){return Cf*r/e}function Sf(r,e,t,i,n){var a=t.getFill(),s=t.getStroke();if(a||s){var o=r.getBuilder(t.getZIndex(),lt.CIRCLE);o.setFillStrokeStyle(a,s),o.drawCircle(e,i)}var h=t.getText();if(h&&h.getText()){var l=(n||r).getBuilder(t.getZIndex(),lt.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function ds(r,e,t,i,n,a,s){var o=!1,h=t.getImage();if(h){var l=h.getImageState();l==tt.LOADED||l==tt.ERROR?h.unlistenImageChange(n):(l==tt.IDLE&&h.load(),l=h.getImageState(),h.listenImageChange(n),o=!0)}return bf(r,e,t,i,a,s),o}function bf(r,e,t,i,n,a){var s=t.getGeometryFunction()(e);if(!!s){var o=s.simplifyTransformed(i,n),h=t.getRenderer();if(h)Rh(r,o,t,e);else{var l=Ih[o.getType()];l(r,o,t,e,a)}}}function Rh(r,e,t,i){if(e.getType()==k.GEOMETRY_COLLECTION){for(var n=e.getGeometries(),a=0,s=n.length;a<s;++a)Rh(r,n[a],t,i);return}var o=r.getBuilder(t.getZIndex(),lt.DEFAULT);o.drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer())}function If(r,e,t,i,n){var a=e.getGeometriesArray(),s,o;for(s=0,o=a.length;s<o;++s){var h=Ih[a[s].getType()];h(r,a[s],t,i,n)}}function Of(r,e,t,i,n){var a=t.getStroke();if(a){var s=r.getBuilder(t.getZIndex(),lt.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(n||r).getBuilder(t.getZIndex(),lt.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function Rf(r,e,t,i,n){var a=t.getStroke();if(a){var s=r.getBuilder(t.getZIndex(),lt.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawMultiLineString(e,i)}var o=t.getText();if(o&&o.getText()){var h=(n||r).getBuilder(t.getZIndex(),lt.TEXT);h.setTextStyle(o),h.drawText(e,i)}}function wf(r,e,t,i,n){var a=t.getFill(),s=t.getStroke();if(s||a){var o=r.getBuilder(t.getZIndex(),lt.POLYGON);o.setFillStrokeStyle(a,s),o.drawMultiPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(n||r).getBuilder(t.getZIndex(),lt.TEXT);l.setTextStyle(h),l.drawText(e,i)}}function Lf(r,e,t,i,n){var a=t.getImage(),s=t.getText(),o;if(n&&(r=n,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=tt.LOADED)return;var h=r.getBuilder(t.getZIndex(),lt.IMAGE);h.setImageStyle(a,o),h.drawPoint(e,i)}if(s&&s.getText()){var l=r.getBuilder(t.getZIndex(),lt.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function Pf(r,e,t,i,n){var a=t.getImage(),s=t.getText(),o;if(n&&(r=n,o=a&&s&&s.getText()?{}:void 0),a){if(a.getImageState()!=tt.LOADED)return;var h=r.getBuilder(t.getZIndex(),lt.IMAGE);h.setImageStyle(a,o),h.drawMultiPoint(e,i)}if(s&&s.getText()){var l=(n||r).getBuilder(t.getZIndex(),lt.TEXT);l.setTextStyle(s,o),l.drawText(e,i)}}function Af(r,e,t,i,n){var a=t.getFill(),s=t.getStroke();if(a||s){var o=r.getBuilder(t.getZIndex(),lt.POLYGON);o.setFillStrokeStyle(a,s),o.drawPolygon(e,i)}var h=t.getText();if(h&&h.getText()){var l=(n||r).getBuilder(t.getZIndex(),lt.TEXT);l.setTextStyle(h),l.drawText(e,i)}}var jf=function(){function r(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return r.prototype.clear=function(){this.cache_={},this.cacheSize_=0},r.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},r.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var i=this.cache_[t];(e++&3)==0&&!i.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},r.prototype.get=function(e,t,i){var n=wh(e,t,i);return n in this.cache_?this.cache_[n]:null},r.prototype.set=function(e,t,i,n){var a=wh(e,t,i);this.cache_[a]=n,++this.cacheSize_},r.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},r}();function wh(r,e,t){var i=t?Zn(t):"null";return e+":"+r+":"+i}var ar=new jf;var Ff=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Df=function(r){Ff(e,r);function e(t,i,n,a){var s=r.call(this)||this;return s.extent=t,s.pixelRatio_=n,s.resolution=i,s.state=a,s}return e.prototype.changed=function(){this.dispatchEvent(D.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return z()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){z()},e}(Jt),Nf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),G1=function(r){Nf(e,r);function e(t,i,n,a,s,o){var h=r.call(this,t,i,n,tt.IDLE)||this;return h.src_=a,h.image_=new Image,s!==null&&(h.image_.crossOrigin=s),h.unlisten_=null,h.state=tt.IDLE,h.imageLoadFunction_=o,h}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=tt.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=ft(this.extent)/this.image_.height),this.state=tt.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==tt.IDLE||this.state==tt.ERROR)&&(this.state=tt.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=Wr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=ft(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Df);function Wr(r,e,t){var i=r;if(i.src&&ko){var n=i.decode(),a=!0,s=function(){a=!1};return n.then(function(){a&&e()}).catch(function(h){a&&(h.name==="EncodingError"&&h.message==="Invalid image type."?e():t())}),s}var o=[Di(i,D.LOAD,e),Di(i,D.ERROR,t)];return function(){o.forEach(Q)}}var Ge={FRACTION:"fraction",PIXELS:"pixels"},re={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Gf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yr=null,kf=function(r){Gf(e,r);function e(t,i,n,a,s,o){var h=r.call(this)||this;return h.hitDetectionImage_=null,h.image_=t||new Image,a!==null&&(h.image_.crossOrigin=a),h.canvas_={},h.color_=o,h.unlisten_=null,h.imageState_=s,h.size_=n,h.src_=i,h.tainted_,h}return e.prototype.isTainted_=function(){if(this.tainted_===void 0&&this.imageState_===tt.LOADED){Yr||(Yr=Et(1,1)),Yr.drawImage(this.image_,0,0);try{Yr.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Yr=null,this.tainted_=!0}}return this.tainted_===!0},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(D.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=tt.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=tt.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_},e.prototype.getPixelRatio=function(t){return this.replaceColor_(t),this.canvas_[t]?t:1},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(){if(!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],i=this.size_[1],n=Et(t,i);n.fillRect(0,0,t,i),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==tt.IDLE){this.imageState_=tt.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=Wr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(t){if(!(!this.color_||this.canvas_[t]||this.imageState_!==tt.LOADED)){var i=document.createElement("canvas");this.canvas_[t]=i,i.width=Math.ceil(this.image_.width*t),i.height=Math.ceil(this.image_.height*t);var n=i.getContext("2d");if(n.scale(t,t),n.drawImage(this.image_,0,0),n.globalCompositeOperation="multiply",n.globalCompositeOperation==="multiply"||this.isTainted_())n.fillStyle=Zn(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(this.image_,0,0);else{for(var a=n.getImageData(0,0,i.width,i.height),s=a.data,o=this.color_[0]/255,h=this.color_[1]/255,l=this.color_[2]/255,u=this.color_[3],f=0,c=s.length;f<c;f+=4)s[f]*=o,s[f+1]*=h,s[f+2]*=l,s[f+3]*=u;n.putImageData(a,0,0)}}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Jt);function Bf(r,e,t,i,n,a){var s=ar.get(e,i,a);return s||(s=new kf(r,e,t,i,n,a),ar.set(e,i,a,s)),s}var Xf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Lh=function(r){Xf(e,r);function e(t){var i=this,n=t||{},a=n.opacity!==void 0?n.opacity:1,s=n.rotation!==void 0?n.rotation:0,o=n.scale!==void 0?n.scale:1,h=n.rotateWithView!==void 0?n.rotateWithView:!1;i=r.call(this,{opacity:a,rotation:s,scale:o,displacement:n.displacement!==void 0?n.displacement:[0,0],rotateWithView:h})||this,i.anchor_=n.anchor!==void 0?n.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=n.anchorOrigin!==void 0?n.anchorOrigin:re.TOP_LEFT,i.anchorXUnits_=n.anchorXUnits!==void 0?n.anchorXUnits:Ge.FRACTION,i.anchorYUnits_=n.anchorYUnits!==void 0?n.anchorYUnits:Ge.FRACTION,i.crossOrigin_=n.crossOrigin!==void 0?n.crossOrigin:null;var l=n.img!==void 0?n.img:null,u=n.imgSize!==void 0?n.imgSize:null,f=n.src;X(!(f!==void 0&&l),4),X(!l||l&&u,5),(f===void 0||f.length===0)&&l&&(f=l.src||V(l)),X(f!==void 0&&f.length>0,6);var c=n.src!==void 0?tt.IDLE:tt.LOADED;return i.color_=n.color!==void 0?qn(n.color):null,i.iconImage_=Bf(l,f,u,i.crossOrigin_,c,i.color_),i.offset_=n.offset!==void 0?n.offset:[0,0],i.offsetOrigin_=n.offsetOrigin!==void 0?n.offsetOrigin:re.TOP_LEFT,i.origin_=null,i.size_=n.size!==void 0?n.size:null,i}return e.prototype.clone=function(){var t=this.getScale();return new e({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:this.size_!==null?this.size_.slice():void 0,opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},e.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,i=this.getSize();if(this.anchorXUnits_==Ge.FRACTION||this.anchorYUnits_==Ge.FRACTION){if(!i)return null;t=this.anchor_.slice(),this.anchorXUnits_==Ge.FRACTION&&(t[0]*=i[0]),this.anchorYUnits_==Ge.FRACTION&&(t[1]*=i[1])}if(this.anchorOrigin_!=re.TOP_LEFT){if(!i)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_==re.TOP_RIGHT||this.anchorOrigin_==re.BOTTOM_RIGHT)&&(t[0]=-t[0]+i[0]),(this.anchorOrigin_==re.BOTTOM_LEFT||this.anchorOrigin_==re.BOTTOM_RIGHT)&&(t[1]=-t[1]+i[1])}var n=this.getDisplacement();return t[0]-=n[0],t[1]+=n[1],this.normalizedAnchor_=t,this.normalizedAnchor_},e.prototype.setAnchor=function(t){this.anchor_=t,this.normalizedAnchor_=null},e.prototype.getColor=function(){return this.color_},e.prototype.getImage=function(t){return this.iconImage_.getImage(t)},e.prototype.getPixelRatio=function(t){return this.iconImage_.getPixelRatio(t)},e.prototype.getImageSize=function(){return this.iconImage_.getSize()},e.prototype.getImageState=function(){return this.iconImage_.getImageState()},e.prototype.getHitDetectionImage=function(){return this.iconImage_.getHitDetectionImage()},e.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=re.TOP_LEFT){var i=this.getSize(),n=this.iconImage_.getSize();if(!i||!n)return null;t=t.slice(),(this.offsetOrigin_==re.TOP_RIGHT||this.offsetOrigin_==re.BOTTOM_RIGHT)&&(t[0]=n[0]-i[0]-t[0]),(this.offsetOrigin_==re.BOTTOM_LEFT||this.offsetOrigin_==re.BOTTOM_RIGHT)&&(t[1]=n[1]-i[1]-t[1])}return this.origin_=t,this.origin_},e.prototype.getSrc=function(){return this.iconImage_.getSrc()},e.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},e.prototype.listenImageChange=function(t){this.iconImage_.addEventListener(D.CHANGE,t)},e.prototype.load=function(){this.iconImage_.load()},e.prototype.unlistenImageChange=function(t){this.iconImage_.removeEventListener(D.CHANGE,t)},e}(Vn);var Uf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ph={RENDER_ORDER:"renderOrder"},Ah=function(r){Uf(e,r);function e(t){var i=this,n=t||{},a=nt({},n);return delete a.style,delete a.renderBuffer,delete a.updateWhileAnimating,delete a.updateWhileInteracting,i=r.call(this,a)||this,i.declutter_=n.declutter!==void 0?n.declutter:!1,i.renderBuffer_=n.renderBuffer!==void 0?n.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(n.style),i.updateWhileAnimating_=n.updateWhileAnimating!==void 0?n.updateWhileAnimating:!1,i.updateWhileInteracting_=n.updateWhileInteracting!==void 0?n.updateWhileInteracting:!1,i}return e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(t){return r.prototype.getFeatures.call(this,t)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Ph.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new ia(9)),this.getRenderer().renderDeclutter(t)},e.prototype.setRenderOrder=function(t){this.set(Ph.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=t!==void 0?t:Eh,this.styleFunction_=t===null?void 0:xh(this.style_),this.changed()},e}(In),N={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},sa=[N.FILL],si=[N.STROKE],Si=[N.BEGIN_PATH],bh=[N.CLOSE_PATH],zf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Vr=function(r){zf(e,r);function e(t,i,n,a){var s=r.call(this)||this;return s.tolerance=t,s.maxExtent=i,s.pixelRatio=a,s.maxLineWidth=0,s.resolution=n,s.beginGeometryInstruction1_=null,s.beginGeometryInstruction2_=null,s.bufferedMaxExtent_=null,s.instructions=[],s.coordinates=[],s.tmpCoordinate_=[],s.hitDetectionInstructions=[],s.state={},s}return e.prototype.applyPixelRatio=function(t){var i=this.pixelRatio;return i==1?t:t.map(function(n){return n*i})},e.prototype.appendFlatPointCoordinates=function(t,i){for(var n=this.getBufferedMaxExtent(),a=this.tmpCoordinate_,s=this.coordinates,o=s.length,h=0,l=t.length;h<l;h+=i)a[0]=t[h],a[1]=t[h+1],mt(n,a)&&(s[o++]=a[0],s[o++]=a[1]);return o},e.prototype.appendFlatLineCoordinates=function(t,i,n,a,s,o){var h=this.coordinates,l=h.length,u=this.getBufferedMaxExtent();o&&(i+=a);var f=t[i],c=t[i+1],p=this.tmpCoordinate_,d=!0,v,_,m;for(v=i+a;v<n;v+=a)p[0]=t[v],p[1]=t[v+1],m=Fn(u,p),m!==_?(d&&(h[l++]=f,h[l++]=c,d=!1),h[l++]=p[0],h[l++]=p[1]):m===_t.INTERSECTING?(h[l++]=p[0],h[l++]=p[1],d=!1):d=!0,f=p[0],c=p[1],_=m;return(s&&d||v===i+a)&&(h[l++]=f,h[l++]=c),l},e.prototype.drawCustomCoordinates_=function(t,i,n,a,s){for(var o=0,h=n.length;o<h;++o){var l=n[o],u=this.appendFlatLineCoordinates(t,i,l,a,!1,!1);s.push(u),i=l}return i},e.prototype.drawCustom=function(t,i,n,a){this.beginGeometry(t,i);var s=t.getType(),o=t.getStride(),h=this.coordinates.length,l,u,f,c,p;switch(s){case k.MULTI_POLYGON:l=t.getOrientedFlatCoordinates(),c=[];var d=t.getEndss();p=0;for(var v=0,_=d.length;v<_;++v){var m=[];p=this.drawCustomCoordinates_(l,p,d[v],o,m),c.push(m)}this.instructions.push([N.CUSTOM,h,c,t,n,ts]),this.hitDetectionInstructions.push([N.CUSTOM,h,c,t,a||n,ts]);break;case k.POLYGON:case k.MULTI_LINE_STRING:f=[],l=s==k.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),p=this.drawCustomCoordinates_(l,0,t.getEnds(),o,f),this.instructions.push([N.CUSTOM,h,f,t,n,ei]),this.hitDetectionInstructions.push([N.CUSTOM,h,f,t,a||n,ei]);break;case k.LINE_STRING:case k.CIRCLE:l=t.getFlatCoordinates(),u=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([N.CUSTOM,h,u,t,n,Ce]),this.hitDetectionInstructions.push([N.CUSTOM,h,u,t,a||n,Ce]);break;case k.MULTI_POINT:l=t.getFlatCoordinates(),u=this.appendFlatPointCoordinates(l,o),u>h&&(this.instructions.push([N.CUSTOM,h,u,t,n,Ce]),this.hitDetectionInstructions.push([N.CUSTOM,h,u,t,a||n,Ce]));break;case k.POINT:l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),u=this.coordinates.length,this.instructions.push([N.CUSTOM,h,u,t,n]),this.hitDetectionInstructions.push([N.CUSTOM,h,u,t,a||n]);break}this.endGeometry(i)},e.prototype.beginGeometry=function(t,i){this.beginGeometryInstruction1_=[N.BEGIN_GEOMETRY,i,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[N.BEGIN_GEOMETRY,i,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var i,n=t.length,a,s,o=-1;for(i=0;i<n;++i)a=t[i],s=a[0],s==N.END_GEOMETRY?o=i:s==N.BEGIN_GEOMETRY&&(a[2]=i,_o(this.hitDetectionInstructions,o,i),o=-1)},e.prototype.setFillStrokeStyle=function(t,i){var n=this.state;if(t){var a=t.getColor();n.fillStyle=Kt(a||ie)}else n.fillStyle=void 0;if(i){var s=i.getColor();n.strokeStyle=Kt(s||ri);var o=i.getLineCap();n.lineCap=o!==void 0?o:Qi;var h=i.getLineDash();n.lineDash=h?h.slice():Mi;var l=i.getLineDashOffset();n.lineDashOffset=l||Ti;var u=i.getLineJoin();n.lineJoin=u!==void 0?u:De;var f=i.getWidth();n.lineWidth=f!==void 0?f:ai;var c=i.getMiterLimit();n.miterLimit=c!==void 0?c:ii,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0},e.prototype.createFill=function(t){var i=t.fillStyle,n=[N.SET_FILL_STYLE,i];return typeof i!="string"&&n.push(!0),n},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[N.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,i){var n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(i.call(this,t)),t.currentFillStyle=n)},e.prototype.updateStrokeStyle=function(t,i){var n=t.strokeStyle,a=t.lineCap,s=t.lineDash,o=t.lineDashOffset,h=t.lineJoin,l=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=a||s!=t.currentLineDash&&!oe(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=h||t.currentLineWidth!=l||t.currentMiterLimit!=u)&&(n!==void 0&&i.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=a,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=h,t.currentLineWidth=l,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[N.END_GEOMETRY,t];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=jn(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Ar(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(cs),Wf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Yf=function(r){Wf(e,r);function e(t,i,n,a){var s=r.call(this,t,i,n,a)||this;return s.hitDetectionImage_=null,s.image_=null,s.imagePixelRatio_=void 0,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s.declutterImageWithText_=void 0,s}return e.prototype.drawPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var n=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,a);this.instructions.push([N.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([N.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.drawMultiPoint=function(t,i){if(!!this.image_){this.beginGeometry(t,i);var n=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,a);this.instructions.push([N.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterImageWithText_]),this.hitDetectionInstructions.push([N.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterImageWithText_]),this.endGeometry(i)}},e.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,r.prototype.finish.call(this)},e.prototype.setImageStyle=function(t,i){var n=t.getAnchor(),a=t.getSize(),s=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),h=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=s,this.image_=o,this.height_=a[1],this.opacity_=t.getOpacity(),this.originX_=h[0]*this.imagePixelRatio_,this.originY_=h[1]*this.imagePixelRatio_,this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=a[0],this.declutterImageWithText_=i},e}(Vr),Vf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Zf=function(r){Vf(e,r);function e(t,i,n,a){return r.call(this,t,i,n,a)||this}return e.prototype.drawFlatCoordinates_=function(t,i,n,a){var s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,i,n,a,!1,!1),h=[N.MOVE_TO_LINE_TO,s,o];return this.instructions.push(h),this.hitDetectionInstructions.push(h),n},e.prototype.drawLineString=function(t,i){var n=this.state,a=n.strokeStyle,s=n.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([N.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Mi,Ti],Si);var o=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(o,0,o.length,h),this.hitDetectionInstructions.push(si),this.endGeometry(i)}},e.prototype.drawMultiLineString=function(t,i){var n=this.state,a=n.strokeStyle,s=n.lineWidth;if(!(a===void 0||s===void 0)){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([N.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],Si);for(var o=t.getEnds(),h=t.getFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinates_(h,u,o[f],l);this.hitDetectionInstructions.push(si),this.endGeometry(i)}},e.prototype.finish=function(){var t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(si),this.reverseHitDetectionInstructions(),this.state=null,r.prototype.finish.call(this)},e.prototype.applyStroke=function(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(si),t.lastStroke=this.coordinates.length),t.lastStroke=0,r.prototype.applyStroke.call(this,t),this.instructions.push(Si)},e}(Vr),qf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jh=function(r){qf(e,r);function e(t,i,n,a){return r.call(this,t,i,n,a)||this}return e.prototype.drawFlatCoordinatess_=function(t,i,n,a){var s=this.state,o=s.fillStyle!==void 0,h=s.strokeStyle!==void 0,l=n.length;this.instructions.push(Si),this.hitDetectionInstructions.push(Si);for(var u=0;u<l;++u){var f=n[u],c=this.coordinates.length,p=this.appendFlatLineCoordinates(t,i,f,a,!0,!h),d=[N.MOVE_TO_LINE_TO,c,p];this.instructions.push(d),this.hitDetectionInstructions.push(d),h&&(this.instructions.push(bh),this.hitDetectionInstructions.push(bh)),i=f}return o&&(this.instructions.push(sa),this.hitDetectionInstructions.push(sa)),h&&(this.instructions.push(si),this.hitDetectionInstructions.push(si)),i},e.prototype.drawCircle=function(t,i){var n=this.state,a=n.fillStyle,s=n.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_FILL_STYLE,ie]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getFlatCoordinates(),h=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,h,!1,!1);var u=[N.CIRCLE,l];this.instructions.push(Si,u),this.hitDetectionInstructions.push(Si,u),n.fillStyle!==void 0&&(this.instructions.push(sa),this.hitDetectionInstructions.push(sa)),n.strokeStyle!==void 0&&(this.instructions.push(si),this.hitDetectionInstructions.push(si)),this.endGeometry(i)}},e.prototype.drawPolygon=function(t,i){var n=this.state,a=n.fillStyle,s=n.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_FILL_STYLE,ie]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getEnds(),h=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(h,0,o,l),this.endGeometry(i)}},e.prototype.drawMultiPolygon=function(t,i){var n=this.state,a=n.fillStyle,s=n.strokeStyle;if(!(a===void 0&&s===void 0)){this.setFillStrokeStyles_(),this.beginGeometry(t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_FILL_STYLE,ie]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([N.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);for(var o=t.getEndss(),h=t.getOrientedFlatCoordinates(),l=t.getStride(),u=0,f=0,c=o.length;f<c;++f)u=this.drawFlatCoordinatess_(h,u,o[f],l);this.endGeometry(i)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(t!==0)for(var i=this.coordinates,n=0,a=i.length;n<a;++n)i[n]=ti(i[n],t);return r.prototype.finish.call(this)},e.prototype.setFillStrokeStyles_=function(){var t=this.state,i=t.fillStyle;i!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)},e}(Vr);function Kf(r,e,t,i,n){var a=t,s=t,o=0,h=0,l=t,u,f,c,p,d,v,_,m,g,y;for(f=t;f<i;f+=n){var x=e[f],E=e[f+1];d!==void 0&&(g=x-d,y=E-v,p=Math.sqrt(g*g+y*y),_!==void 0&&(h+=c,u=Math.acos((_*g+m*y)/(c*p)),u>r&&(h>o&&(o=h,a=l,s=f),h=0,l=f-n)),c=p,_=g,m=y),d=x,v=E}return h+=p,h>o?[l,f]:[a,s]}var Hf=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),oa={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},$f=function(r){Hf(e,r);function e(t,i,n,a){var s=r.call(this,t,i,n,a)||this;return s.labels_=null,s.text_="",s.textOffsetX_=0,s.textOffsetY_=0,s.textRotateWithView_=void 0,s.textRotation_=0,s.textFillState_=null,s.fillStates={},s.textStrokeState_=null,s.strokeStates={},s.textState_={},s.textStates={},s.textKey_="",s.fillKey_="",s.strokeKey_="",s.declutterImageWithText_=void 0,s}return e.prototype.finish=function(){var t=r.prototype.finish.call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t},e.prototype.drawText=function(t,i){var n=this.textFillState_,a=this.textStrokeState_,s=this.textState_;if(!(this.text_===""||!s||!n&&!a)){var o=this.coordinates,h=o.length,l=t.getType(),u=null,f=t.getStride();if(s.placement===Qn.LINE&&(l==k.LINE_STRING||l==k.MULTI_LINE_STRING||l==k.POLYGON||l==k.MULTI_POLYGON)){if(!ct(this.getBufferedMaxExtent(),t.getExtent()))return;var c=void 0;if(u=t.getFlatCoordinates(),l==k.LINE_STRING)c=[u.length];else if(l==k.MULTI_LINE_STRING)c=t.getEnds();else if(l==k.POLYGON)c=t.getEnds().slice(0,1);else if(l==k.MULTI_POLYGON){var p=t.getEndss();c=[];for(var d=0,v=p.length;d<v;++d)c.push(p[d][0])}this.beginGeometry(t,i);for(var _=s.textAlign,m=0,g=void 0,y=0,x=c.length;y<x;++y){if(_==null){var E=Kf(s.maxAngle,u,m,c[y],f);m=E[0],g=E[1]}else g=c[y];for(var d=m;d<g;d+=f)o.push(u[d],u[d+1]);var M=o.length;m=c[y],this.drawChars_(h,M),h=M}this.endGeometry(i)}else{var C=s.overflow?null:[];switch(l){case k.POINT:case k.MULTI_POINT:u=t.getFlatCoordinates();break;case k.LINE_STRING:u=t.getFlatMidpoint();break;case k.CIRCLE:u=t.getCenter();break;case k.MULTI_LINE_STRING:u=t.getFlatMidpoints(),f=2;break;case k.POLYGON:u=t.getFlatInteriorPoint(),s.overflow||C.push(u[2]/this.resolution),f=3;break;case k.MULTI_POLYGON:var T=t.getFlatInteriorPoints();u=[];for(var d=0,v=T.length;d<v;d+=3)s.overflow||C.push(T[d+2]/this.resolution),u.push(T[d],T[d+1]);if(u.length===0)return;f=2;break}var M=this.appendFlatPointCoordinates(u,f);if(M===h)return;if(C&&(M-h)/2!=u.length/f){var S=h/2;C=C.filter(function($,q){var et=o[(S+q)*2]===u[q*f]&&o[(S+q)*2+1]===u[q*f+1];return et||--S,et})}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,i);var P=s.padding;if(P!=ni&&(s.scale[0]<0||s.scale[1]<0)){var O=s.padding[0],w=s.padding[1],j=s.padding[2],Y=s.padding[3];s.scale[0]<0&&(w=-w,Y=-Y),s.scale[1]<0&&(O=-O,j=-j),P=[O,w,j,Y]}var B=this.pixelRatio;this.instructions.push([N.DRAW_IMAGE,h,M,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterImageWithText_,P==ni?ni:P.map(function($){return $*B}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,C]);var U=1/B;this.hitDetectionInstructions.push([N.DRAW_IMAGE,h,M,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[U,U],NaN,this.declutterImageWithText_,P,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,C]),this.endGeometry(i)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,i=this.textState_,n=this.textFillState_,a=this.strokeKey_;t&&(a in this.strokeStates||(this.strokeStates[a]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:i.font,textAlign:i.textAlign||Ci,textBaseline:i.textBaseline||tr,scale:i.scale});var o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))},e.prototype.drawChars_=function(t,i){var n=this.textStrokeState_,a=this.textState_,s=this.strokeKey_,o=this.textKey_,h=this.fillKey_;this.saveTextStates_();var l=this.pixelRatio,u=oa[a.textBaseline],f=this.textOffsetY_*l,c=this.text_,p=n?n.lineWidth*Math.abs(a.scale[0])/2:0;this.instructions.push([N.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,l,f,s,p*l,c,o,1]),this.hitDetectionInstructions.push([N.DRAW_CHARS,t,i,u,a.overflow,h,a.maxAngle,1,f,s,p,c,o,1/l])},e.prototype.setTextStyle=function(t,i){var n,a,s;if(!t)this.text_="";else{var o=t.getFill();o?(a=this.textFillState_,a||(a={},this.textFillState_=a),a.fillStyle=Kt(o.getColor()||ie)):(a=null,this.textFillState_=a);var h=t.getStroke();if(!h)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);var l=h.getLineDash(),u=h.getLineDashOffset(),f=h.getWidth(),c=h.getMiterLimit();s.lineCap=h.getLineCap()||Qi,s.lineDash=l?l.slice():Mi,s.lineDashOffset=u===void 0?Ti:u,s.lineJoin=h.getLineJoin()||De,s.lineWidth=f===void 0?ai:f,s.miterLimit=c===void 0?ii:c,s.strokeStyle=Kt(h.getColor()||ri)}n=this.textState_;var p=t.getFont()||$n;dh(p);var d=t.getScaleArray();n.overflow=t.getOverflow(),n.font=p,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.textBaseline=t.getTextBaseline()||tr,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||ni,n.scale=d===void 0?[1,1]:d;var v=t.getOffsetX(),_=t.getOffsetY(),m=t.getRotateWithView(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=v===void 0?0:v,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=m===void 0?!1:m,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:V(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.textBaseline||"?"),this.fillKey_=a?typeof a.fillStyle=="string"?a.fillStyle:"|"+V(a.fillStyle):""}this.declutterImageWithText_=i},e}(Vr),Jf={Circle:jh,Default:Vr,Image:Yf,LineString:Zf,Polygon:jh,Text:$f},ps=function(){function r(e,t,i,n){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}return r.prototype.finish=function(){var e={};for(var t in this.buildersByZIndex_){e[t]=e[t]||{};var i=this.buildersByZIndex_[t];for(var n in i){var a=i[n].finish();e[t][n]=a}}return e},r.prototype.getBuilder=function(e,t){var i=e!==void 0?e.toString():"0",n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);var a=n[t];if(a===void 0){var s=Jf[t];a=new s(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[t]=a}return a},r}();function Qf(r,e,t,i,n,a,s,o,h,l,u,f){var c=r[e],p=r[e+1],d=0,v=0,_=0,m=0;function g(){d=c,v=p,e+=i,c=r[e],p=r[e+1],m+=_,_=Math.sqrt((c-d)*(c-d)+(p-v)*(p-v))}do g();while(e<t-i&&m+_<a);for(var y=_===0?0:(a-m)/_,x=Qt(d,c,y),E=Qt(v,p,y),M=e-i,C=m,T=a+o*h(l,n,u);e<t-i&&m+_<T;)g();y=_===0?0:(T-m)/_;var S=Qt(d,c,y),P=Qt(v,p,y),O;if(f){var w=[x,E,S,P];Rn(w,0,4,2,f,w,w),O=w[0]>w[2]}else O=x>S;var j=Math.PI,Y=[],B=M+i===e;e=M,_=0,m=C,c=r[e],p=r[e+1];var U;if(B){g(),U=Math.atan2(p-v,c-d),O&&(U+=U>0?-j:j);var F=(S+x)/2,$=(P+E)/2;return Y[0]=[F,$,(T-a)/2,U,n],Y}for(var q=0,et=n.length;q<et;){g();var ot=Math.atan2(p-v,c-d);if(O&&(ot+=ot>0?-j:j),U!==void 0){var R=ot-U;if(R+=R>j?-2*j:R<-j?2*j:0,Math.abs(R)>s)return null}U=ot;for(var At=q,K=0;q<et;++q){var pt=O?et-q-1:q,zt=o*h(l,n[pt],u);if(e+i<t&&m+_<a+K+zt/2)break;K+=zt}if(q!==At){var Wt=O?n.substring(et-At,et-q):n.substring(At,q);y=_===0?0:(a+K/2-m)/_;var F=Qt(d,c,y),$=Qt(v,p,y);Y.push([F,$,K/2,ot,Wt]),a+=K}}return Y}var sr=Tt(),oi=[],ke=[],Be=[],hi=[];function Fh(r){return r[3].declutterBox}var tc=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Dh(r,e){return(e==="start"||e==="end")&&!tc.test(r)&&(e=e==="start"?"left":"right"),oa[e]}var ec=function(){function r(e,t,i,n){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=bt(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}return r.prototype.createLabel=function(e,t,i,n){var a=e+t+i+n;if(this.labels_[a])return this.labels_[a];var s=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,h=this.textStates[t],l=this.pixelRatio,u=[h.scale[0]*l,h.scale[1]*l],f=Dh(e,h.textAlign||Ci),c=n&&s.lineWidth?s.lineWidth:0,p=e.split(`
`),d=p.length,v=[],_=_h(h.font,p,v),m=vh(h.font),g=m*d,y=_+c,x=[],E=(y+2)*u[0],M=(g+c)*u[1],C={width:E<0?Math.floor(E):Math.ceil(E),height:M<0?Math.floor(M):Math.ceil(M),contextInstructions:x};if((u[0]!=1||u[1]!=1)&&x.push("scale",u),x.push("font",h.font),n){x.push("strokeStyle",s.strokeStyle),x.push("lineWidth",c),x.push("lineCap",s.lineCap),x.push("lineJoin",s.lineJoin),x.push("miterLimit",s.miterLimit);var T=Je?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D;T.prototype.setLineDash&&(x.push("setLineDash",[s.lineDash]),x.push("lineDashOffset",s.lineDashOffset))}i&&x.push("fillStyle",o.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");var S=.5-f,P=f*y+S*c,O;if(n)for(O=0;O<d;++O)x.push("strokeText",[p[O],P+S*v[O],.5*(c+m)+O*m]);if(i)for(O=0;O<d;++O)x.push("fillText",[p[O],P+S*v[O],.5*(c+m)+O*m]);return this.labels_[a]=C,C},r.prototype.replayTextBackground_=function(e,t,i,n,a,s,o){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,n),e.lineTo.apply(e,a),e.lineTo.apply(e,t),s&&(this.alignFill_=s[2],this.fill_(e)),o&&(this.setStrokeStyle_(e,o),e.stroke())},r.prototype.calculateImageOrLabelDimensions_=function(e,t,i,n,a,s,o,h,l,u,f,c,p,d,v,_){o*=c[0],h*=c[1];var m=i-o,g=n-h,y=a+l>e?e-l:a,x=s+u>t?t-u:s,E=d[3]+y*c[0]+d[1],M=d[0]+x*c[1]+d[2],C=m-d[3],T=g-d[0];(v||f!==0)&&(oi[0]=C,hi[0]=C,oi[1]=T,ke[1]=T,ke[0]=C+E,Be[0]=ke[0],Be[1]=T+M,hi[1]=Be[1]);var S;return f!==0?(S=jt(bt(),i,n,1,1,f,-i,-n),ht(S,oi),ht(S,ke),ht(S,Be),ht(S,hi),Bt(Math.min(oi[0],ke[0],Be[0],hi[0]),Math.min(oi[1],ke[1],Be[1],hi[1]),Math.max(oi[0],ke[0],Be[0],hi[0]),Math.max(oi[1],ke[1],Be[1],hi[1]),sr)):Bt(Math.min(C,C+E),Math.min(T,T+M),Math.max(C,C+E),Math.max(T,T+M),sr),p&&(m=Math.round(m),g=Math.round(g)),{drawImageX:m,drawImageY:g,drawImageW:y,drawImageH:x,originX:l,originY:u,declutterBox:{minX:sr[0],minY:sr[1],maxX:sr[2],maxY:sr[3],value:_},canvasTransform:S,scale:c}},r.prototype.replayImageOrLabel_=function(e,t,i,n,a,s,o){var h=!!(s||o),l=n.declutterBox,u=e.canvas,f=o?o[2]*n.scale[0]/2:0,c=l.minX-f<=u.width/t&&l.maxX+f>=0&&l.minY-f<=u.height/t&&l.maxY+f>=0;return c&&(h&&this.replayTextBackground_(e,oi,ke,Be,hi,s,o),mh(e,n.canvasTransform,a,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0},r.prototype.fill_=function(e){if(this.alignFill_){var t=ht(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(t[0]%i,t[1]%i),e.rotate(this.viewRotation_)}e.fill(),this.alignFill_&&e.restore()},r.prototype.setStrokeStyle_=function(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.setLineDash&&(e.lineDashOffset=t[7],e.setLineDash(t[6]))},r.prototype.drawLabelWithPointPlacement_=function(e,t,i,n){var a=this.textStates[t],s=this.createLabel(e,t,n,i),o=this.strokeStates[i],h=this.pixelRatio,l=Dh(e,a.textAlign||Ci),u=oa[a.textBaseline||tr],f=o&&o.lineWidth?o.lineWidth:0,c=s.width/h-2*a.scale[0],p=l*c+2*(.5-l)*f,d=u*s.height/h+2*(.5-u)*f;return{label:s,anchorX:p,anchorY:d}},r.prototype.execute_=function(e,t,i,n,a,s,o,h){var l;this.pixelCoordinates_&&oe(i,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=Ee(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Xo(this.renderedTransform_,i));for(var u=0,f=n.length,c=0,p,d,v,_,m,g,y,x,E,M,C,T,S=0,P=0,O=null,w=null,j=this.coordinateCache_,Y=this.viewRotation_,B=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,U={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Y},F=this.instructions!=n||this.overlaps?0:200,$,q,et,ot;u<f;){var R=n[u],At=R[0];switch(At){case N.BEGIN_GEOMETRY:$=R[1],ot=R[3],$.getGeometry()?o!==void 0&&!ct(o,ot.getExtent())?u=R[2]+1:++u:u=R[2];break;case N.BEGIN_PATH:S>F&&(this.fill_(e),S=0),P>F&&(e.stroke(),P=0),!S&&!P&&(e.beginPath(),_=NaN,m=NaN),++u;break;case N.CIRCLE:c=R[1];var K=l[c],pt=l[c+1],zt=l[c+2],Wt=l[c+3],Nt=zt-K,Yt=Wt-pt,Li=Math.sqrt(Nt*Nt+Yt*Yt);e.moveTo(K+Li,pt),e.arc(K,pt,Li,0,2*Math.PI,!0),++u;break;case N.CLOSE_PATH:e.closePath(),++u;break;case N.CUSTOM:c=R[1],p=R[2];var me=R[3],dn=R[4],pn=R.length==6?R[5]:void 0;U.geometry=me,U.feature=$,u in j||(j[u]=[]);var We=j[u];pn?pn(l,c,p,2,We):(We[0]=l[c],We[1]=l[c+1],We.length=2),dn(We,U),++u;break;case N.DRAW_IMAGE:c=R[1],p=R[2],x=R[3],d=R[4],v=R[5];var Pi=R[6],vn=R[7],yr=R[8],_n=R[9],vi=R[10],xr=R[11],mn=R[12],Ai=R[13],Ye=R[14];if(!x&&R.length>=19){E=R[18],M=R[19],C=R[20],T=R[21];var bi=this.drawLabelWithPointPlacement_(E,M,C,T);x=bi.label,R[3]=x;var Da=R[22];d=(bi.anchorX-Da)*this.pixelRatio,R[4]=d;var gn=R[23];v=(bi.anchorY-gn)*this.pixelRatio,R[5]=v,Pi=x.height,R[6]=Pi,Ai=x.width,R[13]=Ai}var Er=void 0;R.length>24&&(Er=R[24]);var Ve=void 0,be=void 0,_i=void 0;R.length>16?(Ve=R[15],be=R[16],_i=R[17]):(Ve=ni,be=!1,_i=!1),vi&&B?xr+=Y:!vi&&!B&&(xr-=Y);for(var ji=0;c<p;c+=2)if(!(Er&&Er[ji++]<Ai/this.pixelRatio)){var ae=this.calculateImageOrLabelDimensions_(x.width,x.height,l[c],l[c+1],Ai,Pi,d,v,yr,_n,xr,mn,a,Ve,be||_i,$),se=[e,t,x,ae,vn,be?O:null,_i?w:null],mi=void 0,Fi=void 0;if(h&&Ye){var yn=p-c;if(!Ye[yn]){Ye[yn]=se;continue}if(mi=Ye[yn],delete Ye[yn],Fi=Fh(mi),h.collides(Fi))continue}h&&h.collides(ae.declutterBox)||(mi&&(h&&h.insert(Fi),this.replayImageOrLabel_.apply(this,mi)),h&&h.insert(ae.declutterBox),this.replayImageOrLabel_.apply(this,se))}++u;break;case N.DRAW_CHARS:var ao=R[1],so=R[2],Na=R[3],pu=R[4];T=R[5];var vu=R[6],oo=R[7],ho=R[8];C=R[9];var Ga=R[10];E=R[11],M=R[12];var lo=[R[13],R[13]],ka=this.textStates[M],Mr=ka.font,Tr=[ka.scale[0]*oo,ka.scale[1]*oo],Cr=void 0;Mr in this.widths_?Cr=this.widths_[Mr]:(Cr={},this.widths_[Mr]=Cr);var uo=Yn(l,ao,so,2),fo=Math.abs(Tr[0])*hs(Mr,E,Cr);if(pu||fo<=uo){var _u=this.textStates[M].textAlign,mu=(uo-fo)*oa[_u],Sr=Qf(l,ao,so,2,E,mu,vu,Math.abs(Tr[0]),hs,Mr,Cr,B?0:this.viewRotation_);t:if(Sr){var Ir=[],Ze=void 0,xn=void 0,En=void 0,Gt=void 0,$t=void 0;if(C)for(Ze=0,xn=Sr.length;Ze<xn;++Ze){$t=Sr[Ze],En=$t[4],Gt=this.createLabel(En,M,"",C),d=$t[2]+(Tr[0]<0?-Ga:Ga),v=Na*Gt.height+(.5-Na)*2*Ga*Tr[1]/Tr[0]-ho;var ae=this.calculateImageOrLabelDimensions_(Gt.width,Gt.height,$t[0],$t[1],Gt.width,Gt.height,d,v,0,0,$t[3],lo,!1,ni,!1,$);if(h&&h.collides(ae.declutterBox))break t;Ir.push([e,t,Gt,ae,1,null,null])}if(T)for(Ze=0,xn=Sr.length;Ze<xn;++Ze){$t=Sr[Ze],En=$t[4],Gt=this.createLabel(En,M,T,""),d=$t[2],v=Na*Gt.height-ho;var ae=this.calculateImageOrLabelDimensions_(Gt.width,Gt.height,$t[0],$t[1],Gt.width,Gt.height,d,v,0,0,$t[3],lo,!1,ni,!1,$);if(h&&h.collides(ae.declutterBox))break t;Ir.push([e,t,Gt,ae,1,null,null])}h&&h.load(Ir.map(Fh));for(var Ba=0,gu=Ir.length;Ba<gu;++Ba)this.replayImageOrLabel_.apply(this,Ir[Ba])}}++u;break;case N.END_GEOMETRY:if(s!==void 0){$=R[1];var co=s($,ot);if(co)return co}++u;break;case N.FILL:F?S++:this.fill_(e),++u;break;case N.MOVE_TO_LINE_TO:for(c=R[1],p=R[2],q=l[c],et=l[c+1],g=q+.5|0,y=et+.5|0,(g!==_||y!==m)&&(e.moveTo(q,et),_=g,m=y),c+=2;c<p;c+=2)q=l[c],et=l[c+1],g=q+.5|0,y=et+.5|0,(c==p-2||g!==_||y!==m)&&(e.lineTo(q,et),_=g,m=y);++u;break;case N.SET_FILL_STYLE:O=R,this.alignFill_=R[2],S&&(this.fill_(e),S=0,P&&(e.stroke(),P=0)),e.fillStyle=R[1],++u;break;case N.SET_STROKE_STYLE:w=R,P&&(e.stroke(),P=0),this.setStrokeStyle_(e,R),++u;break;case N.STROKE:F?P++:e.stroke(),++u;break;default:++u;break}}S&&this.fill_(e),P&&e.stroke()},r.prototype.execute=function(e,t,i,n,a,s){this.viewRotation_=n,this.execute_(e,t,i,this.instructions,a,void 0,void 0,s)},r.prototype.executeHitDetection=function(e,t,i,n,a){return this.viewRotation_=i,this.execute_(e,1,t,this.hitDetectionInstructions,!0,n,a)},r}(),vs=[lt.POLYGON,lt.CIRCLE,lt.LINE_STRING,lt.IMAGE,lt.TEXT,lt.DEFAULT],_s=function(){function r(e,t,i,n,a,s){this.maxExtent_=e,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=bt(),this.createExecutors_(a)}return r.prototype.clip=function(e,t){var i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()},r.prototype.createExecutors_=function(e){for(var t in e){var i=this.executorsByZIndex_[t];i===void 0&&(i={},this.executorsByZIndex_[t]=i);var n=e[t];for(var a in n){var s=n[a];i[a]=new ec(this.resolution_,this.pixelRatio_,this.overlaps_,s)}}},r.prototype.hasExecutors=function(e){for(var t in this.executorsByZIndex_)for(var i=this.executorsByZIndex_[t],n=0,a=e.length;n<a;++n)if(e[n]in i)return!0;return!1},r.prototype.forEachFeatureAtCoordinate=function(e,t,i,n,a,s){n=Math.round(n);var o=n*2+1,h=jt(this.hitDetectionTransform_,n+.5,n+.5,1/t,-1/t,-i,-e[0],-e[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Et(o,o));var u=this.hitDetectionContext_;u.canvas.width!==o||u.canvas.height!==o?(u.canvas.width=o,u.canvas.height=o):l||u.clearRect(0,0,o,o);var f;this.renderBuffer_!==void 0&&(f=Tt(),xi(f,e),Ar(f,t*(this.renderBuffer_+n),f));var c=ic(n),p;function d(M,C){for(var T=u.getImageData(0,0,o,o).data,S=0,P=c.length;S<P;S++)if(T[c[S]]>0){if(!s||p!==lt.IMAGE&&p!==lt.TEXT||s.indexOf(M)!==-1){var O=(c[S]-3)/4,w=n-O%o,j=n-(O/o|0),Y=a(M,C,w*w+j*j);if(Y)return Y}u.clearRect(0,0,o,o);break}}var v=Object.keys(this.executorsByZIndex_).map(Number);v.sort(ge);var _,m,g,y,x;for(_=v.length-1;_>=0;--_){var E=v[_].toString();for(g=this.executorsByZIndex_[E],m=vs.length-1;m>=0;--m)if(p=vs[m],y=g[p],y!==void 0&&(x=y.executeHitDetection(u,h,i,d,f),x))return x}},r.prototype.getClipCoords=function(e){var t=this.maxExtent_;if(!t)return null;var i=t[0],n=t[1],a=t[2],s=t[3],o=[i,n,i,s,a,s,a,n];return Ee(o,0,8,2,e,o),o},r.prototype.isEmpty=function(){return Ke(this.executorsByZIndex_)},r.prototype.execute=function(e,t,i,n,a,s,o){var h=Object.keys(this.executorsByZIndex_).map(Number);h.sort(ge),this.maxExtent_&&(e.save(),this.clip(e,i));var l=s||vs,u,f,c,p,d,v;for(o&&h.reverse(),u=0,f=h.length;u<f;++u){var _=h[u].toString();for(d=this.executorsByZIndex_[_],c=0,p=l.length;c<p;++c){var m=l[c];v=d[m],v!==void 0&&v.execute(e,t,i,n,a,o)}}this.maxExtent_&&e.restore()},r}(),ms={};function ic(r){if(ms[r]!==void 0)return ms[r];for(var e=r*2+1,t=r*r,i=new Array(t+1),n=0;n<=r;++n)for(var a=0;a<=r;++a){var s=n*n+a*a;if(s>t)break;var o=i[s];o||(o=[],i[s]=o),o.push(((r+n)*e+(r+a))*4+3),n>0&&o.push(((r-n)*e+(r+a))*4+3),a>0&&(o.push(((r+n)*e+(r-a))*4+3),n>0&&o.push(((r-n)*e+(r-a))*4+3))}for(var h=[],n=0,l=i.length;n<l;++n)i[n]&&h.push.apply(h,i[n]);return ms[r]=h,h}var pe=.5;function Nh(r,e,t,i,n,a,s){var o=r[0]*pe,h=r[1]*pe,l=Et(o,h);l.imageSmoothingEnabled=!1;for(var u=l.canvas,f=new ra(l,pe,n,null,s),c=t.length,p=Math.floor((256*256*256-1)/c),d={},v=1;v<=c;++v){var _=t[v-1],m=_.getStyleFunction()||i;if(!!i){var g=m(_,a);if(!!g){Array.isArray(g)||(g=[g]);for(var y=v*p,x="#"+("000000"+y.toString(16)).slice(-6),E=0,M=g.length;E<M;++E){var C=g[E],T=C.getGeometryFunction()(_);if(!(!T||!ct(n,T.getExtent()))){var S=C.clone(),P=S.getFill();P&&P.setColor(x);var O=S.getStroke();O&&(O.setColor(x),O.setLineDash(null)),S.setText(void 0);var w=C.getImage();if(w&&w.getOpacity()!==0){var j=w.getImageSize();if(!j)continue;var Y=Et(j[0],j[1],void 0,{alpha:!1}),B=Y.canvas;Y.fillStyle=x,Y.fillRect(0,0,B.width,B.height),S.setImage(new Lh({img:B,imgSize:j,anchor:w.getAnchor(),anchorXUnits:Ge.PIXELS,anchorYUnits:Ge.PIXELS,offset:w.getOrigin(),opacity:1,size:w.getSize(),scale:w.getScale(),rotation:w.getRotation(),rotateWithView:w.getRotateWithView()}))}var U=S.getZIndex()||0,F=d[U];F||(F={},d[U]=F,F[k.POLYGON]=[],F[k.CIRCLE]=[],F[k.LINE_STRING]=[],F[k.POINT]=[]),F[T.getType().replace("Multi","")].push(T,S)}}}}}for(var $=Object.keys(d).map(Number).sort(ge),v=0,q=$.length;v<q;++v){var F=d[$[v]];for(var et in F)for(var ot=F[et],E=0,M=ot.length;E<M;E+=2){f.setStyle(ot[E+1]);for(var R=0,At=e.length;R<At;++R)f.setTransform(e[R]),f.drawGeometry(ot[E])}}return l.getImageData(0,0,u.width,u.height)}function Gh(r,e,t){var i=[];if(t){var n=Math.floor(Math.round(r[0])*pe),a=Math.floor(Math.round(r[1])*pe),s=(A(n,0,t.width-1)+A(a,0,t.height-1)*t.width)*4,o=t.data[s],h=t.data[s+1],l=t.data[s+2],u=l+256*(h+256*o),f=Math.floor((256*256*256-1)/e.length);u&&u%f==0&&i.push(e[u/f-1])}return i}var rc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),nc=function(r){rc(e,r);function e(t){var i=r.call(this)||this;return i.boundHandleImageChange_=i.handleImageChange_.bind(i),i.layer_=t,i.declutterExecutorGroup=null,i}return e.prototype.getFeatures=function(t){return z()},e.prototype.prepareFrame=function(t){return z()},e.prototype.renderFrame=function(t,i){return z()},e.prototype.loadedTileCallback=function(t,i,n){t[i]||(t[i]={}),t[i][n.tileCoord.toString()]=n},e.prototype.createLoadedTileFinder=function(t,i,n){return function(a,s){var o=this.loadedTileCallback.bind(this,n,a);return t.forEachLoadedTile(i,a,s,o)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,i,n,a,s){},e.prototype.getDataAtPixel=function(t,i,n){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var i=t.target;i.getState()===tt.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var i=t.getState();return i!=tt.LOADED&&i!=tt.ERROR&&t.addEventListener(D.CHANGE,this.boundHandleImageChange_),i==tt.IDLE&&(t.load(),i=t.getState()),i==tt.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==te.READY&&t.changed()},e}(gi),ac=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ha=function(r){ac(e,r);function e(t){var i=r.call(this,t)||this;return i.container=null,i.renderedResolution,i.tempTransform=bt(),i.pixelTransform=bt(),i.inversePixelTransform=bt(),i.context=null,i.containerReused=!1,i}return e.prototype.useContainer=function(t,i,n){var a=this.getLayer().getClassName(),s,o;if(t&&t.style.opacity===Ji(n)&&t.className===a){var h=t.firstElementChild;h instanceof HTMLCanvasElement&&(o=h.getContext("2d"))}if(o&&o.canvas.style.transform===i?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){s=document.createElement("div"),s.className=a;var l=s.style;l.position="absolute",l.width="100%",l.height="100%",o=Et();var h=o.canvas;s.appendChild(h),l=h.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=s,this.context=o}},e.prototype.clipUnrotated=function(t,i,n){var a=de(n),s=Ki(n),o=qi(n),h=Zi(n);ht(i.coordinateToPixelTransform,a),ht(i.coordinateToPixelTransform,s),ht(i.coordinateToPixelTransform,o),ht(i.coordinateToPixelTransform,h);var l=this.inversePixelTransform;ht(l,a),ht(l,s),ht(l,o),ht(l,h),t.save(),t.beginPath(),t.moveTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,i,n){var a=this.getLayer();if(a.hasListener(t)){var s=new On(t,this.inversePixelTransform,n,i);a.dispatchEvent(s)}},e.prototype.preRender=function(t,i){this.dispatchRenderEvent_(ue.PRERENDER,t,i)},e.prototype.postRender=function(t,i){this.dispatchRenderEvent_(ue.POSTRENDER,t,i)},e.prototype.getRenderTransform=function(t,i,n,a,s,o,h){var l=s/2,u=o/2,f=a/i,c=-f,p=-t[0]+h,d=-t[1];return jt(this.tempTransform,l,u,f,c,-n,p,d)},e.prototype.getDataAtPixel=function(t,i,n){var a=ht(this.inversePixelTransform,t.slice()),s=this.context,o=this.getLayer(),h=o.getExtent();if(h){var l=ht(i.pixelToCoordinateTransform,t.slice());if(!mt(h,l))return null}var u;try{var f=Math.round(a[0]),c=Math.round(a[1]),p=document.createElement("canvas"),d=p.getContext("2d");p.width=1,p.height=1,d.clearRect(0,0,1,1),d.drawImage(s.canvas,f,c,1,1,0,0,1,1),u=d.getImageData(0,0,1,1).data}catch(v){return v.name==="SecurityError"?new Uint8Array:u}return u[3]===0?null:u},e}(nc);function kh(r,e,t){var i=t!==void 0?r.toFixed(t):""+r,n=i.indexOf(".");return n=n===-1?i.length:n,n>e?i:new Array(1+e-n).join("0")+i}function Bh(r,e){return r[0]+=+e[0],r[1]+=+e[1],r}function gs(r,e,t){var i=le(e+180,360)-180,n=Math.abs(3600*i),a=t||0,s=Math.pow(10,a),o=Math.floor(n/3600),h=Math.floor((n-o*3600)/60),l=n-o*3600-h*60;return l=Math.ceil(l*s)/s,l>=60&&(l=0,h+=1),h>=60&&(h=0,o+=1),o+" "+kh(h,2)+" "+kh(l,2,a)+""+(i==0?"":" "+r.charAt(i<0?1:0))}function la(r,e){for(var t=!0,i=r.length-1;i>=0;--i)if(r[i]!=e[i]){t=!1;break}return t}function Zr(r,e){var t=Math.cos(e),i=Math.sin(e),n=r[0]*t-r[1]*i,a=r[1]*t+r[0]*i;return r[0]=n,r[1]=a,r}function Xh(r,e){return r[0]*=e,r[1]*=e,r}function ua(r,e){if(e.canWrapX()){var t=Z(e.getExtent()),i=sc(r,e,t);i&&(r[0]-=i*t)}return r}function sc(r,e,t){var i=e.getExtent(),n=0;if(e.canWrapX()&&(r[0]<i[0]||r[0]>i[2])){var a=t||Z(i);n=Math.floor((r[0]-i[0])/a)}return n}var gt={ANIMATING:0,INTERACTING:1};var oc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),hc=function(r){oc(e,r);function e(t){var i=r.call(this,t)||this;return i.boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(i),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=Tt(),i.wrappedRenderedExtent_=Tt(),i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i.declutterExecutorGroup=null,i.clipping=!0,i}return e.prototype.useContainer=function(t,i,n){n<1&&(t=null),r.prototype.useContainer.call(this,t,i,n)},e.prototype.renderWorlds=function(t,i,n){var a=i.extent,s=i.viewState,o=s.center,h=s.resolution,l=s.projection,u=s.rotation,f=l.getExtent(),c=this.getLayer().getSource(),p=i.pixelRatio,d=i.viewHints,v=!(d[gt.ANIMATING]||d[gt.INTERACTING]),_=this.context,m=Math.round(i.size[0]*p),g=Math.round(i.size[1]*p),y=c.getWrapX()&&l.canWrapX(),x=y?Z(f):null,E=y?Math.ceil((a[2]-f[2])/x)+1:1,M=y?Math.floor((a[0]-f[0])/x):0;do{var C=this.getRenderTransform(o,h,u,p,m,g,M*x);t.execute(_,1,C,u,v,void 0,n)}while(++M<E)},e.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},e.prototype.renderFrame=function(t,i){var n=t.pixelRatio,a=t.layerStatesArray[t.layerIndex];Uo(this.pixelTransform,1/n,1/n),zi(this.inversePixelTransform,this.pixelTransform);var s=bn(this.pixelTransform);this.useContainer(i,s,a.opacity);var o=this.context,h=o.canvas,l=this.replayGroup_,u=this.declutterExecutorGroup;if((!l||l.isEmpty())&&(!u||u.isEmpty()))return null;var f=Math.round(t.size[0]*n),c=Math.round(t.size[1]*n);h.width!=f||h.height!=c?(h.width=f,h.height=c,h.style.transform!==s&&(h.style.transform=s)):this.containerReused||o.clearRect(0,0,f,c),this.preRender(o,t);var p=t.viewState,d=p.projection,v=!1,_=!0;if(a.extent&&this.clipping){var m=Me(a.extent);_=ct(m,t.extent),v=_&&!wt(m,t.extent),v&&this.clipUnrotated(o,t,m)}_&&this.renderWorlds(l,t),v&&o.restore(),this.postRender(o,t);var g=Ji(a.opacity),y=this.container;return g!==y.style.opacity&&(y.style.opacity=g),this.renderedRotation_!==p.rotation&&(this.renderedRotation_=p.rotation,this.hitDetectionImageData_=null),this.container},e.prototype.getFeatures=function(t){return new Promise(function(i){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var n=[this.context.canvas.width,this.context.canvas.height];ht(this.pixelTransform,n);var a=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,h=this.renderedProjection_,l=this.wrappedRenderedExtent_,u=this.getLayer(),f=[],c=n[0]*pe,p=n[1]*pe;f.push(this.getRenderTransform(a,s,o,pe,c,p,0).slice());var d=u.getSource(),v=h.getExtent();if(d.getWrapX()&&h.canWrapX()&&!wt(v,l)){for(var _=l[0],m=Z(v),g=0,y=void 0;_<v[0];)--g,y=m*g,f.push(this.getRenderTransform(a,s,o,pe,c,p,y).slice()),_+=m;for(g=0,_=l[2];_>v[2];)++g,y=m*g,f.push(this.getRenderTransform(a,s,o,pe,c,p,y).slice()),_-=m}this.hitDetectionImageData_=Nh(n,f,this.renderedFeatures_,u.getStyleFunction(),l,s,o)}i(Gh(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},e.prototype.forEachFeatureAtCoordinate=function(t,i,n,a,s){var o=this;if(!!this.replayGroup_){var h=i.viewState.resolution,l=i.viewState.rotation,u=this.getLayer(),f={},c=function(v,_,m){var g=V(v),y=f[g];if(y){if(y!==!0&&m<y.distanceSq){if(m===0)return f[g]=!0,s.splice(s.lastIndexOf(y),1),a(v,u,_);y.geometry=_,y.distanceSq=m}}else{if(m===0)return f[g]=!0,a(v,u,_);s.push(f[g]={feature:v,layer:u,geometry:_,distanceSq:m,callback:a})}},p,d=[this.replayGroup_];return this.declutterExecutorGroup&&d.push(this.declutterExecutorGroup),d.some(function(v){return p=v.forEachFeatureAtCoordinate(t,h,l,n,c,v===o.declutterExecutorGroup?i.declutterTree.all().map(function(_){return _.value}):null)}),p}},e.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t){var i=this.getLayer(),n=i.getSource();if(!n)return!1;var a=t.viewHints[gt.ANIMATING],s=t.viewHints[gt.INTERACTING],o=i.getUpdateWhileAnimating(),h=i.getUpdateWhileInteracting();if(!this.dirty_&&!o&&a||!h&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var l=t.extent,u=t.viewState,f=u.projection,c=u.resolution,p=t.pixelRatio,d=i.getRevision(),v=i.getRenderBuffer(),_=i.getRenderOrder();_===void 0&&(_=Oh);var m=u.center.slice(),g=Ar(l,v*c),y=g.slice(),x=[g.slice()],E=f.getExtent();if(n.getWrapX()&&f.canWrapX()&&!wt(E,t.extent)){var M=Z(E),C=Math.max(Z(g)/2,M);g[0]=E[0]-C,g[2]=E[2]+C,ua(m,f);var T=Gn(x[0],f);T[0]<E[0]&&T[2]<E[2]?x.push([T[0]+M,T[1],T[2]+M,T[3]]):T[0]>E[0]&&T[2]>E[2]&&x.push([T[0]-M,T[1],T[2]-M,T[3]])}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==d&&this.renderedRenderOrder_==_&&wt(this.wrappedRenderedExtent_,g))return oe(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var S=new ps(na(c,p),g,c,p),P;this.getLayer().getDeclutter()&&(P=new ps(na(c,p),g,c,p));for(var O,w,j,w=0,j=x.length;w<j;++w)n.loadFeatures(x[w],c,f);var Y=aa(c,p),B=function(et){var ot,R=et.getStyleFunction()||i.getStyleFunction();if(R&&(ot=R(et,c)),ot){var At=this.renderFeature(et,Y,ot,S,O,P);this.dirty_=this.dirty_||At}}.bind(this),U=An(g),F=n.getFeaturesInExtent(U);_&&F.sort(_);for(var w=0,j=F.length;w<j;++w)B(F[w]);this.renderedFeatures_=F;var $=S.finish(),q=new _s(g,c,p,n.getOverlaps(),$,i.getRenderBuffer());return P&&(this.declutterExecutorGroup=new _s(g,c,p,n.getOverlaps(),P.finish(),i.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=d,this.renderedRenderOrder_=_,this.renderedExtent_=y,this.wrappedRenderedExtent_=g,this.renderedCenter_=m,this.renderedProjection_=f,this.replayGroup_=q,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,i,n,a,s,o){if(!n)return!1;var h=!1;if(Array.isArray(n))for(var l=0,u=n.length;l<u;++l)h=ds(a,t,n[l],i,this.boundHandleStyleImageChange_,s,o)||h;else h=ds(a,t,n,i,this.boundHandleStyleImageChange_,s,o);return h},e}(ha),lc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Uh=function(r){lc(e,r);function e(t){return r.call(this,t)||this}return e.prototype.createRenderer=function(){return new hc(this)},e}(Ah);var uc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),fa=function(r){uc(e,r);function e(t){var i=r.call(this)||this;i.projection=vt(t.projection),i.attributions_=zh(t.attributions),i.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,i.loading=!1,i.state_=t.state!==void 0?t.state:te.READY,i.wrapX_=t.wrapX!==void 0?t.wrapX:!1,i.viewResolver=null,i.viewRejector=null;var n=i;return i.viewPromise_=new Promise(function(a,s){n.viewResolver=a,n.viewRejector=s}),i}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return z()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getContextOptions=function(){},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=zh(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(yt);function zh(r){return r?Array.isArray(r)?function(e){return r}:typeof r=="function"?r:function(e){return[r]}:null}var or={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};var fc=!1;function cc(r,e,t,i,n,a,s){var o=new XMLHttpRequest;o.open("GET",typeof r=="function"?r(t,i,n):r,!0),e.getType()==or.ARRAY_BUFFER&&(o.responseType="arraybuffer"),o.withCredentials=fc,o.onload=function(h){if(!o.status||o.status>=200&&o.status<300){var l=e.getType(),u=void 0;l==or.JSON||l==or.TEXT?u=o.responseText:l==or.XML?(u=o.responseXML,u||(u=new DOMParser().parseFromString(o.responseText,"application/xml"))):l==or.ARRAY_BUFFER&&(u=o.response),u?a(e.readFeatures(u,{extent:t,featureProjection:n}),e.readProjection(u)):s()}else s()},o.onerror=s,o.send()}function ys(r,e){return function(t,i,n,a,s){var o=this;cc(r,e,t,i,n,function(h,l){o.addFeatures(h),a!==void 0&&a(h)},s||he)}}var Wh=function(){function r(e){this.rbush_=new ia(e),this.items_={}}return r.prototype.insert=function(e,t){var i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(i),this.items_[V(t)]=i},r.prototype.load=function(e,t){for(var i=new Array(t.length),n=0,a=t.length;n<a;n++){var s=e[n],o=t[n],h={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:o};i[n]=h,this.items_[V(o)]=h}this.rbush_.load(i)},r.prototype.remove=function(e){var t=V(e),i=this.items_[t];return delete this.items_[t],this.rbush_.remove(i)!==null},r.prototype.update=function(e,t){var i=this.items_[V(t)],n=[i.minX,i.minY,i.maxX,i.maxY];Zt(n,e)||(this.remove(t),this.insert(e,t))},r.prototype.getAll=function(){var e=this.rbush_.all();return e.map(function(t){return t.value})},r.prototype.getInExtent=function(e){var t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]},i=this.rbush_.search(t);return i.map(function(n){return n.value})},r.prototype.forEach=function(e){return this.forEach_(this.getAll(),e)},r.prototype.forEachInExtent=function(e,t){return this.forEach_(this.getInExtent(e),t)},r.prototype.forEach_=function(e,t){for(var i,n=0,a=e.length;n<a;n++)if(i=t(e[n]),i)return i;return i},r.prototype.isEmpty=function(){return Ke(this.items_)},r.prototype.clear=function(){this.rbush_.clear(),this.items_={}},r.prototype.getExtent=function(e){var t=this.rbush_.toJSON();return Bt(t.minX,t.minY,t.maxX,t.maxY,e)},r.prototype.concat=function(e){this.rbush_.load(e.rbush_.all());for(var t in e.items_)this.items_[t]=e.items_[t]},r}(),Re={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function dc(r,e){return[[-Infinity,-Infinity,Infinity,Infinity]]}var Yh=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),li=function(r){Yh(e,r);function e(t,i,n){var a=r.call(this,t)||this;return a.feature=i,a.features=n,a}return e}(kt),Vh=function(r){Yh(e,r);function e(t){var i=this,n=t||{};i=r.call(this,{attributions:n.attributions,projection:void 0,state:te.READY,wrapX:n.wrapX!==void 0?n.wrapX:!0})||this,i.on,i.once,i.un,i.loader_=he,i.format_=n.format,i.overlaps_=n.overlaps===void 0?!0:n.overlaps,i.url_=n.url,n.loader!==void 0?i.loader_=n.loader:i.url_!==void 0&&(X(i.format_,7),i.loader_=ys(i.url_,i.format_)),i.strategy_=n.strategy!==void 0?n.strategy:dc;var a=n.useSpatialIndex!==void 0?n.useSpatialIndex:!0;i.featuresRtree_=a?new Wh:null,i.loadedExtentsRtree_=new Wh,i.loadingExtentsCount_=0,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null;var s,o;return Array.isArray(n.features)?o=n.features:n.features&&(s=n.features,o=s.getArray()),!a&&s===void 0&&(s=new Ot(o)),o!==void 0&&i.addFeaturesInternal(o),s!==void 0&&i.bindFeaturesCollection_(s),i}return e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var i=V(t);if(!this.addToIndex_(i,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(i,t);var n=t.getGeometry();if(n){var a=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(a,t)}else this.nullGeometryFeatures_[i]=t;this.dispatchEvent(new li(Re.ADDFEATURE,t))},e.prototype.setupChangeEvents_=function(t,i){this.featureChangeKeys_[t]=[H(i,D.CHANGE,this.handleFeatureChange_,this),H(i,je.PROPERTYCHANGE,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,i){var n=!0,a=i.getId();return a!==void 0&&(a.toString()in this.idIndex_?n=!1:this.idIndex_[a.toString()]=i),n&&(X(!(t in this.uidIndex_),30),this.uidIndex_[t]=i),n},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var i=[],n=[],a=[],s=0,o=t.length;s<o;s++){var h=t[s],l=V(h);this.addToIndex_(l,h)&&n.push(h)}for(var s=0,u=n.length;s<u;s++){var h=n[s],l=V(h);this.setupChangeEvents_(l,h);var f=h.getGeometry();if(f){var c=f.getExtent();i.push(c),a.push(h)}else this.nullGeometryFeatures_[l]=h}this.featuresRtree_&&this.featuresRtree_.load(i,a);for(var s=0,p=n.length;s<p;s++)this.dispatchEvent(new li(Re.ADDFEATURE,n[s]))},e.prototype.bindFeaturesCollection_=function(t){var i=!1;this.addEventListener(Re.ADDFEATURE,function(n){i||(i=!0,t.push(n.feature),i=!1)}),this.addEventListener(Re.REMOVEFEATURE,function(n){i||(i=!0,t.remove(n.feature),i=!1)}),t.addEventListener(It.ADD,function(n){i||(i=!0,this.addFeature(n.element),i=!1)}.bind(this)),t.addEventListener(It.REMOVE,function(n){i||(i=!0,this.removeFeature(n.element),i=!1)}.bind(this)),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var i in this.featureChangeKeys_){var n=this.featureChangeKeys_[i];n.forEach(Q)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this));for(var a in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[a])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var s=new li(Re.CLEAR);this.dispatchEvent(s),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,i){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(a){var s=a.getGeometry();if(s.intersectsCoordinate(t))return i(a)})},e.prototype.forEachFeatureInExtent=function(t,i){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,i);this.featuresCollection_&&this.featuresCollection_.forEach(i)},e.prototype.forEachFeatureIntersectingExtent=function(t,i){return this.forEachFeatureInExtent(t,function(n){var a=n.getGeometry();if(a.intersectsExtent(t)){var s=i(n);if(s)return s}})},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ke(this.nullGeometryFeatures_)||ye(t,Mn(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var i=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){i.push(n)}),i},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]},e.prototype.getClosestFeatureToCoordinate=function(t,i){var n=t[0],a=t[1],s=null,o=[NaN,NaN],h=Infinity,l=[-Infinity,-Infinity,Infinity,Infinity],u=i||He;return this.featuresRtree_.forEachInExtent(l,function(f){if(u(f)){var c=f.getGeometry(),p=h;if(h=c.closestPointXY(n,a,o,h),h<p){s=f;var d=Math.sqrt(h);l[0]=n-d,l[1]=a-d,l[2]=n+d,l[3]=a+d}}}),s},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var i=this.idIndex_[t.toString()];return i!==void 0?i:null},e.prototype.getFeatureByUid=function(t){var i=this.uidIndex_[t];return i!==void 0?i:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var i=t.target,n=V(i),a=i.getGeometry();if(!a)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(i),this.nullGeometryFeatures_[n]=i);else{var s=a.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(s,i)):this.featuresRtree_&&this.featuresRtree_.update(s,i)}var o=i.getId();if(o!==void 0){var h=o.toString();this.idIndex_[h]!==i&&(this.removeFromIdIndex_(i),this.idIndex_[h]=i)}else this.removeFromIdIndex_(i),this.uidIndex_[n]=i;this.changed(),this.dispatchEvent(new li(Re.CHANGEFEATURE,i))},e.prototype.hasFeature=function(t){var i=t.getId();return i!==void 0?i in this.idIndex_:V(t)in this.uidIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Ke(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,i,n){for(var a=this.loadedExtentsRtree_,s=this.strategy_(t,i,n),o=function(f,c){var p=s[f],d=a.forEachInExtent(p,function(v){return wt(v.extent,p)});d||(++h.loadingExtentsCount_,h.dispatchEvent(new li(Re.FEATURESLOADSTART)),h.loader_.call(h,p,i,n,function(v){--this.loadingExtentsCount_,this.dispatchEvent(new li(Re.FEATURESLOADEND,void 0,v))}.bind(h),function(){--this.loadingExtentsCount_,this.dispatchEvent(new li(Re.FEATURESLOADERROR))}.bind(h)),a.insert(p,{extent:p.slice()}))},h=this,l=0,u=s.length;l<u;++l)o(l);this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0},e.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),r.prototype.refresh.call(this)},e.prototype.removeLoadedExtent=function(t){var i=this.loadedExtentsRtree_,n;i.forEachInExtent(t,function(a){if(Zt(a.extent,t))return n=a,!0}),n&&i.remove(n)},e.prototype.removeFeature=function(t){var i=V(t);i in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[i]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var i=V(t);this.featureChangeKeys_[i].forEach(Q),delete this.featureChangeKeys_[i];var n=t.getId();n!==void 0&&delete this.idIndex_[n.toString()],delete this.uidIndex_[i],this.dispatchEvent(new li(Re.REMOVEFEATURE,t))},e.prototype.removeFromIdIndex_=function(t){var i=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],i=!0;break}return i},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.setUrl=function(t){X(this.format_,7),this.url_=t,this.setLoader(ys(t,this.format_))},e}(fa);function qr(r){var e=r.inversePixelTransform[0],t=r.frameState,i=Bo(r.inversePixelTransform.slice(),t.coordinateToPixelTransform),n=aa(t.viewState.resolution,e),a;return new ra(r.context,e,t.extent,i,t.viewState.rotation,n,a)}var G={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Zh=42,hr=256;function xs(r){return Math.pow(r,3)}function ui(r){return 1-xs(1-r)}function qh(r){return 3*r*r-2*r*r*r}function Kh(r){return r}function Hh(r,e,t,i,n,a,s){for(var o,h,l,u,f,c,p,d=n[a+1],v=[],_=0,m=t.length;_<m;++_){var g=t[_];for(u=r[g-i],c=r[g-i+1],o=e;o<g;o+=i)f=r[o],p=r[o+1],(d<=c&&p<=d||c<=d&&d<=p)&&(l=(d-c)/(p-c)*(f-u)+u,v.push(l)),u=f,c=p}var y=NaN,x=-Infinity;for(v.sort(ge),u=v[0],o=1,h=v.length;o<h;++o){f=v[o];var E=Math.abs(f-u);E>x&&(l=(u+f)/2,kn(r,e,t,i,l,d)&&(y=l,x=E)),u=f}return isNaN(y)&&(y=n[a]),s?(s.push(y,d,x),s):[y,d,x]}function $h(r,e,t,i){for(var n=0,a=r[t-i],s=r[t-i+1];e<t;e+=i){var o=r[e],h=r[e+1];n+=s*o-a*h,a=o,s=h}return n/2}function pc(r,e,t,i){for(var n=0,a=0,s=t.length;a<s;++a){var o=t[a];n+=$h(r,e,o,i),e=o}return n}var vc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jh=function(r){vc(e,r);function e(t,i){var n=r.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,i!==void 0&&!Array.isArray(t[0])?n.setFlatCoordinates(i,t):n.setCoordinates(t,i),n}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,i,n,a){return a<Ei(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,i,n,a))},e.prototype.getArea=function(){return $h(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Ce(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=Gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,J.XY)},e.prototype.getType=function(){return k.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Nr(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Fe);function _c(r,e,t,i){for(;e<t-i;){for(var n=0;n<i;++n){var a=r[e+n];r[e+n]=r[t-i+n],r[t-i+n]=a}e+=i,t-=i}}function Qh(r,e,t,i){for(var n=0,a=r[t-i],s=r[t-i+1];e<t;e+=i){var o=r[e],h=r[e+1];n+=(o-a)*(h+s),a=o,s=h}return n===0?void 0:n>0}function mc(r,e,t,i,n){for(var a=n!==void 0?n:!1,s=0,o=t.length;s<o;++s){var h=t[s],l=Qh(r,e,h,i);if(s===0){if(a&&l||!a&&!l)return!1}else if(a&&!l||!a&&l)return!1;e=h}return!0}function tl(r,e,t,i,n){for(var a=n!==void 0?n:!1,s=0,o=t.length;s<o;++s){var h=t[s],l=Qh(r,e,h,i),u=s===0?a&&l||!a&&!l:a&&!l||!a&&l;u&&_c(r,e,h,i),e=h}return e}var gc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Es=function(r){gc(e,r);function e(t,i,n){var a=r.call(this)||this;return a.ends_=[],a.flatInteriorPointRevision_=-1,a.flatInteriorPoint_=null,a.maxDelta_=-1,a.maxDeltaRevision_=-1,a.orientedRevision_=-1,a.orientedFlatCoordinates_=null,i!==void 0&&n?(a.setFlatCoordinates(i,t),a.ends_=n):a.setCoordinates(t,i),a}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?ye(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,n,a){return a<Ei(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Bn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Xn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,i,n,a))},e.prototype.containsXY=function(t,i){return kn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,i)},e.prototype.getArea=function(){return pc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var i;return t!==void 0?(i=this.getOrientedFlatCoordinates().slice(),tl(i,0,this.ends_,this.stride,t)):i=this.flatCoordinates,ei(i,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=xt(this.getExtent());this.flatInteriorPoint_=Hh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Se(this.getFlatInteriorPoint(),J.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Jh(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,i=this.flatCoordinates,n=this.ends_,a=[],s=0,o=0,h=n.length;o<h;++o){var l=n[o],u=new Jh(i.slice(s,l),t);a.push(u),s=l}return a},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;mc(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=tl(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=sh(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,J.XY,n)},e.prototype.getType=function(){return k.POLYGON},e.prototype.intersectsExtent=function(t){return rh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=Un(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()},e}(Fe);function Ms(r){var e=r[0],t=r[1],i=r[2],n=r[3],a=[e,t,e,n,i,n,i,t,e,t];return new Es(a,J.XY,[a.length])}var we={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function el(r,e,t){return function(i,n,a,s,o){if(i){var h=e?0:a[0]*n,l=e?0:a[1]*n,u=o?o[0]:0,f=o?o[1]:0,c=r[0]+h/2+u,p=r[2]-h/2+u,d=r[1]+l/2+f,v=r[3]-l/2+f;c>p&&(c=(p+c)/2,p=c),d>v&&(d=(v+d)/2,v=d);var _=A(i[0],c,p),m=A(i[1],d,v),g=30*n;return s&&t&&(_+=-g*Math.log(1+Math.max(0,c-i[0])/g)+g*Math.log(1+Math.max(0,i[0]-p)/g),m+=-g*Math.log(1+Math.max(0,d-i[1])/g)+g*Math.log(1+Math.max(0,i[1]-v)/g)),[_,m]}else return}}function yc(r){return r}function Ts(r,e,t,i){var n=Z(e)/t[0],a=ft(e)/t[1];return i?Math.min(r,Math.max(n,a)):Math.min(r,Math.min(n,a))}function Cs(r,e,t){var i=Math.min(r,e),n=50;return i*=Math.log(1+n*Math.max(0,r/e-1))/n+1,t&&(i=Math.max(i,t),i/=Math.log(1+n*Math.max(0,t/r-1))/n+1),A(i,t/2,e*2)}function xc(r,e,t,i){return function(n,a,s,o){if(n!==void 0){var h=r[0],l=r[r.length-1],u=t?Ts(h,t,s,i):h;if(o){var f=e!==void 0?e:!0;return f?Cs(n,u,l):A(n,l,u)}var c=Math.min(u,n),p=Math.floor(Or(r,c,a));return r[p]>u&&p<r.length-1?r[p+1]:r[p]}else return}}function Ec(r,e,t,i,n,a){return function(s,o,h,l){if(s!==void 0){var u=n?Ts(e,n,h,a):e,f=t!==void 0?t:0;if(l){var c=i!==void 0?i:!0;return c?Cs(s,u,f):A(s,f,u)}var p=1e-9,d=Math.ceil(Math.log(e/u)/Math.log(r)-p),v=-o*(.5-p)+.5,_=Math.min(u,s),m=Math.floor(Math.log(e/_)/Math.log(r)+v),g=Math.max(d,m),y=e/Math.pow(r,g);return A(y,f,u)}else return}}function il(r,e,t,i,n){return function(a,s,o,h){if(a!==void 0){var l=i?Ts(r,i,o,n):r,u=t!==void 0?t:!0;return!u||!h?A(a,e,l):Cs(a,l,e)}else return}}function ca(r){if(r!==void 0)return 0}function rl(r){if(r!==void 0)return r}function Mc(r){var e=2*Math.PI/r;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function Tc(r){var e=r||Ni(5);return function(t,i){if(i)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var Cc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ss=0,ve=function(r){Cc(e,r);function e(t){var i=r.call(this)||this;i.on,i.once,i.un;var n=nt({},t);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=Pn(n.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.targetResolution_,i.targetRotation_,i.nextCenter_=null,i.nextResolution_,i.nextRotation_,i.cancelAnchor_=void 0,n.center&&(n.center=ce(n.center,i.projection_)),n.extent&&(n.extent=Me(n.extent,i.projection_)),i.applyOptions_(n),i}return e.prototype.applyOptions_=function(t){var i={},n=Ic(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;var a=Sc(t),s=n.constraint,o=Oc(t);this.constraints_={center:a,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom),this.setProperties(i),this.options_=t},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var i=this.padding_;this.padding_=t;var n=this.getCenter();if(n){var a=t||[0,0,0,0];i=i||[0,0,0,0];var s=this.getResolution(),o=s/2*(a[3]-i[3]+i[1]-a[1]),h=s/2*(a[0]-i[0]+i[2]-a[2]);this.setCenterInternal([n[0]+o,n[1]-h])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var i=nt({},this.options_);return i.resolution!==void 0?i.resolution=this.getResolution():i.zoom=this.getZoom(),i.center=this.getCenterInternal(),i.rotation=this.getRotation(),nt({},i,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var i=new Array(arguments.length),n=0;n<i.length;++n){var a=arguments[n];a.center&&(a=nt({},a),a.center=ce(a.center,this.getProjection())),a.anchor&&(a=nt({},a),a.anchor=ce(a.anchor,this.getProjection())),i[n]=a}this.animateInternal.apply(this,i)},e.prototype.animateInternal=function(t){var i=arguments.length,n;i>1&&typeof arguments[i-1]=="function"&&(n=arguments[i-1],--i);for(var a=0;a<i&&!this.isDef();++a){var s=arguments[a];s.center&&this.setCenterInternal(s.center),s.zoom!==void 0?this.setZoom(s.zoom):s.resolution&&this.setResolution(s.resolution),s.rotation!==void 0&&this.setRotation(s.rotation)}if(a===i){n&&da(n,!0);return}for(var o=Date.now(),h=this.targetCenter_.slice(),l=this.targetResolution_,u=this.targetRotation_,f=[];a<i;++a){var c=arguments[a],p={start:o,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||qh,callback:n};if(c.center&&(p.sourceCenter=h,p.targetCenter=c.center.slice(),h=p.targetCenter),c.zoom!==void 0?(p.sourceResolution=l,p.targetResolution=this.getResolutionForZoom(c.zoom),l=p.targetResolution):c.resolution&&(p.sourceResolution=l,p.targetResolution=c.resolution,l=p.targetResolution),c.rotation!==void 0){p.sourceRotation=u;var d=le(c.rotation-u+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=u+d,u=p.targetRotation}Rc(p)?p.complete=!0:o+=p.duration,f.push(p)}this.animations_.push(f),this.setHint(gt.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[gt.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[gt.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(gt.ANIMATING,-this.hints_[gt.ANIMATING]);for(var t,i=0,n=this.animations_.length;i<n;++i){var a=this.animations_[i];if(a[0].callback&&da(a[0].callback,!1),!t)for(var s=0,o=a.length;s<o;++s){var h=a[s];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),i=!1,n=this.animations_.length-1;n>=0;--n){for(var a=this.animations_[n],s=!0,o=0,h=a.length;o<h;++o){var l=a[o];if(!l.complete){var u=t-l.start,f=l.duration>0?u/l.duration:1;f>=1?(l.complete=!0,f=1):s=!1;var c=l.easing(f);if(l.sourceCenter){var p=l.sourceCenter[0],d=l.sourceCenter[1],v=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;var m=p+c*(v-p),g=d+c*(_-d);this.targetCenter_=[m,g]}if(l.sourceResolution&&l.targetResolution){var y=c===1?l.targetResolution:l.sourceResolution+c*(l.targetResolution-l.sourceResolution);if(l.anchor){var x=this.getViewportSize_(this.getRotation()),E=this.constraints_.resolution(y,0,x,!0);this.targetCenter_=this.calculateCenterZoom(E,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=y,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){var M=c===1?le(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+c*(l.targetRotation-l.sourceRotation);if(l.anchor){var C=this.constraints_.rotation(M,!0);this.targetCenter_=this.calculateCenterRotate(C,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=M}if(this.applyTargetState_(!0),i=!0,!l.complete)break}}if(s){this.animations_[n]=null,this.setHint(gt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var T=a[0].callback;T&&da(T,!0)}}this.animations_=this.animations_.filter(Boolean),i&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,i){var n,a=this.getCenterInternal();return a!==void 0&&(n=[a[0]-i[0],a[1]-i[1]],Zr(n,t-this.getRotation()),Bh(n,i)),n},e.prototype.calculateCenterZoom=function(t,i){var n,a=this.getCenterInternal(),s=this.getResolution();if(a!==void 0&&s!==void 0){var o=i[0]-t*(i[0]-a[0])/s,h=i[1]-t*(i[1]-a[1])/s;n=[o,h]}return n},e.prototype.getViewportSize_=function(t){var i=this.viewportSize_;if(t){var n=i[0],a=i[1];return[Math.abs(n*Math.cos(t))+Math.abs(a*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(a*Math.cos(t))]}else return i},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&Pr(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(we.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var i=this.calculateExtentInternal(t);return An(i,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var i=t||this.getViewportSizeMinusPadding_(),n=this.getCenterInternal();X(n,1);var a=this.getResolution();X(a!==void 0,2);var s=this.getRotation();return X(s!==void 0,3),br(n,a,s,i)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(we.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,i){return this.getResolutionForExtentInternal(Me(t,this.getProjection()),i)},e.prototype.getResolutionForExtentInternal=function(t,i){var n=i||this.getViewportSizeMinusPadding_(),a=Z(t)/n[0],s=ft(t)/n[1];return Math.max(a,s)},e.prototype.getResolutionForValueFunction=function(t){var i=t||2,n=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,s=Math.log(n/a)/Math.log(i);return function(o){var h=n/Math.pow(i,o*s);return h}},e.prototype.getRotation=function(){return this.get(we.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var i=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),a=this.minResolution_,s=Math.log(n/a)/i;return function(o){var h=Math.log(n/o)/i/s;return h}},e.prototype.getViewportSizeMinusPadding_=function(t){var i=this.getViewportSize_(t),n=this.padding_;return n&&(i=[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]),i},e.prototype.getState=function(){var t=this.getProjection(),i=this.getResolution(),n=this.getRotation(),a=this.getCenterInternal(),s=this.padding_;if(s){var o=this.getViewportSizeMinusPadding_();a=Is(a,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],i,n)}return{center:a.slice(0),projection:t!==void 0?t:null,resolution:i,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,i=this.getResolution();return i!==void 0&&(t=this.getZoomForResolution(i)),t},e.prototype.getZoomForResolution=function(t){var i=this.minZoom_||0,n,a;if(this.resolutions_){var s=Or(this.resolutions_,t,1);i=s,n=this.resolutions_[s],s==this.resolutions_.length-1?a=2:a=n/this.resolutions_[s+1]}else n=this.maxResolution_,a=this.zoomFactor_;return i+Math.log(n/t)/Math.log(a)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var i=A(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[i]/this.resolutions_[i+1];return this.resolutions_[i]/Math.pow(n,A(t-i,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,i){var n;if(X(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){X(!Te(t),25);var a=Me(t,this.getProjection());n=Ms(a)}else if(t.getType()===k.CIRCLE){var a=Me(t.getExtent(),this.getProjection());n=Ms(a),n.rotate(this.getRotation(),xt(a))}else{var s=Fo();s?n=t.clone().transform(s,this.getProjection()):n=t}this.fitInternal(n,i)},e.prototype.rotatedExtentForGeometry=function(t){for(var i=this.getRotation(),n=Math.cos(i),a=Math.sin(-i),s=t.getFlatCoordinates(),o=t.getStride(),h=Infinity,l=Infinity,u=-Infinity,f=-Infinity,c=0,p=s.length;c<p;c+=o){var d=s[c]*n-s[c+1]*a,v=s[c]*a+s[c+1]*n;h=Math.min(h,d),l=Math.min(l,v),u=Math.max(u,d),f=Math.max(f,v)}return[h,l,u,f]},e.prototype.fitInternal=function(t,i){var n=i||{},a=n.size;a||(a=this.getViewportSizeMinusPadding_());var s=n.padding!==void 0?n.padding:[0,0,0,0],o=n.nearest!==void 0?n.nearest:!1,h;n.minResolution!==void 0?h=n.minResolution:n.maxZoom!==void 0?h=this.getResolutionForZoom(n.maxZoom):h=0;var l=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(l,[a[0]-s[1]-s[3],a[1]-s[0]-s[2]]);u=isNaN(u)?h:Math.max(u,h),u=this.getConstrainedResolution(u,o?0:1);var f=this.getRotation(),c=Math.sin(f),p=Math.cos(f),d=xt(l);d[0]+=(s[1]-s[3])/2*u,d[1]+=(s[0]-s[2])/2*u;var v=d[0]*p-d[1]*c,_=d[1]*p+d[0]*c,m=this.getConstrainedCenter([v,_],u),g=n.callback?n.callback:he;n.duration!==void 0?this.animateInternal({resolution:u,center:m,duration:n.duration,easing:n.easing},g):(this.targetResolution_=u,this.targetCenter_=m,this.applyTargetState_(!1,!0),da(g,!0))},e.prototype.centerOn=function(t,i,n){this.centerOnInternal(ce(t,this.getProjection()),i,n)},e.prototype.centerOnInternal=function(t,i,n){this.setCenterInternal(Is(t,i,n,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,i,n,a){var s,o=this.padding_;if(o&&t){var h=this.getViewportSizeMinusPadding_(-n),l=Is(t,a,[h[0]/2+o[3],h[1]/2+o[0]],i,n);s=[t[0]-l[0],t[1]-l[1]]}return s},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var i=Pr(this.targetCenter_,this.getProjection());this.setCenter([i[0]+t[0],i[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var i=this.targetCenter_;this.setCenterInternal([i[0]+t[0],i[1]+t[1]])},e.prototype.adjustResolution=function(t,i){var n=i&&ce(i,this.getProjection());this.adjustResolutionInternal(t,n)},e.prototype.adjustResolutionInternal=function(t,i){var n=this.getAnimating()||this.getInteracting(),a=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,a,n);i&&(this.targetCenter_=this.calculateCenterZoom(s,i)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,i){this.adjustResolution(Math.pow(this.zoomFactor_,-t),i)},e.prototype.adjustRotation=function(t,i){i&&(i=ce(i,this.getProjection())),this.adjustRotationInternal(t,i)},e.prototype.adjustRotationInternal=function(t,i){var n=this.getAnimating()||this.getInteracting(),a=this.constraints_.rotation(this.targetRotation_+t,n);i&&(this.targetCenter_=this.calculateCenterRotate(a,i)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(ce(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,i){return this.hints_[t]+=i,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,i){var n=this.getAnimating()||this.getInteracting()||i,a=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(a),o=this.constraints_.resolution(this.targetResolution_,0,s,n),h=this.constraints_.center(this.targetCenter_,o,s,n,this.calculateCenterShift(this.targetCenter_,o,a,s));this.get(we.ROTATION)!==a&&this.set(we.ROTATION,a),this.get(we.RESOLUTION)!==o&&this.set(we.RESOLUTION,o),(!this.get(we.CENTER)||!la(this.get(we.CENTER),h))&&this.set(we.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,i,n){var a=t!==void 0?t:200,s=i||0,o=this.constraints_.rotation(this.targetRotation_),h=this.getViewportSize_(o),l=this.constraints_.resolution(this.targetResolution_,s,h),u=this.constraints_.center(this.targetCenter_,l,h,!1,this.calculateCenterShift(this.targetCenter_,l,o,h));if(a===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=o,this.targetCenter_=u,this.applyTargetState_();return}var f=n||(a===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==o||!this.getCenterInternal()||!la(this.getCenterInternal(),u))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:u,resolution:l,duration:a,easing:ui,anchor:f}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(gt.INTERACTING,1)},e.prototype.endInteraction=function(t,i,n){var a=n&&ce(n,this.getProjection());this.endInteractionInternal(t,i,a)},e.prototype.endInteractionInternal=function(t,i,n){this.setHint(gt.INTERACTING,-1),this.resolveConstraints(t,i,n)},e.prototype.getConstrainedCenter=function(t,i){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,i||this.getResolution(),n)},e.prototype.getConstrainedZoom=function(t,i){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,i))},e.prototype.getConstrainedResolution=function(t,i){var n=i||0,a=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,n,a)},e}(yt);function da(r,e){setTimeout(function(){r(e)},0)}function Sc(r){if(r.extent!==void 0){var e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return el(r.extent,r.constrainOnlyCenter,e)}var t=Pn(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){var i=t.getExtent().slice();return i[0]=-Infinity,i[2]=Infinity,el(i,!1,!1)}return yc}function Ic(r){var e,t,i,n=28,a=2,s=r.minZoom!==void 0?r.minZoom:Ss,o=r.maxZoom!==void 0?r.maxZoom:n,h=r.zoomFactor!==void 0?r.zoomFactor:a,l=r.multiWorld!==void 0?r.multiWorld:!1,u=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,f=r.showFullExtent!==void 0?r.showFullExtent:!1,c=Pn(r.projection,"EPSG:3857"),p=c.getExtent(),d=r.constrainOnlyCenter,v=r.extent;if(!l&&!v&&c.isGlobal()&&(d=!1,v=p),r.resolutions!==void 0){var _=r.resolutions;t=_[s],i=_[o]!==void 0?_[o]:_[_.length-1],r.constrainResolution?e=xc(_,u,!d&&v,f):e=il(t,i,u,!d&&v,f)}else{var m=p?Math.max(Z(p),ft(p)):360*ee[Rt.DEGREES]/c.getMetersPerUnit(),g=m/hr/Math.pow(a,Ss),y=g/Math.pow(a,n-Ss);t=r.maxResolution,t!==void 0?s=0:t=g/Math.pow(h,s),i=r.minResolution,i===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?i=t/Math.pow(h,o):i=g/Math.pow(h,o):i=y),o=s+Math.floor(Math.log(t/i)/Math.log(h)),i=t/Math.pow(h,o-s),r.constrainResolution?e=Ec(h,t,i,u,!d&&v,f):e=il(t,i,u,!d&&v,f)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:s,zoomFactor:h}}function Oc(r){var e=r.enableRotation!==void 0?r.enableRotation:!0;if(e){var t=r.constrainRotation;return t===void 0||t===!0?Tc():t===!1?rl:typeof t=="number"?Mc(t):rl}else return ca}function Rc(r){return!(r.sourceCenter&&r.targetCenter&&!la(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function Is(r,e,t,i,n){var a=Math.cos(-n),s=Math.sin(-n),o=r[0]*a-r[1]*s,h=r[1]*a+r[0]*s;o+=(e[0]/2-t[0])*i,h+=(t[1]-e[1]/2)*i,s=-s;var l=o*a-h*s,u=h*a+o*s;return[l,u]}var wc=function(){function r(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return r.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},r.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},r.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var i=t-3;i>0&&this.points_[i+2]>e;)i-=3;var n=this.points_[t+2]-this.points_[i+2];if(n<1e3/60)return!1;var a=this.points_[t]-this.points_[i],s=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(s,a),this.initialVelocity_=Math.sqrt(a*a+s*s)/n,this.initialVelocity_>this.minVelocity_},r.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},r.prototype.getAngle=function(){return this.angle_},r}(),Lc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ac=function(r){Lc(e,r);function e(t){var i=r.call(this)||this;return i.map_=t,i}return e.prototype.dispatchRenderEvent=function(t,i){z()},e.prototype.calculateMatrices2D=function(t){var i=t.viewState,n=t.coordinateToPixelTransform,a=t.pixelToCoordinateTransform;jt(n,t.size[0]/2,t.size[1]/2,1/i.resolution,-1/i.resolution,-i.rotation,-i.center[0],-i.center[1]),zi(a,n)},e.prototype.forEachFeatureAtCoordinate=function(t,i,n,a,s,o,h,l){var u,f=i.viewState;function c(B,U,F,$){return s.call(o,U,B?F:null,$)}var p=f.projection,d=ua(t.slice(),p),v=[[0,0]];if(p.canWrapX()&&a){var _=p.getExtent(),m=Z(_);v.push([-m,0],[m,0])}for(var g=i.layerStatesArray,y=g.length,x=[],E=[],M=0;M<v.length;M++)for(var C=y-1;C>=0;--C){var T=g[C],S=T.layer;if(S.hasRenderer()&&wr(T,f)&&h.call(l,S)){var P=S.getRenderer(),O=S.getSource();if(P&&O){var w=O.getWrapX()?d:t,j=c.bind(null,T.managed);E[0]=w[0]+v[M][0],E[1]=w[1]+v[M][1],u=P.forEachFeatureAtCoordinate(E,i,n,j,x)}if(u)return u}}if(x.length!==0){var Y=1/x.length;return x.forEach(function(B,U){return B.distanceSq+=U*Y}),x.sort(function(B,U){return B.distanceSq-U.distanceSq}),x.some(function(B){return u=B.callback(B.feature,B.layer,B.geometry)}),u}},e.prototype.forEachLayerAtPixel=function(t,i,n,a,s){return z()},e.prototype.hasFeatureAtCoordinate=function(t,i,n,a,s,o){var h=this.forEachFeatureAtCoordinate(t,i,n,a,He,this,s,o);return h!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){z()},e.prototype.scheduleExpireIconCache=function(t){ar.canExpireCache()&&t.postRenderFunctions.push(Pc)},e}(Tn);function Pc(r,e){ar.expire()}var bc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),jc=function(r){bc(e,r);function e(t){var i=r.call(this,t)||this;i.fontChangeListenerKey_=H(Oe,je.PROPERTYCHANGE,t.redrawText.bind(t)),i.element_=document.createElement("div");var n=i.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",i.element_.className=Br+" ol-layers";var a=t.getViewport();return a.insertBefore(i.element_,a.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return e.prototype.dispatchRenderEvent=function(t,i){var n=this.getMap();if(n.hasListener(t)){var a=new On(t,void 0,i);n.dispatchEvent(a)}},e.prototype.disposeInternal=function(){Q(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),r.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(ue.PRECOMPOSE,t);var i=t.layerStatesArray.sort(function(c,p){return c.zIndex-p.zIndex}),n=t.viewState;this.children_.length=0;for(var a=[],s=null,o=0,h=i.length;o<h;++o){var l=i[o];if(t.layerIndex=o,!(!wr(l,n)||l.sourceState!=te.READY&&l.sourceState!=te.UNDEFINED)){var u=l.layer,f=u.render(t,s);!f||(f!==s&&(this.children_.push(f),s=f),"getDeclutter"in u&&a.push(u))}}for(var o=a.length-1;o>=0;--o)a[o].renderDeclutter(t);fh(this.element_,this.children_),this.dispatchRenderEvent(ue.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,i,n,a,s){for(var o=i.viewState,h=i.layerStatesArray,l=h.length,u=l-1;u>=0;--u){var f=h[u],c=f.layer;if(c.hasRenderer()&&wr(f,o)&&s(c)){var p=c.getRenderer(),d=p.getDataAtPixel(t,i,n);if(d){var v=a(c,d);if(v)return v}}}},e}(Ac),Fc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Os={LAYERS:"layers"},Dc=function(r){Fc(e,r);function e(t){var i=this,n=t||{},a=nt({},n);delete a.layers;var s=n.layers;return i=r.call(this,a)||this,i.on,i.once,i.un,i.layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(Os.LAYERS,i.handleLayersChanged_),s?Array.isArray(s)?s=new Ot(s.slice(),{unique:!0}):X(typeof s.getArray=="function",43):s=new Ot(void 0,{unique:!0}),i.setLayers(s),i}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Q),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(H(t,It.ADD,this.handleLayersAdd_,this),H(t,It.REMOVE,this.handleLayersRemove_,this));for(var i in this.listenerKeys_)this.listenerKeys_[i].forEach(Q);qe(this.listenerKeys_);for(var n=t.getArray(),a=0,s=n.length;a<s;a++){var o=n[a];this.listenerKeys_[V(o)]=[H(o,je.PROPERTYCHANGE,this.handleLayerChange_,this),H(o,D.CHANGE,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var i=t.element;this.listenerKeys_[V(i)]=[H(i,je.PROPERTYCHANGE,this.handleLayerChange_,this),H(i,D.CHANGE,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var i=t.element,n=V(i);this.listenerKeys_[n].forEach(Q),delete this.listenerKeys_[n],this.changed()},e.prototype.getLayers=function(){return this.get(Os.LAYERS)},e.prototype.setLayers=function(t){this.set(Os.LAYERS,t)},e.prototype.getLayersArray=function(t){var i=t!==void 0?t:[];return this.getLayers().forEach(function(n){n.getLayersArray(i)}),i},e.prototype.getLayerStatesArray=function(t){var i=t!==void 0?t:[],n=i.length;this.getLayers().forEach(function(u){u.getLayerStatesArray(i)});var a=this.getLayerState(),s=a.zIndex;!t&&a.zIndex===void 0&&(s=0);for(var o=n,h=i.length;o<h;o++){var l=i[o];l.opacity*=a.opacity,l.visible=l.visible&&a.visible,l.maxResolution=Math.min(l.maxResolution,a.maxResolution),l.minResolution=Math.max(l.minResolution,a.minResolution),l.minZoom=Math.max(l.minZoom,a.minZoom),l.maxZoom=Math.min(l.maxZoom,a.maxZoom),a.extent!==void 0&&(l.extent!==void 0?l.extent=qt(l.extent,a.extent):l.extent=a.extent),l.zIndex===void 0&&(l.zIndex=s)}return i},e.prototype.getSourceState=function(){return te.READY},e}(Ua),Nc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pa=function(r){Nc(e,r);function e(t,i,n){var a=r.call(this,t)||this;return a.map=i,a.frameState=n!==void 0?n:null,a}return e}(kt),Gc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),fi=function(r){Gc(e,r);function e(t,i,n,a,s){var o=r.call(this,t,i,s)||this;return o.originalEvent=n,o.pixel_=null,o.coordinate_=null,o.dragging=a!==void 0?a:!1,o}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){r.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){r.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(pa),st={SINGLECLICK:"singleclick",CLICK:D.CLICK,DBLCLICK:D.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Rs={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},kc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bc=function(r){kc(e,r);function e(t,i){var n=r.call(this,t)||this;n.map_=t,n.clickTimeoutId_,n.emulateClicks_=!1,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=i===void 0?1:i,n.down_=null;var a=n.map_.getViewport();return n.activePointers_=0,n.trackedTouches_={},n.element_=a,n.pointerdownListenerKey_=H(a,Rs.POINTERDOWN,n.handlePointerDown_,n),n.originalPointerMoveEvent_,n.relayedListenerKey_=H(a,Rs.POINTERMOVE,n.relayEvent_,n),n.boundHandleTouchMove_=n.handleTouchMove_.bind(n),n.element_.addEventListener(D.TOUCHMOVE,n.boundHandleTouchMove_,Ha?{passive:!1}:!1),n}return e.prototype.emulateClick_=function(t){var i=new fi(st.CLICK,this.map_,t);this.dispatchEvent(i),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,i=new fi(st.DBLCLICK,this.map_,t),this.dispatchEvent(i)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var n=new fi(st.SINGLECLICK,this.map_,t);this.dispatchEvent(n)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var i=t;i.type==st.POINTERUP||i.type==st.POINTERCANCEL?delete this.trackedTouches_[i.pointerId]:i.type==st.POINTERDOWN&&(this.trackedTouches_[i.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var i=new fi(st.POINTERUP,this.map_,t);this.dispatchEvent(i),this.emulateClicks_&&!i.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(Q),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(t);var i=new fi(st.POINTERDOWN,this.map_,t);this.dispatchEvent(i),this.down_={};for(var n in t){var a=t[n];this.down_[n]=typeof a=="function"?he:a}if(this.dragListenerKeys_.length===0){var s=this.map_.getOwnerDocument();this.dragListenerKeys_.push(H(s,st.POINTERMOVE,this.handlePointerMove_,this),H(s,st.POINTERUP,this.handlePointerUp_,this),H(this.element_,st.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==s&&this.dragListenerKeys_.push(H(this.element_.getRootNode(),st.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var i=new fi(st.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(i)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var i=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new fi(t.type,this.map_,t,i))},e.prototype.handleTouchMove_=function(t){var i=this.originalPointerMoveEvent_;(!i||i.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Q(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(D.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Q(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Q),this.dragListenerKeys_.length=0,this.element_=null,r.prototype.disposeInternal.call(this)},e}(Jt),va={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"},Lt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},_a=Infinity,Xc=function(){function r(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return r.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,qe(this.queuedElements_)},r.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},r.prototype.enqueue=function(e){X(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=_a?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},r.prototype.getCount=function(){return this.elements_.length},r.prototype.getLeftChildIndex_=function(e){return e*2+1},r.prototype.getRightChildIndex_=function(e){return e*2+2},r.prototype.getParentIndex_=function(e){return e-1>>1},r.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},r.prototype.isEmpty=function(){return this.elements_.length===0},r.prototype.isKeyQueued=function(e){return e in this.queuedElements_},r.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},r.prototype.siftUp_=function(e){for(var t=this.elements_,i=this.priorities_,n=t.length,a=t[e],s=i[e],o=e;e<n>>1;){var h=this.getLeftChildIndex_(e),l=this.getRightChildIndex_(e),u=l<n&&i[l]<i[h]?l:h;t[e]=t[u],i[e]=i[u],e=u}t[e]=a,i[e]=s,this.siftDown_(o,e)},r.prototype.siftDown_=function(e,t){for(var i=this.elements_,n=this.priorities_,a=i[t],s=n[t];t>e;){var o=this.getParentIndex_(t);if(n[o]>s)i[t]=i[o],n[t]=n[o],t=o;else break}i[t]=a,n[t]=s},r.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,i=this.priorities_,n=0,a=t.length,s,o,h;for(o=0;o<a;++o)s=t[o],h=e(s),h==_a?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=h,t[n++]=s);t.length=n,i.length=n,this.heapify_()},r}(),Uc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),zc=function(r){Uc(e,r);function e(t,i){var n=r.call(this,function(a){return t.apply(null,a)},function(a){return a[0].getKey()})||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=i,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return e.prototype.enqueue=function(t){var i=r.prototype.enqueue.call(this,t);if(i){var n=t[0];n.addEventListener(D.CHANGE,this.boundHandleTileChange_)}return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var i=t.target,n=i.getState();if(n===G.LOADED||n===G.ERROR||n===G.EMPTY){i.removeEventListener(D.CHANGE,this.boundHandleTileChange_);var a=i.getKey();a in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[a],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,i){for(var n=0,a,s,o;this.tilesLoading_<t&&n<i&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),a=s.getState(),a===G.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++n,s.load())},e}(Xc);function Wc(r,e,t,i,n){if(!r||!(t in r.wantedTiles)||!r.wantedTiles[t][e.getKey()])return _a;var a=r.viewState.center,s=i[0]-a[0],o=i[1]-a[1];return 65536*Math.log(n)+Math.sqrt(s*s+o*o)/n}var Yc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Zc=function(r){Yc(e,r);function e(t){var i=r.call(this)||this;i.on,i.once,i.un;var n=Vc(t);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(i),i.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,i.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Ka,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(i),i.coordinateToPixelTransform_=bt(),i.pixelToCoordinateTransform_=bt(),i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.style.pointerEvents="none",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.style.pointerEvents="none",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=null,i.moveTolerance_=t.moveTolerance,i.keyboardEventTarget_=n.keyboardEventTarget,i.keyHandlerKeys_=null,i.controls=n.controls||new Ot,i.interactions=n.interactions||new Ot,i.overlays_=n.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new zc(i.getTilePriority.bind(i),i.handleTileChange_.bind(i)),i.addChangeListener(Lt.LAYERGROUP,i.handleLayerGroupChanged_),i.addChangeListener(Lt.VIEW,i.handleViewChanged_),i.addChangeListener(Lt.SIZE,i.handleSizeChanged_),i.addChangeListener(Lt.TARGET,i.handleTargetChanged_),i.setProperties(n.values);var a=i;return t.view&&!(t.view instanceof ve)&&t.view.then(function(s){a.setView(new ve(s))}),i.controls.addEventListener(It.ADD,function(s){s.element.setMap(this)}.bind(i)),i.controls.addEventListener(It.REMOVE,function(s){s.element.setMap(null)}.bind(i)),i.interactions.addEventListener(It.ADD,function(s){s.element.setMap(this)}.bind(i)),i.interactions.addEventListener(It.REMOVE,function(s){s.element.setMap(null)}.bind(i)),i.overlays_.addEventListener(It.ADD,function(s){this.addOverlayInternal_(s.element)}.bind(i)),i.overlays_.addEventListener(It.REMOVE,function(s){var o=s.element,h=o.getId();h!==void 0&&delete this.overlayIdIndex_[h.toString()],s.element.setMap(null)}.bind(i)),i.controls.forEach(function(s){s.setMap(this)}.bind(i)),i.interactions.forEach(function(s){s.setMap(this)}.bind(i)),i.overlays_.forEach(i.addOverlayInternal_.bind(i)),i}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var i=this.getLayerGroup().getLayers();i.push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var i=t.getId();i!==void 0&&(this.overlayIdIndex_[i.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.setTarget(null),r.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,i,n){if(!!this.frameState_){var a=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:He,h=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(a,this.frameState_,s,h,i,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,i){var n=[];return this.forEachFeatureAtPixel(t,function(a){n.push(a)},i),n},e.prototype.forEachLayerAtPixel=function(t,i,n){if(!!this.frameState_){var a=n||{},s=a.hitTolerance!==void 0?a.hitTolerance:0,o=a.layerFilter||He;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,s,i,o)}},e.prototype.hasFeatureAtPixel=function(t,i){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};var a=i.layerFilter!==void 0?i.layerFilter:He,s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,o,a,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var i=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-i.left,n.clientY-i.top]},e.prototype.getTarget=function(){return this.get(Lt.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return Pr(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var i=this.frameState_;return i?ht(i.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var i=this.overlayIdIndex_[t.toString()];return i!==void 0?i:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Lt.LAYERGROUP)},e.prototype.setLayers=function(t){var i=this.getLayerGroup();if(t instanceof Ot){i.setLayers(t);return}var n=i.getLayers();n.clear(),n.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoading=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,n=t.length;i<n;++i){var a=t[i].layer,s=a.getSource();if(s&&s.loading)return!0}return!1},e.prototype.getPixelFromCoordinate=function(t){var i=ce(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(i)},e.prototype.getPixelFromCoordinateInternal=function(t){var i=this.frameState_;return i?ht(i.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Lt.SIZE)},e.prototype.getView=function(){return this.get(Lt.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,i,n,a){return Wc(this.frameState_,t,i,n,a)},e.prototype.handleBrowserEvent=function(t,i){var n=i||t.type,a=new fi(n,this,t);this.handleMapBrowserEvent(a)},e.prototype.handleMapBrowserEvent=function(t){if(!!this.frameState_){var i=t.originalEvent,n=i.type;if(n===Rs.POINTERDOWN||n===D.WHEEL||n===D.KEYDOWN){var a=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():a,o=i.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===a?a.documentElement:s).contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var h=this.getInteractions().getArray().slice(),l=h.length-1;l>=0;l--){var u=h[l];if(!(u.getMap()!==this||!u.getActive()||!this.getTargetElement())){var f=u.handleEvent(t);if(!f||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,i=this.tileQueue_;if(!i.isEmpty()){var n=this.maxTilesLoading_,a=n;if(t){var s=t.viewHints;if(s[gt.ANIMATING]||s[gt.INTERACTING]){var o=Date.now()-t.time>8;n=o?0:8,a=o?0:2}}i.getTilesLoading()<n&&(i.reprioritize(),i.loadMoreTiles(n,a))}t&&this.hasListener(ue.RENDERCOMPLETE)&&!t.animate&&!this.tileQueue_.getTilesLoading()&&!this.getLoading()&&this.renderer_.dispatchRenderEvent(ue.RENDERCOMPLETE,t);for(var h=this.postRenderFunctions_,l=0,u=h.length;l<u;++l)h[l](this,t);h.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(var i=0,n=this.keyHandlerKeys_.length;i<n;++i)Q(this.keyHandlerKeys_[i]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(D.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(D.WHEEL,this.boundHandleBrowserEvent_),this.handleResize_!==void 0&&(removeEventListener(D.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Kn(this.viewport_)}if(!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new Bc(this,this.moveTolerance_);for(var a in st)this.mapBrowserEventHandler_.addEventListener(st[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(D.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(D.WHEEL,this.boundHandleBrowserEvent_,Ha?{passive:!1}:!1);var s=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[H(s,D.KEYDOWN,this.handleBrowserEvent,this),H(s,D.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(D.RESIZE,this.handleResize_,!1))}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Q(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Q(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=H(t,je.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=H(t,D.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Q),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[H(t,je.PROPERTYCHANGE,this.render,this),H(t,D.CHANGE,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),i=0,n=t.length;i<n;++i){var a=t[i].layer;a.hasRenderer()&&a.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var i=this.getLayerGroup().getLayers();return i.remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var i=this,n=this.getSize(),a=this.getView(),s=this.frameState_,o=null;if(n!==void 0&&es(n)&&a&&a.isDef()){var h=a.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=a.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:br(l.center,l.resolution,l.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:l,viewHints:h,wantedTiles:{}},l.nextCenter&&l.nextResolution){var u=isNaN(l.nextRotation)?l.rotation:l.nextRotation;o.nextExtent=br(l.nextCenter,l.nextResolution,u,n)}}if(this.frameState_=o,this.renderer_.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),s){var f=!this.previousExtent_||!Te(this.previousExtent_)&&!Zt(o.extent,this.previousExtent_);f&&(this.dispatchEvent(new pa(va.MOVESTART,this,s)),this.previousExtent_=Vi(this.previousExtent_))}var c=this.previousExtent_&&!o.viewHints[gt.ANIMATING]&&!o.viewHints[gt.INTERACTING]&&!Zt(o.extent,this.previousExtent_);c&&(this.dispatchEvent(new pa(va.MOVEEND,this,o)),jn(o.extent,this.previousExtent_))}this.dispatchEvent(new pa(va.POSTRENDER,this,o)),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){i.postRenderTimeoutHandle_=void 0,i.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){this.set(Lt.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(Lt.SIZE,t)},e.prototype.setTarget=function(t){this.set(Lt.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof ve){this.set(Lt.VIEW,t);return}this.set(Lt.VIEW,new ve);var i=this;t.then(function(n){i.setView(new ve(n))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),i=void 0;if(t){var n=getComputedStyle(t),a=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),s=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(a)&&!isNaN(s)&&(i=[a,s],!es(i)&&!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(i),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var i=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(i=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(i)}},e}(yt);function Vc(r){var e=null;r.keyboardEventTarget!==void 0&&(e=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);var t={},i=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Dc({layers:r.layers});t[Lt.LAYERGROUP]=i,t[Lt.TARGET]=r.target,t[Lt.VIEW]=r.view instanceof ve?r.view:new ve;var n;r.controls!==void 0&&(Array.isArray(r.controls)?n=new Ot(r.controls.slice()):(X(typeof r.controls.getArray=="function",47),n=r.controls));var a;r.interactions!==void 0&&(Array.isArray(r.interactions)?a=new Ot(r.interactions.slice()):(X(typeof r.interactions.getArray=="function",48),a=r.interactions));var s;return r.overlays!==void 0?Array.isArray(r.overlays)?s=new Ot(r.overlays.slice()):(X(typeof r.overlays.getArray=="function",49),s=r.overlays):s=new Ot,{controls:n,interactions:a,keyboardEventTarget:e,overlays:s,values:t}}var qc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ws=function(r){qc(e,r);function e(t){var i=r.call(this)||this,n=t.element;return n&&!t.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),i.element=n||null,i.target_=null,i.map_=null,i.listenerKeys=[],t.render&&(i.render=t.render),t.target&&i.setTarget(t.target),i}return e.prototype.disposeInternal=function(){Kn(this.element),r.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Kn(this.element);for(var i=0,n=this.listenerKeys.length;i<n;++i)Q(this.listenerKeys[i]);if(this.listenerKeys.length=0,this.map_=t,this.map_){var a=this.target_?this.target_:t.getOverlayContainerStopEvent();a.appendChild(this.element),this.render!==he&&this.listenerKeys.push(H(t,va.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(yt),Kc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hc=function(r){Kc(e,r);function e(t){var i=this,n=t||{};i=r.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this,i.ulElement_=document.createElement("ul"),i.collapsed_=n.collapsed!==void 0?n.collapsed:!0,i.userCollapsed_=i.collapsed_,i.overrideCollapsible_=n.collapsible!==void 0,i.collapsible_=n.collapsible!==void 0?n.collapsible:!0,i.collapsible_||(i.collapsed_=!1);var a=n.className!==void 0?n.className:"ol-attribution",s=n.tipLabel!==void 0?n.tipLabel:"Attributions",o=n.expandClassName!==void 0?n.expandClassName:a+"-expand",h=n.collapseLabel!==void 0?n.collapseLabel:"",l=n.collapseClassName!==void 0?n.collapseClassName:a+"-collpase";typeof h=="string"?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=h,i.collapseLabel_.className=l):i.collapseLabel_=h;var u=n.label!==void 0?n.label:"i";typeof u=="string"?(i.label_=document.createElement("span"),i.label_.textContent=u,i.label_.className=o):i.label_=u;var f=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_;i.toggleButton_=document.createElement("button"),i.toggleButton_.setAttribute("type","button"),i.toggleButton_.setAttribute("aria-expanded",String(!i.collapsed_)),i.toggleButton_.title=s,i.toggleButton_.appendChild(f),i.toggleButton_.addEventListener(D.CLICK,i.handleClick_.bind(i),!1);var c=a+" "+Br+" "+Hn+(i.collapsed_&&i.collapsible_?" "+ns:"")+(i.collapsible_?"":" ol-uncollapsible"),p=i.element;return p.className=c,p.appendChild(i.toggleButton_),p.appendChild(i.ulElement_),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return e.prototype.collectSourceAttributions_=function(t){for(var i={},n=[],a=!0,s=t.layerStatesArray,o=0,h=s.length;o<h;++o){var l=s[o];if(!!wr(l,t.viewState)){var u=l.layer.getSource();if(!!u){var f=u.getAttributions();if(!!f){var c=f(t);if(!!c)if(a=a&&u.getAttributionsCollapsible()!==!1,Array.isArray(c))for(var p=0,d=c.length;p<d;++p)c[p]in i||(n.push(c[p]),i[c[p]]=!0);else c in i||(n.push(c),i[c]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(a),n},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var i=this.collectSourceAttributions_(t),n=i.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!oe(i,this.renderedAttributions_)){uh(this.ulElement_);for(var a=0,s=i.length;a<s;++a){var o=document.createElement("li");o.innerHTML=i[a],this.ulElement_.appendChild(o)}this.renderedAttributions_=i}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(ns),this.collapsed_?rs(this.collapseLabel_,this.label_):rs(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(ws),$c=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Jc=function(r){$c(e,r);function e(t){var i=this,n=t||{};i=r.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var a=n.className!==void 0?n.className:"ol-rotate",s=n.label!==void 0?n.label:"",o=n.compassClassName!==void 0?n.compassClassName:"ol-compass";i.label_=null,typeof s=="string"?(i.label_=document.createElement("span"),i.label_.className=o,i.label_.textContent=s):(i.label_=s,i.label_.classList.add(o));var h=n.tipLabel?n.tipLabel:"Reset rotation",l=document.createElement("button");l.className=a+"-reset",l.setAttribute("type","button"),l.title=h,l.appendChild(i.label_),l.addEventListener(D.CLICK,i.handleClick_.bind(i),!1);var u=a+" "+Br+" "+Hn,f=i.element;return f.className=u,f.appendChild(l),i.callResetNorth_=n.resetNorth?n.resetNorth:void 0,i.duration_=n.duration!==void 0?n.duration:250,i.autoHide_=n.autoHide!==void 0?n.autoHide:!0,i.rotation_=void 0,i.autoHide_&&i.element.classList.add(kr),i}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),i=t.getView();if(!!i){var n=i.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!=0?i.animate({rotation:0,duration:this.duration_,easing:ui}):i.setRotation(0))}},e.prototype.render=function(t){var i=t.frameState;if(!!i){var n=i.viewState.rotation;if(n!=this.rotation_){var a="rotate("+n+"rad)";if(this.autoHide_){var s=this.element.classList.contains(kr);!s&&n===0?this.element.classList.add(kr):s&&n!==0&&this.element.classList.remove(kr)}this.label_.style.transform=a}this.rotation_=n}},e}(ws),Qc=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),td=function(r){Qc(e,r);function e(t){var i=this,n=t||{};i=r.call(this,{element:document.createElement("div"),target:n.target})||this;var a=n.className!==void 0?n.className:"ol-zoom",s=n.delta!==void 0?n.delta:1,o=n.zoomInClassName!==void 0?n.zoomInClassName:a+"-in",h=n.zoomOutClassName!==void 0?n.zoomOutClassName:a+"-out",l=n.zoomInLabel!==void 0?n.zoomInLabel:"+",u=n.zoomOutLabel!==void 0?n.zoomOutLabel:"",f=n.zoomInTipLabel!==void 0?n.zoomInTipLabel:"Zoom in",c=n.zoomOutTipLabel!==void 0?n.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=o,p.setAttribute("type","button"),p.title=f,p.appendChild(typeof l=="string"?document.createTextNode(l):l),p.addEventListener(D.CLICK,i.handleClick_.bind(i,s),!1);var d=document.createElement("button");d.className=h,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof u=="string"?document.createTextNode(u):u),d.addEventListener(D.CLICK,i.handleClick_.bind(i,-s),!1);var v=a+" "+Br+" "+Hn,_=i.element;return _.className=v,_.appendChild(p),_.appendChild(d),i.duration_=n.duration!==void 0?n.duration:250,i}return e.prototype.handleClick_=function(t,i){i.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var i=this.getMap(),n=i.getView();if(!!n){var a=n.getZoom();if(a!==void 0){var s=n.getConstrainedZoom(a+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:ui})):n.setZoom(s)}}},e}(ws);function ed(r){var e=r||{},t=new Ot,i=e.zoom!==void 0?e.zoom:!0;i&&t.push(new td(e.zoomOptions));var n=e.rotate!==void 0?e.rotate:!0;n&&t.push(new Jc(e.rotateOptions));var a=e.attribution!==void 0?e.attribution:!0;return a&&t.push(new Hc(e.attributionOptions)),t}var nl={ACTIVE:"active"},id=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Kr=function(r){id(e,r);function e(t){var i=r.call(this)||this;return i.on,i.once,i.un,t&&t.handleEvent&&(i.handleEvent=t.handleEvent),i.map_=null,i.setActive(!0),i}return e.prototype.getActive=function(){return this.get(nl.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(nl.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(yt);function rd(r,e,t){var i=r.getCenterInternal();if(i){var n=[i[0]+e[0],i[1]+e[1]];r.animateInternal({duration:t!==void 0?t:250,easing:Kh,center:r.getConstrainedCenter(n)})}}function Ls(r,e,t,i){var n=r.getZoom();if(n!==void 0){var a=r.getConstrainedZoom(n+e),s=r.getResolutionForZoom(a);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:s,anchor:t,duration:i!==void 0?i:250,easing:ui})}}var nd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ad=function(r){nd(e,r);function e(t){var i=r.call(this)||this,n=t||{};return i.delta_=n.delta?n.delta:1,i.duration_=n.duration!==void 0?n.duration:250,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==st.DBLCLICK){var n=t.originalEvent,a=t.map,s=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_,h=a.getView();Ls(h,o,s,this.duration_),n.preventDefault(),i=!0}return!i},e}(Kr),sd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Hr=function(r){sd(e,r);function e(t){var i=this,n=t||{};return i=r.call(this,n)||this,n.handleDownEvent&&(i.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(i.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(i.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(i.handleUpEvent=n.handleUpEvent),n.stopDown&&(i.stopDown=n.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var i=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==st.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==st.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==st.POINTERDOWN){var a=this.handleDownEvent(t);this.handlingDownUpSequence=a,i=this.stopDown(a)}else t.type==st.POINTERMOVE&&this.handleMoveEvent(t);return!i},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(od(t)){var i=t.originalEvent,n=i.pointerId.toString();t.type==st.POINTERUP?delete this.trackedPointers_[n]:t.type==st.POINTERDOWN?this.trackedPointers_[n]=i:n in this.trackedPointers_&&(this.trackedPointers_[n]=i),this.targetPointers=Mn(this.trackedPointers_)}},e}(Kr);function Ps(r){for(var e=r.length,t=0,i=0,n=0;n<e;n++)t+=r[n].clientX,i+=r[n].clientY;return[t/e,i/e]}function od(r){var e=r.type;return e===st.POINTERDOWN||e===st.POINTERDRAG||e===st.POINTERUP}function As(r){var e=arguments;return function(t){for(var i=!0,n=0,a=e.length;n<a&&(i=i&&e[n](t),!!i);++n);return i}}var hd=function(r){var e=r.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ld=function(r){return r.target.getTargetElement().contains(document.activeElement)},al=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?ld(r):!0},ud=He,sl=function(r){var e=r.originalEvent;return e.button==0&&!(No&&Go&&e.ctrlKey)},ol=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},fd=function(r){var e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},hl=function(r){var e=r.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"},bs=function(r){var e=r.originalEvent;return X(e!==void 0,56),e.pointerType=="mouse"},cd=function(r){var e=r.originalEvent;return X(e!==void 0,56),e.isPrimary&&e.button===0},dd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),pd=function(r){dd(e,r);function e(t){var i=r.call(this,{stopDown:Rr})||this,n=t||{};i.kinetic_=n.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1;var a=n.condition?n.condition:As(ol,cd);return i.condition_=n.onFocusOnly?As(al,a):a,i.noKinetic_=!1,i}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var i=this.targetPointers,n=Ps(i);if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var a=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],s=t.map,o=s.getView();Xh(a,o.getResolution()),Zr(a,o.getRotation()),o.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var i=t.map,n=i.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var a=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=n.getCenterInternal(),h=i.getPixelFromCoordinateInternal(o),l=i.getCoordinateFromPixelInternal([h[0]-a*Math.cos(s),h[1]-a*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:ui})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var i=t.map,n=i.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(Hr),vd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_d=function(r){vd(e,r);function e(t){var i=this,n=t||{};return i=r.call(this,{stopDown:Rr})||this,i.condition_=n.condition?n.condition:hd,i.lastAngle_=void 0,i.duration_=n.duration!==void 0?n.duration:250,i}return e.prototype.handleDragEvent=function(t){if(!!bs(t)){var i=t.map,n=i.getView();if(n.getConstraints().rotation!==ca){var a=i.getSize(),s=t.pixel,o=Math.atan2(a[1]/2-s[1],s[0]-a[0]/2);if(this.lastAngle_!==void 0){var h=o-this.lastAngle_;n.adjustRotationInternal(-h)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!bs(t))return!0;var i=t.map,n=i.getView();return n.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!bs(t))return!1;if(sl(t)&&this.condition_(t)){var i=t.map;return i.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(Hr),md=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gd=function(r){md(e,r);function e(t){var i=r.call(this)||this;return i.geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.style.pointerEvents="auto",i.element_.className="ol-box "+t,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,i=this.endPixel_,n="px",a=this.element_.style;a.left=Math.min(t[0],i[0])+n,a.top=Math.min(t[1],i[1])+n,a.width=Math.abs(i[0]-t[0])+n,a.height=Math.abs(i[1]-t[1])+n},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var i=this.element_.style;i.left="inherit",i.top="inherit",i.width="inherit",i.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,i){this.startPixel_=t,this.endPixel_=i,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,i=this.endPixel_,n=[t,[t[0],i[1]],i,[i[0],t[1]]],a=n.map(this.map_.getCoordinateFromPixelInternal,this.map_);a[4]=a[0].slice(),this.geometry_?this.geometry_.setCoordinates([a]):this.geometry_=new Es([a])},e.prototype.getGeometry=function(){return this.geometry_},e}(Tn),ll=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),ma={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},js=function(r){ll(e,r);function e(t,i,n){var a=r.call(this,t)||this;return a.coordinate=i,a.mapBrowserEvent=n,a}return e}(kt),yd=function(r){ll(e,r);function e(t){var i=r.call(this)||this;i.on,i.once,i.un;var n=t||{};return i.box_=new gd(n.className||"ol-dragbox"),i.minArea_=n.minArea!==void 0?n.minArea:64,n.onBoxEnd&&(i.onBoxEnd=n.onBoxEnd),i.startPixel_=null,i.condition_=n.condition?n.condition:sl,i.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:i.defaultBoxEndCondition,i}return e.prototype.defaultBoxEndCondition=function(t,i,n){var a=n[0]-i[0],s=n[1]-i[1];return a*a+s*s>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new js(ma.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var i=this.boxEndCondition_(t,this.startPixel_,t.pixel);return i&&this.onBoxEnd(t),this.dispatchEvent(new js(i?ma.BOXEND:ma.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new js(ma.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(Hr),xd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ed=function(r){xd(e,r);function e(t){var i=this,n=t||{},a=n.condition?n.condition:fd;return i=r.call(this,{condition:a,className:n.className||"ol-dragzoom",minArea:n.minArea})||this,i.duration_=n.duration!==void 0?n.duration:200,i.out_=n.out!==void 0?n.out:!1,i}return e.prototype.onBoxEnd=function(t){var i=this.getMap(),n=i.getView(),a=this.getGeometry();if(this.out_){var s=n.rotatedExtentForGeometry(a),o=n.getResolutionForExtentInternal(s),h=n.getResolution()/o;a=a.clone(),a.scale(h*h)}n.fitInternal(a,{duration:this.duration_,easing:ui})},e}(yd),Ii={LEFT:37,UP:38,RIGHT:39,DOWN:40},Md=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Td=function(r){Md(e,r);function e(t){var i=r.call(this)||this,n=t||{};return i.defaultCondition_=function(a){return ol(a)&&hl(a)},i.condition_=n.condition!==void 0?n.condition:i.defaultCondition_,i.duration_=n.duration!==void 0?n.duration:100,i.pixelDelta_=n.pixelDelta!==void 0?n.pixelDelta:128,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==D.KEYDOWN){var n=t.originalEvent,a=n.keyCode;if(this.condition_(t)&&(a==Ii.DOWN||a==Ii.LEFT||a==Ii.RIGHT||a==Ii.UP)){var s=t.map,o=s.getView(),h=o.getResolution()*this.pixelDelta_,l=0,u=0;a==Ii.DOWN?u=-h:a==Ii.LEFT?l=-h:a==Ii.RIGHT?l=h:u=h;var f=[l,u];Zr(f,o.getRotation()),rd(o,f,this.duration_),n.preventDefault(),i=!0}}return!i},e}(Kr),Cd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Sd=function(r){Cd(e,r);function e(t){var i=r.call(this)||this,n=t||{};return i.condition_=n.condition?n.condition:hl,i.delta_=n.delta?n.delta:1,i.duration_=n.duration!==void 0?n.duration:100,i}return e.prototype.handleEvent=function(t){var i=!1;if(t.type==D.KEYDOWN||t.type==D.KEYPRESS){var n=t.originalEvent,a=n.charCode;if(this.condition_(t)&&(a=="+".charCodeAt(0)||a=="-".charCodeAt(0))){var s=t.map,o=a=="+".charCodeAt(0)?this.delta_:-this.delta_,h=s.getView();Ls(h,o,void 0,this.duration_),n.preventDefault(),i=!0}}return!i},e}(Kr),Id=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Fs={TRACKPAD:"trackpad",WHEEL:"wheel"},Od=function(r){Id(e,r);function e(t){var i=this,n=t||{};i=r.call(this,n)||this,i.totalDelta_=0,i.lastDelta_=0,i.maxDelta_=n.maxDelta!==void 0?n.maxDelta:1,i.duration_=n.duration!==void 0?n.duration:250,i.timeout_=n.timeout!==void 0?n.timeout:80,i.useAnchor_=n.useAnchor!==void 0?n.useAnchor:!0,i.constrainResolution_=n.constrainResolution!==void 0?n.constrainResolution:!1;var a=n.condition?n.condition:ud;return i.condition_=n.onFocusOnly?As(al,a):a,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.deltaPerZoom_=300,i}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap().getView();t.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var i=t.type;if(i!==D.WHEEL)return!0;var n=t.map,a=t.originalEvent;a.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var s;if(t.type==D.WHEEL&&(s=a.deltaY,Do&&a.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=Ka),a.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;var o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?Fs.TRACKPAD:Fs.WHEEL);var h=n.getView();if(this.mode_===Fs.TRACKPAD&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;var l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1},e.prototype.handleWheelZoom_=function(t){var i=t.getView();i.getAnimating()&&i.cancelAnimations();var n=-A(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(i.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Ls(i,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Kr),Rd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),wd=function(r){Rd(e,r);function e(t){var i=this,n=t||{},a=n;return a.stopDown||(a.stopDown=Rr),i=r.call(this,a)||this,i.anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=n.threshold!==void 0?n.threshold:.3,i.duration_=n.duration!==void 0?n.duration:250,i}return e.prototype.handleDragEvent=function(t){var i=0,n=this.targetPointers[0],a=this.targetPointers[1],s=Math.atan2(a.clientY-n.clientY,a.clientX-n.clientX);if(this.lastAngle_!==void 0){var o=s-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),i=o}this.lastAngle_=s;var h=t.map,l=h.getView();if(l.getConstraints().rotation!==ca){var u=h.getViewport().getBoundingClientRect(),f=Ps(this.targetPointers);f[0]-=u.left,f[1]-=u.top,this.anchor_=h.getCoordinateFromPixelInternal(f),this.rotating_&&(h.render(),l.adjustRotationInternal(i,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var i=t.map,n=i.getView();return n.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}else return!1},e}(Hr),Ld=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Pd=function(r){Ld(e,r);function e(t){var i=this,n=t||{},a=n;return a.stopDown||(a.stopDown=Rr),i=r.call(this,a)||this,i.anchor_=null,i.duration_=n.duration!==void 0?n.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return e.prototype.handleDragEvent=function(t){var i=1,n=this.targetPointers[0],a=this.targetPointers[1],s=n.clientX-a.clientX,o=n.clientY-a.clientY,h=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(i=this.lastDistance_/h),this.lastDistance_=h;var l=t.map,u=l.getView();i!=1&&(this.lastScaleDelta_=i);var f=l.getViewport().getBoundingClientRect(),c=Ps(this.targetPointers);c[0]-=f.left,c[1]-=f.top,this.anchor_=l.getCoordinateFromPixelInternal(c),l.render(),u.adjustResolutionInternal(i,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var i=t.map,n=i.getView(),a=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,a),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var i=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||i.getView().beginInteraction(),!0}else return!1},e}(Hr);function Ad(r){var e=r||{},t=new Ot,i=new wc(-.005,.05,100),n=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;n&&t.push(new _d);var a=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;a&&t.push(new ad({delta:e.zoomDelta,duration:e.zoomDuration}));var s=e.dragPan!==void 0?e.dragPan:!0;s&&t.push(new pd({onFocusOnly:e.onFocusOnly,kinetic:i}));var o=e.pinchRotate!==void 0?e.pinchRotate:!0;o&&t.push(new wd);var h=e.pinchZoom!==void 0?e.pinchZoom:!0;h&&t.push(new Pd({duration:e.zoomDuration}));var l=e.keyboard!==void 0?e.keyboard:!0;l&&(t.push(new Td),t.push(new Sd({delta:e.zoomDelta,duration:e.zoomDuration})));var u=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;u&&t.push(new Od({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var f=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return f&&t.push(new Ed({duration:e.zoomDuration})),t}var bd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ds=function(r){bd(e,r);function e(t){var i=this;return t=nt({},t),t.controls||(t.controls=ed()),t.interactions||(t.interactions=Ad({onFocusOnly:!0})),i=r.call(this,t)||this,i}return e.prototype.createRenderer=function(){return new jc(this)},e}(Zc);function ul(r,e,t){for(var i=[],n=r(0),a=r(1),s=e(n),o=e(a),h=[a,n],l=[o,s],u=[1,0],f={},c=1e5,p,d,v,_,m,g;--c>0&&u.length>0;)v=u.pop(),n=h.pop(),s=l.pop(),g=v.toString(),g in f||(i.push(s[0],s[1]),f[g]=!0),_=u.pop(),a=h.pop(),o=l.pop(),m=(v+_)/2,p=r(m),d=e(p),Sn(d[0],d[1],s[0],s[1],o[0],o[1])<t?(i.push(o[0],o[1]),g=_.toString(),f[g]=!0):(u.push(_,m,m,v),l.push(o,d,d,s),h.push(a,p,p,n));return i}function jd(r,e,t,i,n){var a=vt("EPSG:4326");return ul(function(s){return[r,e+(t-e)*s]},fe(a,i),n)}function Fd(r,e,t,i,n){var a=vt("EPSG:4326");return ul(function(s){return[e+(t-e)*s,r]},fe(a,i),n)}var Dd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Nd=new Ie({color:"rgba(0,0,0,0.2)"}),Gd=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],fl=function(r){Dd(e,r);function e(t){var i=this,n=t||{},a=nt({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},n);return delete a.maxLines,delete a.strokeStyle,delete a.targetSize,delete a.showLabels,delete a.lonLabelFormatter,delete a.latLabelFormatter,delete a.lonLabelPosition,delete a.latLabelPosition,delete a.lonLabelStyle,delete a.latLabelStyle,delete a.intervals,i=r.call(this,a)||this,i.projection_=null,i.maxLat_=Infinity,i.maxLon_=Infinity,i.minLat_=-Infinity,i.minLon_=-Infinity,i.maxX_=Infinity,i.maxY_=Infinity,i.minX_=-Infinity,i.minY_=-Infinity,i.targetSize_=n.targetSize!==void 0?n.targetSize:100,i.maxLines_=n.maxLines!==void 0?n.maxLines:100,i.meridians_=[],i.parallels_=[],i.strokeStyle_=n.strokeStyle!==void 0?n.strokeStyle:Nd,i.fromLonLatTransform_=void 0,i.toLonLatTransform_=void 0,i.projectionCenterLonLat_=null,i.bottomLeft_=null,i.bottomRight_=null,i.topLeft_=null,i.topRight_=null,i.meridiansLabels_=null,i.parallelsLabels_=null,n.showLabels&&(i.lonLabelFormatter_=n.lonLabelFormatter==null?gs.bind(i,"EW"):n.lonLabelFormatter,i.latLabelFormatter_=n.latLabelFormatter==null?gs.bind(i,"NS"):n.latLabelFormatter,i.lonLabelPosition_=n.lonLabelPosition==null?0:n.lonLabelPosition,i.latLabelPosition_=n.latLabelPosition==null?1:n.latLabelPosition,i.lonLabelStyleBase_=new Ne({text:n.lonLabelStyle!==void 0?n.lonLabelStyle.clone():new ir({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new xe({color:"rgba(0,0,0,1)"}),stroke:new Ie({color:"rgba(255,255,255,1)",width:3})})}),i.lonLabelStyle_=function(s){var o=s.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(o),this.lonLabelStyleBase_}.bind(i),i.latLabelStyleBase_=new Ne({text:n.latLabelStyle!==void 0?n.latLabelStyle.clone():new ir({font:"12px Calibri,sans-serif",textAlign:"right",fill:new xe({color:"rgba(0,0,0,1)"}),stroke:new Ie({color:"rgba(255,255,255,1)",width:3})})}),i.latLabelStyle_=function(s){var o=s.get("graticule_label");return this.latLabelStyleBase_.getText().setText(o),this.latLabelStyleBase_}.bind(i),i.meridiansLabels_=[],i.parallelsLabels_=[],i.addEventListener(ue.POSTRENDER,i.drawLabels_.bind(i))),i.intervals_=n.intervals!==void 0?n.intervals:Gd,i.setSource(new Vh({loader:i.loaderFunction.bind(i),strategy:i.strategyFunction.bind(i),features:new Ot,overlaps:!1,useSpatialIndex:!1,wrapX:n.wrapX})),i.featurePool_=[],i.lineStyle_=new Ne({stroke:i.strokeStyle_}),i.loadedExtent_=null,i.renderedExtent_=null,i.setRenderOrder(null),i}return e.prototype.strategyFunction=function(t,i){var n=t.slice();return this.projection_&&this.getSource().getWrapX()&&Gn(n,this.projection_),this.loadedExtent_&&(Vo(this.loadedExtent_,n,i)?n=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[n]},e.prototype.loaderFunction=function(t,i,n){this.loadedExtent_=t;var a=this.getSource(),s=this.getExtent()||[-Infinity,-Infinity,Infinity,Infinity],o=qt(s,t);if(!(this.renderedExtent_&&Zt(this.renderedExtent_,o))&&(this.renderedExtent_=o,!Te(o))){var h=xt(o),l=i*i/4,u=!this.projection_||!Vt(this.projection_,n);u&&this.updateProjectionInfo_(n),this.createGraticule_(o,h,i,l);var f=this.meridians_.length+this.parallels_.length;this.meridiansLabels_&&(f+=this.meridians_.length),this.parallelsLabels_&&(f+=this.parallels_.length);for(var c;f>this.featurePool_.length;)c=new Gi,this.featurePool_.push(c);var p=a.getFeaturesCollection();p.clear();var d=0,v,_;for(v=0,_=this.meridians_.length;v<_;++v)c=this.featurePool_[d++],c.setGeometry(this.meridians_[v]),c.setStyle(this.lineStyle_),p.push(c);for(v=0,_=this.parallels_.length;v<_;++v)c=this.featurePool_[d++],c.setGeometry(this.parallels_[v]),c.setStyle(this.lineStyle_),p.push(c)}},e.prototype.addMeridian_=function(t,i,n,a,s,o){var h=this.getMeridian_(t,i,n,a,o);if(ct(h.getExtent(),s)){if(this.meridiansLabels_){var l=this.lonLabelFormatter_(t);o in this.meridiansLabels_?this.meridiansLabels_[o].text=l:this.meridiansLabels_[o]={geom:new Se([]),text:l}}this.meridians_[o++]=h}return o},e.prototype.addParallel_=function(t,i,n,a,s,o){var h=this.getParallel_(t,i,n,a,o);if(ct(h.getExtent(),s)){if(this.parallelsLabels_){var l=this.latLabelFormatter_(t);o in this.parallelsLabels_?this.parallelsLabels_[o].text=l:this.parallelsLabels_[o]={geom:new Se([]),text:l}}this.parallels_[o++]=h}return o},e.prototype.drawLabels_=function(t){var i=t.frameState.viewState.rotation,n=t.frameState.extent,a=xt(n),s=n;if(i){var o=Z(n),h=ft(n),l=Math.abs(Math.cos(i)),u=Math.abs(Math.sin(i)),f=(u*h-l*o)/(u*u-l*l),c=(u*o-l*h)/(u*u-l*l);s=[a[0]-f/2,a[1]-c/2,a[0]+f/2,a[1]+c/2]}var p=0,d=0,v=this.latLabelPosition_<.5,_=this.projection_.getExtent(),m=Z(_);if(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!wt(_,n)){p=Math.floor((n[0]-_[0])/m),d=Math.ceil((n[2]-_[2])/m);var g=Math.abs(i)>Math.PI/2;v=v!==g}for(var y=qr(t),x=p;x<=d;++x){var E=this.meridians_.length+this.parallels_.length,M=void 0,C=void 0,T=void 0,S=void 0;if(this.meridiansLabels_)for(C=0,T=this.meridiansLabels_.length;C<T;++C){var P=this.meridians_[C];if(!i&&x===0)S=this.getMeridianPoint_(P,n,C);else{var O=P.clone();O.translate(x*m,0),O.rotate(-i,a),S=this.getMeridianPoint_(O,s,C),S.rotate(i,a)}M=this.featurePool_[E++],M.setGeometry(S),M.set("graticule_label",this.meridiansLabels_[C].text),y.drawFeature(M,this.lonLabelStyle_(M))}if(this.parallelsLabels_&&(x===p&&v||x===d&&!v))for(C=0,T=this.parallels_.length;C<T;++C){var P=this.parallels_[C];if(!i&&x===0)S=this.getParallelPoint_(P,n,C);else{var O=P.clone();O.translate(x*m,0),O.rotate(-i,a),S=this.getParallelPoint_(O,s,C),S.rotate(i,a)}M=this.featurePool_[E++],M.setGeometry(S),M.set("graticule_label",this.parallelsLabels_[C].text),y.drawFeature(M,this.latLabelStyle_(M))}}},e.prototype.createGraticule_=function(t,i,n,a){var s=this.getInterval_(n);if(s==-1){this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),this.parallelsLabels_&&(this.parallelsLabels_.length=0);return}var o=!1,h=this.projection_.getExtent(),l=Z(h);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!wt(h,t)&&(Z(t)>=l?(t[0]=h[0],t[2]=h[2]):o=!0);var u=[A(i[0],this.minX_,this.maxX_),A(i[1],this.minY_,this.maxY_)],f=this.toLonLatTransform_(u);isNaN(f[1])&&(f[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var c=A(f[0],this.minLon_,this.maxLon_),p=A(f[1],this.minLat_,this.maxLat_),d=this.maxLines_,v,_,m,g,y=t;o||(y=[A(t[0],this.minX_,this.maxX_),A(t[1],this.minY_,this.maxY_),A(t[2],this.minX_,this.maxX_),A(t[3],this.minY_,this.maxY_)]);var x=Hi(y,this.toLonLatTransform_,void 0,8),E=x[3],M=x[2],C=x[1],T=x[0];if(o||(mt(y,this.bottomLeft_)&&(T=this.minLon_,C=this.minLat_),mt(y,this.bottomRight_)&&(M=this.maxLon_,C=this.minLat_),mt(y,this.topLeft_)&&(T=this.minLon_,E=this.maxLat_),mt(y,this.topRight_)&&(M=this.maxLon_,E=this.maxLat_),E=A(E,p,this.maxLat_),M=A(M,c,this.maxLon_),C=A(C,this.minLat_,p),T=A(T,this.minLon_,c)),c=Math.floor(c/s)*s,g=A(c,this.minLon_,this.maxLon_),_=this.addMeridian_(g,C,E,a,t,0),v=0,o)for(;(g-=s)>=T&&v++<d;)_=this.addMeridian_(g,C,E,a,t,_);else for(;g!=this.minLon_&&v++<d;)g=Math.max(g-s,this.minLon_),_=this.addMeridian_(g,C,E,a,t,_);if(g=A(c,this.minLon_,this.maxLon_),v=0,o)for(;(g+=s)<=M&&v++<d;)_=this.addMeridian_(g,C,E,a,t,_);else for(;g!=this.maxLon_&&v++<d;)g=Math.min(g+s,this.maxLon_),_=this.addMeridian_(g,C,E,a,t,_);for(this.meridians_.length=_,this.meridiansLabels_&&(this.meridiansLabels_.length=_),p=Math.floor(p/s)*s,m=A(p,this.minLat_,this.maxLat_),_=this.addParallel_(m,T,M,a,t,0),v=0;m!=this.minLat_&&v++<d;)m=Math.max(m-s,this.minLat_),_=this.addParallel_(m,T,M,a,t,_);for(m=A(p,this.minLat_,this.maxLat_),v=0;m!=this.maxLat_&&v++<d;)m=Math.min(m+s,this.maxLat_),_=this.addParallel_(m,T,M,a,t,_);this.parallels_.length=_,this.parallelsLabels_&&(this.parallelsLabels_.length=_)},e.prototype.getInterval_=function(t){for(var i=this.projectionCenterLonLat_[0],n=this.projectionCenterLonLat_[1],a=-1,s=Math.pow(this.targetSize_*t,2),o=[],h=[],l=0,u=this.intervals_.length;l<u;++l){var f=A(this.intervals_[l]/2,0,90),c=A(n,-90+f,90-f);o[0]=i-f,o[1]=c-f,h[0]=i+f,h[1]=c+f,this.fromLonLatTransform_(o,o),this.fromLonLatTransform_(h,h);var p=Math.pow(h[0]-o[0],2)+Math.pow(h[1]-o[1],2);if(p<=s)break;a=this.intervals_[l]}return a},e.prototype.getMeridian_=function(t,i,n,a,s){var o=jd(t,i,n,this.projection_,a),h=this.meridians_[s];return h?(h.setFlatCoordinates(J.XY,o),h.changed()):(h=new $i(o,J.XY),this.meridians_[s]=h),h},e.prototype.getMeridianPoint_=function(t,i,n){var a=t.getFlatCoordinates(),s=1,o=a.length-1;a[s]>a[o]&&(s=o,o=1);var h=Math.max(i[1],a[s]),l=Math.min(i[3],a[o]),u=A(i[1]+Math.abs(i[1]-i[3])*this.lonLabelPosition_,h,l),f=a[s-1]+(a[o-1]-a[s-1])*(u-a[s])/(a[o]-a[s]),c=[f,u],p=this.meridiansLabels_[n].geom;return p.setCoordinates(c),p},e.prototype.getMeridians=function(){return this.meridians_},e.prototype.getParallel_=function(t,i,n,a,s){var o=Fd(t,i,n,this.projection_,a),h=this.parallels_[s];return h?(h.setFlatCoordinates(J.XY,o),h.changed()):h=new $i(o,J.XY),h},e.prototype.getParallelPoint_=function(t,i,n){var a=t.getFlatCoordinates(),s=0,o=a.length-2;a[s]>a[o]&&(s=o,o=0);var h=Math.max(i[0],a[s]),l=Math.min(i[2],a[o]),u=A(i[0]+Math.abs(i[0]-i[2])*this.latLabelPosition_,h,l),f=a[s+1]+(a[o+1]-a[s+1])*(u-a[s])/(a[o]-a[s]),c=[u,f],p=this.parallelsLabels_[n].geom;return p.setCoordinates(c),p},e.prototype.getParallels=function(){return this.parallels_},e.prototype.updateProjectionInfo_=function(t){var i=vt("EPSG:4326"),n=t.getWorldExtent();this.maxLat_=n[3],this.maxLon_=n[2],this.minLat_=n[1],this.minLon_=n[0];var a=fe(t,i);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=a;else{var s=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(h,l,u){for(var f=u||2,c=a(h,l,f),p=0,d=c.length;p<d;p+=f)c[p]<s&&(c[p]+=360);return c}}this.fromLonLatTransform_=fe(i,t);var o=Hi([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=o[0],this.maxX_=o[2],this.minY_=o[1],this.maxY_=o[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(xt(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t},e}(Uh);var $r=function(){function r(e,t,i,n){this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}return r.prototype.contains=function(e){return this.containsXY(e[1],e[2])},r.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},r.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},r.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},r.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},r.prototype.getHeight=function(){return this.maxY-this.minY+1},r.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},r.prototype.getWidth=function(){return this.maxX-this.minX+1},r.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},r}();function Oi(r,e,t,i,n){return n!==void 0?(n.minX=r,n.maxX=e,n.minY=t,n.maxY=i,n):new $r(r,e,t,i)}var Jr={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},kd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ns=function(r){kd(e,r);function e(t){var i=r.call(this,t)||this;return i.extentChanged=!0,i.renderedExtent_=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.newTiles_=!1,i.tmpExtent=Tt(),i.tmpTileRange_=new $r(0,0,0,0),i}return e.prototype.isDrawableTile=function(t){var i=this.getLayer(),n=t.getState(),a=i.getUseInterimTilesOnError();return n==G.LOADED||n==G.EMPTY||n==G.ERROR&&!a},e.prototype.getTile=function(t,i,n,a){var s=a.pixelRatio,o=a.viewState.projection,h=this.getLayer(),l=h.getSource(),u=l.getTile(t,i,n,s,o);return u.getState()==G.ERROR&&(h.getUseInterimTilesOnError()?h.getPreload()>0&&(this.newTiles_=!0):u.setState(G.LOADED)),this.isDrawableTile(u)||(u=u.getInterimTile()),u},e.prototype.loadedTileCallback=function(t,i,n){return this.isDrawableTile(n)?r.prototype.loadedTileCallback.call(this,t,i,n):!1},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,i){var n=t.layerStatesArray[t.layerIndex],a=t.viewState,s=a.projection,o=a.resolution,h=a.center,l=a.rotation,u=t.pixelRatio,f=this.getLayer(),c=f.getSource(),p=c.getRevision(),d=c.getTileGridForProjection(s),v=d.getZForResolution(o,c.zDirection),_=d.getResolution(v),m=t.extent,g=n.extent&&Me(n.extent);g&&(m=qt(m,Me(n.extent)));var y=c.getTilePixelRatio(u),x=Math.round(t.size[0]*y),E=Math.round(t.size[1]*y);if(l){var M=Math.round(Math.sqrt(x*x+E*E));x=M,E=M}var C=_*x/2/y,T=_*E/2/y,S=[h[0]-C,h[1]-T,h[0]+C,h[1]+T],P=d.getTileRangeForExtentAndZ(m,v),O={};O[v]={};var w=this.createLoadedTileFinder(c,s,O),j=this.tmpExtent,Y=this.tmpTileRange_;this.newTiles_=!1;for(var B=P.minX;B<=P.maxX;++B)for(var U=P.minY;U<=P.maxY;++U){var F=this.getTile(v,B,U,t);if(this.isDrawableTile(F)){var $=V(this);if(F.getState()==G.LOADED){O[v][F.tileCoord.toString()]=F;var q=F.inTransition($);!this.newTiles_&&(q||this.renderedTiles.indexOf(F)===-1)&&(this.newTiles_=!0)}if(F.getAlpha($,t.time)===1)continue}var et=d.getTileCoordChildTileRange(F.tileCoord,Y,j),ot=!1;et&&(ot=w(v+1,et)),ot||d.forEachTileCoordParentTileRange(F.tileCoord,w,Y,j)}var R=_/o;jt(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/y,1/y,l,-x/2,-E/2);var At=bn(this.pixelTransform);this.useContainer(i,At,n.opacity);var K=this.context,pt=K.canvas;zi(this.inversePixelTransform,this.pixelTransform),jt(this.tempTransform,x/2,E/2,R,R,0,-x/2,-E/2),pt.width!=x||pt.height!=E?(pt.width=x,pt.height=E):this.containerReused||K.clearRect(0,0,x,E),g&&this.clipUnrotated(K,t,g),nt(K,c.getContextOptions()),this.preRender(K,t),this.renderedTiles.length=0;var zt=Object.keys(O).map(Number);zt.sort(ge);var Wt,Nt,Yt;n.opacity===1&&(!this.containerReused||c.getOpaque(t.viewState.projection))?zt=zt.reverse():(Wt=[],Nt=[]);for(var Li=zt.length-1;Li>=0;--Li){var me=zt[Li],dn=c.getTilePixelSize(me,u,s),pn=d.getResolution(me),We=pn/_,Pi=dn[0]*We*R,vn=dn[1]*We*R,yr=d.getTileCoordForCoordAndZ(de(S),me),_n=d.getTileCoordExtent(yr),vi=ht(this.tempTransform,[y*(_n[0]-S[0])/_,y*(S[3]-_n[3])/_]),xr=y*c.getGutterForProjection(s),mn=O[me];for(var Ai in mn){var F=mn[Ai],Ye=F.tileCoord,bi=yr[1]-Ye[1],Da=Math.round(vi[0]-(bi-1)*Pi),gn=yr[2]-Ye[2],Er=Math.round(vi[1]-(gn-1)*vn),B=Math.round(vi[0]-bi*Pi),U=Math.round(vi[1]-gn*vn),Ve=Da-B,be=Er-U,_i=v===me,q=_i&&F.getAlpha(V(this),t.time)!==1;if(!q)if(Wt){K.save(),Yt=[B,U,B+Ve,U,B+Ve,U+be,B,U+be];for(var ji=0,ae=Wt.length;ji<ae;++ji)if(v!==me&&me<Nt[ji]){var se=Wt[ji];K.beginPath(),K.moveTo(Yt[0],Yt[1]),K.lineTo(Yt[2],Yt[3]),K.lineTo(Yt[4],Yt[5]),K.lineTo(Yt[6],Yt[7]),K.moveTo(se[6],se[7]),K.lineTo(se[4],se[5]),K.lineTo(se[2],se[3]),K.lineTo(se[0],se[1]),K.clip()}Wt.push(Yt),Nt.push(me)}else K.clearRect(B,U,Ve,be);this.drawTileImage(F,t,B,U,Ve,be,xr,_i),Wt&&!q?(K.restore(),this.renderedTiles.unshift(F)):this.renderedTiles.push(F),this.updateUsedTiles(t.usedTiles,c,F)}}this.renderedRevision=p,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!Zt(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=u,this.renderedProjection=s,this.manageTilePyramid(t,c,d,u,s,m,v,f.getPreload()),this.scheduleExpireCache(t,c),this.postRender(K,t),n.extent&&K.restore(),At!==pt.style.transform&&(pt.style.transform=At);var mi=Ji(n.opacity),Fi=this.container;return mi!==Fi.style.opacity&&(Fi.style.opacity=mi),this.container},e.prototype.drawTileImage=function(t,i,n,a,s,o,h,l){var u=this.getTileImage(t);if(!!u){var f=V(this),c=l?t.getAlpha(f,i.time):1,p=c!==this.context.globalAlpha;p&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(u,h,h,u.width-2*h,u.height-2*h,n,a,s,o),p&&this.context.restore(),c!==1?i.animate=!0:l&&t.endTransition(f)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,i){if(i.canExpireCache()){var n=function(a,s,o){var h=V(a);h in o.usedTiles&&a.expireCache(o.viewState.projection,o.usedTiles[h])}.bind(null,i);t.postRenderFunctions.push(n)}},e.prototype.updateUsedTiles=function(t,i,n){var a=V(i);a in t||(t[a]={}),t[a][n.getKey()]=!0},e.prototype.manageTilePyramid=function(t,i,n,a,s,o,h,l,u){var f=V(i);f in t.wantedTiles||(t.wantedTiles[f]={});var c=t.wantedTiles[f],p=t.tileQueue,d=n.getMinZoom(),v=0,_,m,g,y,x,E;for(E=d;E<=h;++E)for(m=n.getTileRangeForExtentAndZ(o,E,m),g=n.getResolution(E),y=m.minX;y<=m.maxX;++y)for(x=m.minY;x<=m.maxY;++x)h-E<=l?(++v,_=i.getTile(E,y,x,a,s),_.getState()==G.IDLE&&(c[_.getKey()]=!0,p.isKeyQueued(_.getKey())||p.enqueue([_,f,n.getTileCoordCenter(_.tileCoord),g])),u!==void 0&&u(_)):i.useTile(E,y,x,s);i.updateCacheSize(v,s)},e}(ha);Ns.prototype.getLayer;var Bd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Xd=function(r){Bd(e,r);function e(t){var i=this,n=t||{},a=nt({},n);return delete a.preload,delete a.useInterimTilesOnError,i=r.call(this,a)||this,i.on,i.once,i.un,i.setPreload(n.preload!==void 0?n.preload:0),i.setUseInterimTilesOnError(n.useInterimTilesOnError!==void 0?n.useInterimTilesOnError:!0),i}return e.prototype.getPreload=function(){return this.get(Jr.PRELOAD)},e.prototype.setPreload=function(t){this.set(Jr.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Jr.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Jr.USE_INTERIM_TILES_ON_ERROR,t)},e}(In),Ud=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Gs=function(r){Ud(e,r);function e(t){return r.call(this,t)||this}return e.prototype.createRenderer=function(){return new Ns(this)},e}(Xd);function cl(r,e,t,i){return i!==void 0?(i[0]=r,i[1]=e,i[2]=t,i):[r,e,t]}function lr(r,e,t){return r+"/"+e+"/"+t}function ga(r){return lr(r[0],r[1],r[2])}function dl(r){return r.split("/").map(Number)}function pl(r){return(r[1]<<r[0])+r[2]}function vl(r,e){var t=r[0],i=r[1],n=r[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var a=e.getFullTileRange(t);return a?a.containsXY(i,n):!0}var zd=[0,0,0],ks=function(){function r(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,X(mo(this.resolutions_,function(s,o){return o-s},!0),17);var t;if(!e.origins){for(var i=0,n=this.resolutions_.length-1;i<n;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,X(this.origins_.length==this.resolutions_.length,20));var a=e.extent;a!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=de(a)),X(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,X(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:hr,X(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=a!==void 0?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(s,o){var h=new $r(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(a){var l=this.getTileRangeForExtentAndZ(a,o);h.minX=Math.max(l.minX,h.minX),h.maxX=Math.min(l.maxX,h.maxX),h.minY=Math.max(l.minY,h.minY),h.maxY=Math.min(l.maxY,h.maxY)}return h},this):a&&this.calculateTileRanges_(a)}return r.prototype.forEachTileCoord=function(e,t,i){for(var n=this.getTileRangeForExtentAndZ(e,t),a=n.minX,s=n.maxX;a<=s;++a)for(var o=n.minY,h=n.maxY;o<=h;++o)i([t,a,o])},r.prototype.forEachTileCoordParentTileRange=function(e,t,i,n){var a,s,o,h=null,l=e[0]-1;for(this.zoomFactor_===2?(s=e[1],o=e[2]):h=this.getTileCoordExtent(e,n);l>=this.minZoom;){if(this.zoomFactor_===2?(s=Math.floor(s/2),o=Math.floor(o/2),a=Oi(s,s,o,o,i)):a=this.getTileRangeForExtentAndZ(h,l,i),t(l,a))return!0;--l}return!1},r.prototype.getExtent=function(){return this.extent_},r.prototype.getMaxZoom=function(){return this.maxZoom},r.prototype.getMinZoom=function(){return this.minZoom},r.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},r.prototype.getResolution=function(e){return this.resolutions_[e]},r.prototype.getResolutions=function(){return this.resolutions_},r.prototype.getTileCoordChildTileRange=function(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var n=e[1]*2,a=e[2]*2;return Oi(n,n+1,a,a+1,t)}var s=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e[0]+1,t)}return null},r.prototype.getTileRangeForTileCoordAndZ=function(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;var n=e[0],a=e[1],s=e[2];if(t===n)return Oi(a,s,a,s,i);if(this.zoomFactor_){var o=Math.pow(this.zoomFactor_,t-n),h=Math.floor(a*o),l=Math.floor(s*o);if(t<n)return Oi(h,h,l,l,i);var u=Math.floor(o*(a+1))-1,f=Math.floor(o*(s+1))-1;return Oi(h,u,l,f,i)}var c=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(c,t,i)},r.prototype.getTileRangeExtent=function(e,t,i){var n=this.getOrigin(e),a=this.getResolution(e),s=Ct(this.getTileSize(e),this.tmpSize_),o=n[0]+t.minX*s[0]*a,h=n[0]+(t.maxX+1)*s[0]*a,l=n[1]+t.minY*s[1]*a,u=n[1]+(t.maxY+1)*s[1]*a;return Bt(o,l,h,u,i)},r.prototype.getTileRangeForExtentAndZ=function(e,t,i){var n=zd;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,n);var a=n[1],s=n[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,n),Oi(a,n[1],s,n[2],i)},r.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),i=this.getResolution(e[0]),n=Ct(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*i,t[1]-(e[2]+.5)*n[1]*i]},r.prototype.getTileCoordExtent=function(e,t){var i=this.getOrigin(e[0]),n=this.getResolution(e[0]),a=Ct(this.getTileSize(e[0]),this.tmpSize_),s=i[0]+e[1]*a[0]*n,o=i[1]-(e[2]+1)*a[1]*n,h=s+a[0]*n,l=o+a[1]*n;return Bt(s,o,h,l,t)},r.prototype.getTileCoordForCoordAndResolution=function(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)},r.prototype.getTileCoordForXYAndResolution_=function(e,t,i,n,a){var s=this.getZForResolution(i),o=i/this.getResolution(s),h=this.getOrigin(s),l=Ct(this.getTileSize(s),this.tmpSize_),u=n?.5:0,f=n?.5:0,c=Math.floor((e-h[0])/i+u),p=Math.floor((h[1]-t)/i+f),d=o*c/l[0],v=o*p/l[1];return n?(d=Math.ceil(d)-1,v=Math.ceil(v)-1):(d=Math.floor(d),v=Math.floor(v)),cl(s,d,v,a)},r.prototype.getTileCoordForXYAndZ_=function(e,t,i,n,a){var s=this.getOrigin(i),o=this.getResolution(i),h=Ct(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?.5:0,f=Math.floor((e-s[0])/o+l),c=Math.floor((s[1]-t)/o+u),p=f/h[0],d=c/h[1];return n?(p=Math.ceil(p)-1,d=Math.ceil(d)-1):(p=Math.floor(p),d=Math.floor(d)),cl(i,p,d,a)},r.prototype.getTileCoordForCoordAndZ=function(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)},r.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},r.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},r.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},r.prototype.getZForResolution=function(e,t){var i=Or(this.resolutions_,e,t||0);return A(i,this.minZoom,this.maxZoom)},r.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,i=new Array(t),n=this.minZoom;n<t;++n)i[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=i},r}();function ya(r){var e=r.getDefaultTileGrid();return e||(e=Wd(r),r.setDefaultTileGrid(e)),e}function _l(r,e,t){var i=e[0],n=r.getTileCoordCenter(e),a=xa(t);if(mt(a,n))return e;var s=Z(a),o=Math.ceil((a[0]-n[0])/s);return n[0]+=s*o,r.getTileCoordForCoordAndZ(n,i)}function Yd(r,e,t,i){var n=i!==void 0?i:Wi.TOP_LEFT,a=ml(r,e,t);return new ks({extent:r,origin:qo(r,n),resolutions:a,tileSize:t})}function gl(r){var e=r||{},t=e.extent||vt("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:ml(t,e.maxZoom,e.tileSize,e.maxResolution)};return new ks(i)}function ml(r,e,t,i){for(var n=e!==void 0?e:Zh,a=ft(r),s=Z(r),o=Ct(t!==void 0?t:hr),h=i>0?i:Math.max(s/o[0],a/o[1]),l=n+1,u=new Array(l),f=0;f<l;++f)u[f]=h/Math.pow(2,f);return u}function Wd(r,e,t,i){var n=xa(r);return Yd(n,e,t,i)}function xa(r){r=vt(r);var e=r.getExtent();if(!e){var t=180*ee[Rt.DEGREES]/r.getMetersPerUnit();e=Bt(-t,-t,t,t)}return e}var Vd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Bs=function(r){Vd(e,r);function e(t,i,n){var a=r.call(this)||this,s=n||{};return a.tileCoord=t,a.state=i,a.interimTile=null,a.key="",a.transition_=s.transition===void 0?250:s.transition,a.transitionStarts_={},a}return e.prototype.changed=function(){this.dispatchEvent(D.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==G.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(!!this.interimTile){var t=this.interimTile,i=this;do{if(t.getState()==G.LOADED){t.interimTile=null;break}else t.getState()==G.LOADING?i=t:t.getState()==G.IDLE?i.interimTile=t.interimTile:i=t;t=i.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==G.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){z()},e.prototype.getAlpha=function(t,i){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(!n)n=i,this.transitionStarts_[t]=n;else if(n===-1)return 1;var a=i-n+1e3/60;return a>=this.transition_?1:xs(a/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Jt),Zd=function(){function r(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return r.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},r.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},r.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},r.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},r.prototype.get=function(e,t){var i=this.entries_[e];return X(i!==void 0,15),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_},r.prototype.remove=function(e){var t=this.entries_[e];return X(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},r.prototype.getCount=function(){return this.count_},r.prototype.getKeys=function(){var e=new Array(this.count_),t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e},r.prototype.getValues=function(){var e=new Array(this.count_),t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e},r.prototype.peekLast=function(){return this.oldest_.value_},r.prototype.peekLastKey=function(){return this.oldest_.key_},r.prototype.peekFirstKey=function(){return this.newest_.key_},r.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},r.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},r.prototype.set=function(e,t){X(!(e in this.entries_),16);var i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_},r.prototype.setSize=function(e){this.highWaterMark=e},r}(),qd=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Xs=function(r){qd(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var i=this.peekLast();if(i.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),i=dl(t),n=i[0];this.forEach(function(a){a.tileCoord[0]!==n&&(this.remove(ga(a.tileCoord)),a.release())}.bind(this))}},e}(Zd),Us={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},yl=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Kd=function(r){yl(e,r);function e(t){var i=r.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this;i.on,i.once,i.un,i.opaque_=t.opaque!==void 0?t.opaque:!1,i.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,i.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var n=[256,256],a=t.tileGrid;return a&&Ct(a.getTileSize(a.getMinZoom()),n),i.tileCache=new Xs(t.cacheSize||0),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition},i.zDirection=t.zDirection?t.zDirection:0,i}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,i){var n=this.getTileCacheForProjection(t);n&&n.expireCache(i)},e.prototype.forEachLoadedTile=function(t,i,n,a){var s=this.getTileCacheForProjection(t);if(!s)return!1;for(var o=!0,h,l,u,f=n.minX;f<=n.maxX;++f)for(var c=n.minY;c<=n.maxY;++c)l=lr(i,f,c),u=!1,s.containsKey(l)&&(h=s.get(l),u=h.getState()===G.LOADED,u&&(u=a(h)!==!1)),u||(o=!1);return o},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,i,n,a,s){return z()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:ya(t)},e.prototype.getTileCacheForProjection=function(t){return X(Vt(this.getProjection(),t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,i,n){var a=this.getTileGridForProjection(n),s=this.getTilePixelRatio(i),o=Ct(a.getTileSize(t),this.tmpSize);return s==1?o:hh(o,s,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,i){var n=i!==void 0?i:this.getProjection(),a=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=_l(a,t,n)),vl(t,a)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),r.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,i){var n=this.getTileCacheForProjection(i);t>n.highWaterMark&&(n.highWaterMark=t)},e.prototype.useTile=function(t,i,n,a){},e}(fa),Hd=function(r){yl(e,r);function e(t,i){var n=r.call(this,t)||this;return n.tile=i,n}return e}(kt);function $d(r,e){var t=/\{z\}/g,i=/\{x\}/g,n=/\{y\}/g,a=/\{-y\}/g;return function(s,o,h){if(s)return r.replace(t,s[0].toString()).replace(i,s[1].toString()).replace(n,s[2].toString()).replace(a,function(){var l=s[0],u=e.getFullTileRange(l);X(u,55);var f=u.getHeight()-s[2]-1;return f.toString()})}}function Qd(r,e){for(var t=r.length,i=new Array(t),n=0;n<t;++n)i[n]=$d(r[n],e);return Jd(i)}function Jd(r){return r.length===1?r[0]:function(e,t,i){if(e){var n=pl(e),a=le(n,r.length);return r[a](e,t,i)}else return}}function tp(r){var e=[],t=/\{([a-z])-([a-z])\}/.exec(r);if(t){var i=t[1].charCodeAt(0),n=t[2].charCodeAt(0),a=void 0;for(a=i;a<=n;++a)e.push(r.replace(t[0],String.fromCharCode(a)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(r),t){for(var s=parseInt(t[2],10),o=parseInt(t[1],10);o<=s;o++)e.push(r.replace(t[0],o.toString()));return e}return e.push(r),e}var ep=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),xl=function(r){ep(e,r);function e(t){var i=r.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return i.generateTileUrlFunction_=i.tileUrlFunction===e.prototype.tileUrlFunction,i.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(i.tileUrlFunction=t.tileUrlFunction),i.urls=null,t.urls?i.setUrls(t.urls):t.url&&i.setUrl(t.url),i.tileLoadingKeys_={},i}return e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var i=t.target,n=V(i),a=i.getState(),s;a==G.LOADING?(this.tileLoadingKeys_[n]=!0,s=Us.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=a==G.ERROR?Us.TILELOADERROR:a==G.LOADED?Us.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new Hd(s,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,i){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof i!="undefined"?this.setKey(i):this.changed()},e.prototype.setUrl=function(t){var i=tp(t);this.urls=i,this.setUrls(i)},e.prototype.setUrls=function(t){this.urls=t;var i=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Qd(t,this.tileGrid),i):this.setKey(i)},e.prototype.tileUrlFunction=function(t,i,n){},e.prototype.useTile=function(t,i,n){var a=lr(t,i,n);this.tileCache.containsKey(a)&&this.tileCache.get(a)},e}(Kd);var ip=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),np=function(r){ip(e,r);function e(t,i,n,a,s,o){var h=r.call(this,t,i,o)||this;return h.crossOrigin_=a,h.src_=n,h.key=n,h.image_=new Image,a!==null&&(h.image_.crossOrigin=a),h.unlisten_=null,h.tileLoadFunction_=s,h}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=G.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=G.ERROR,this.unlistenImage_(),this.image_=rp(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=G.LOADED:this.state=G.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==G.ERROR&&(this.state=G.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==G.IDLE&&(this.state=G.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Wr(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Bs);function rp(){var r=Et(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}var ap=.5,sp=10,El=.25,op=function(){function r(e,t,i,n,a,s){this.sourceProj_=e,this.targetProj_=t;var o={},h=fe(this.targetProj_,this.sourceProj_);this.transformInv_=function(y){var x=y[0]+"/"+y[1];return o[x]||(o[x]=h(y)),o[x]},this.maxSourceExtent_=n,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Z(n)==Z(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Z(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Z(this.targetProj_.getExtent()):null;var l=de(i),u=Ki(i),f=qi(i),c=Zi(i),p=this.transformInv_(l),d=this.transformInv_(u),v=this.transformInv_(f),_=this.transformInv_(c),m=sp+(s?Math.max(0,Math.ceil(Co(Nn(i)/(s*s*256*256)))):0);if(this.addQuad_(l,u,f,c,p,d,v,_,m),this.wrapsXInSource_){var g=Infinity;this.triangles_.forEach(function(y,x,E){g=Math.min(g,y.source[0][0],y.source[1][0],y.source[2][0])}),this.triangles_.forEach(function(y){if(Math.max(y.source[0][0],y.source[1][0],y.source[2][0])-g>this.sourceWorldWidth_/2){var x=[[y.source[0][0],y.source[0][1]],[y.source[1][0],y.source[1][1]],[y.source[2][0],y.source[2][1]]];x[0][0]-g>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-g>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-g>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);var E=Math.min(x[0][0],x[1][0],x[2][0]),M=Math.max(x[0][0],x[1][0],x[2][0]);M-E<this.sourceWorldWidth_/2&&(y.source=x)}}.bind(this))}o={}}return r.prototype.addTriangle_=function(e,t,i,n,a,s){this.triangles_.push({source:[n,a,s],target:[e,t,i]})},r.prototype.addQuad_=function(e,t,i,n,a,s,o,h,l){var u=$a([a,s,o,h]),f=this.sourceWorldWidth_?Z(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&f>.5&&f<1,d=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var v=$a([e,t,i,n]),_=Z(v)/this.targetWorldWidth_;d=_>El||d}!p&&this.sourceProj_.isGlobal()&&f&&(d=f>El||d)}if(!(!d&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!ct(u,this.maxSourceExtent_))){var m=0;if(!d&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(h[0])||!isFinite(h[1]))){if(l>0)d=!0;else if(m=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(s[0])||!isFinite(s[1])?4:0)+(!isFinite(o[0])||!isFinite(o[1])?2:0)+(!isFinite(h[0])||!isFinite(h[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(l>0){if(!d){var g=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(g),x=void 0;if(p){var E=(le(a[0],c)+le(o[0],c))/2;x=E-le(y[0],c)}else x=(a[0]+o[0])/2-y[0];var M=(a[1]+o[1])/2-y[1],C=x*x+M*M;d=C>this.errorThresholdSquared_}if(d){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){var T=[(t[0]+i[0])/2,(t[1]+i[1])/2],S=this.transformInv_(T),P=[(n[0]+e[0])/2,(n[1]+e[1])/2],O=this.transformInv_(P);this.addQuad_(e,t,T,P,a,s,S,O,l-1),this.addQuad_(P,T,i,n,O,S,o,h,l-1)}else{var w=[(e[0]+t[0])/2,(e[1]+t[1])/2],j=this.transformInv_(w),Y=[(i[0]+n[0])/2,(i[1]+n[1])/2],B=this.transformInv_(Y);this.addQuad_(e,w,Y,n,a,j,B,h,l-1),this.addQuad_(w,t,i,Y,j,s,o,B,l-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(m&11)==0&&this.addTriangle_(e,i,n,a,o,h),(m&14)==0&&this.addTriangle_(e,i,t,a,o,s),m&&((m&13)==0&&this.addTriangle_(t,n,e,s,h,a),(m&7)==0&&this.addTriangle_(t,n,i,s,h,o))}},r.prototype.calculateSourceExtent=function(){var e=Tt();return this.triangles_.forEach(function(t,i,n){var a=t.source;xi(e,a[0]),xi(e,a[1]),xi(e,a[2])}),e},r.prototype.getTriangles=function(){return this.triangles_},r}(),Ml={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},zs;function Tl(r,e,t,i,n){r.beginPath(),r.moveTo(0,0),r.lineTo(e,t),r.lineTo(i,n),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(e,i)+1,Math.max(t,n)),r.restore()}function Ws(r,e){return Math.abs(r[e*4]-210)>2||Math.abs(r[e*4+3]-.75*255)>2}function hp(){if(zs===void 0){var r=document.createElement("canvas").getContext("2d");r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",Tl(r,4,5,4,0),Tl(r,4,5,0,5);var e=r.getImageData(0,0,3,3).data;zs=Ws(e,0)||Ws(e,4)||Ws(e,8)}return zs}function Cl(r,e,t,i){var n=Za(t,e,r),a=Va(e,i,t),s=e.getMetersPerUnit();s!==void 0&&(a*=s);var o=r.getMetersPerUnit();o!==void 0&&(a/=o);var h=r.getExtent();if(!h||mt(h,n)){var l=Va(r,a,n)/a;isFinite(l)&&l>0&&(a/=l)}return a}function lp(r,e,t,i){var n=xt(t),a=Cl(r,e,n,i);return(!isFinite(a)||a<=0)&&Dn(t,function(s){return a=Cl(r,e,s,i),isFinite(a)&&a>0}),a}function up(r,e,t,i,n,a,s,o,h,l,u,f){var c=Et(Math.round(t*r),Math.round(t*e));if(nt(c,f),h.length===0)return c.canvas;c.scale(t,t);function p(x){return Math.round(x*t)/t}c.globalCompositeOperation="lighter";var d=Tt();h.forEach(function(x,E,M){Zo(d,x.extent)});var v=Z(d),_=ft(d),m=Et(Math.round(t*v/i),Math.round(t*_/i));nt(m,f);var g=t/i;h.forEach(function(x,E,M){var C=x.extent[0]-d[0],T=-(x.extent[3]-d[3]),S=Z(x.extent),P=ft(x.extent);x.image.width>0&&x.image.height>0&&m.drawImage(x.image,l,l,x.image.width-2*l,x.image.height-2*l,C*g,T*g,S*g,P*g)});var y=de(s);return o.getTriangles().forEach(function(x,E,M){var C=x.source,T=x.target,S=C[0][0],P=C[0][1],O=C[1][0],w=C[1][1],j=C[2][0],Y=C[2][1],B=p((T[0][0]-y[0])/a),U=p(-(T[0][1]-y[1])/a),F=p((T[1][0]-y[0])/a),$=p(-(T[1][1]-y[1])/a),q=p((T[2][0]-y[0])/a),et=p(-(T[2][1]-y[1])/a),ot=S,R=P;S=0,P=0,O-=ot,w-=R,j-=ot,Y-=R;var At=[[O,w,0,0,F-B],[j,Y,0,0,q-B],[0,0,O,w,$-U],[0,0,j,Y,et-U]],K=So(At);if(!!K){if(c.save(),c.beginPath(),hp()||f===Ml){c.moveTo(F,$);for(var pt=4,zt=B-F,Wt=U-$,Nt=0;Nt<pt;Nt++)c.lineTo(F+p((Nt+1)*zt/pt),$+p(Nt*Wt/(pt-1))),Nt!=pt-1&&c.lineTo(F+p((Nt+1)*zt/pt),$+p((Nt+1)*Wt/(pt-1)));c.lineTo(q,et)}else c.moveTo(F,$),c.lineTo(B,U),c.lineTo(q,et);c.clip(),c.transform(K[0],K[2],K[1],K[3],B,U),c.translate(d[0]-ot,d[3]-R),c.scale(i/t,-i/t),c.drawImage(m.canvas,0,0),c.restore()}}),u&&(c.save(),c.globalCompositeOperation="source-over",c.strokeStyle="black",c.lineWidth=1,o.getTriangles().forEach(function(x,E,M){var C=x.target,T=(C[0][0]-y[0])/a,S=-(C[0][1]-y[1])/a,P=(C[1][0]-y[0])/a,O=-(C[1][1]-y[1])/a,w=(C[2][0]-y[0])/a,j=-(C[2][1]-y[1])/a;c.beginPath(),c.moveTo(P,O),c.lineTo(T,S),c.lineTo(w,j),c.closePath(),c.stroke()}),c.restore()),c.canvas}var fp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),cp=function(r){fp(e,r);function e(t,i,n,a,s,o,h,l,u,f,c,p){var d=r.call(this,s,G.IDLE)||this;d.renderEdges_=c!==void 0?c:!1,d.contextOptions_=p,d.pixelRatio_=h,d.gutter_=l,d.canvas_=null,d.sourceTileGrid_=i,d.targetTileGrid_=a,d.wrappedTileCoord_=o||s,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var v=a.getTileCoordExtent(d.wrappedTileCoord_),_=d.targetTileGrid_.getExtent(),m=d.sourceTileGrid_.getExtent(),g=_?qt(v,_):v;if(Nn(g)===0)return d.state=G.EMPTY,d;var y=t.getExtent();y&&(m?m=qt(m,y):m=y);var x=a.getResolution(d.wrappedTileCoord_[0]),E=lp(t,n,g,x);if(!isFinite(E)||E<=0)return d.state=G.EMPTY,d;var M=f!==void 0?f:ap;if(d.triangulation_=new op(t,n,g,m,E*M,x),d.triangulation_.getTriangles().length===0)return d.state=G.EMPTY,d;d.sourceZ_=i.getZForResolution(E);var C=d.triangulation_.calculateSourceExtent();if(m&&(t.canWrapX()?(C[1]=A(C[1],m[1],m[3]),C[3]=A(C[3],m[1],m[3])):C=qt(C,m)),!Nn(C))d.state=G.EMPTY;else{for(var T=i.getTileRangeForExtentAndZ(C,d.sourceZ_),S=T.minX;S<=T.maxX;S++)for(var P=T.minY;P<=T.maxY;P++){var O=u(d.sourceZ_,S,P,h);O&&d.sourceTiles_.push(O)}d.sourceTiles_.length===0&&(d.state=G.EMPTY)}return d}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(u,f,c){u&&u.getState()==G.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(u.tileCoord),image:u.getImage()})}.bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=G.ERROR;else{var i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),a=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(i),h=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=up(a,s,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.contextOptions_),this.state=G.LOADED}this.changed()},e.prototype.load=function(){if(this.state==G.IDLE){this.state=G.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(i,n,a){var s=i.getState();if(s==G.IDLE||s==G.LOADING){t++;var o=H(i,D.CHANGE,function(h){var l=i.getState();(l==G.LOADED||l==G.ERROR||l==G.EMPTY)&&(Q(o),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(o)}}.bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(i,n,a){var s=i.getState();s==G.IDLE&&i.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Q),this.sourcesListenerKeys_=null},e}(Bs),dp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Sl=function(r){dp(e,r);function e(t){var i=r.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:pp,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return i.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,i.tileClass=t.tileClass!==void 0?t.tileClass:np,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,i.contextOptions_=t.imageSmoothing===!1?Ml:void 0,i.renderReprojectionEdges_=!1,i}return e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,i){var n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?i:{});for(var a in this.tileCacheForProjection){var s=this.tileCacheForProjection[a];s.expireCache(s==n?i:{})}},e.prototype.getContextOptions=function(){return this.contextOptions_},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Vt(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){return r.prototype.getKey.call(this)+(this.contextOptions_?`
`+JSON.stringify(this.contextOptions_):"")},e.prototype.getOpaque=function(t){return this.getProjection()&&t&&!Vt(this.getProjection(),t)?!1:r.prototype.getOpaque.call(this,t)},e.prototype.getTileGridForProjection=function(t){var i=this.getProjection();if(this.tileGrid&&(!i||Vt(i,t)))return this.tileGrid;var n=V(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=ya(t)),this.tileGridForProjection[n]},e.prototype.getTileCacheForProjection=function(t){var i=this.getProjection();if(!i||Vt(i,t))return this.tileCache;var n=V(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Xs(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},e.prototype.createTile_=function(t,i,n,a,s,o){var h=[t,i,n],l=this.getTileCoordForTileUrlFunction(h,s),u=l?this.tileUrlFunction(l,a,s):void 0,f=new this.tileClass(h,u!==void 0?G.IDLE:G.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener(D.CHANGE,this.handleTileChange.bind(this)),f},e.prototype.getTile=function(t,i,n,a,s){var o=this.getProjection();if(!o||!s||Vt(o,s))return this.getTileInternal(t,i,n,a,o||s);var h=this.getTileCacheForProjection(s),l=[t,i,n],u=void 0,f=ga(l);h.containsKey(f)&&(u=h.get(f));var c=this.getKey();if(u&&u.key==c)return u;var p=this.getTileGridForProjection(o),d=this.getTileGridForProjection(s),v=this.getTileCoordForTileUrlFunction(l,s),_=new cp(o,p,s,d,l,v,this.getTilePixelRatio(a),this.getGutter(),function(m,g,y,x){return this.getTileInternal(m,g,y,x,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.contextOptions_);return _.key=c,u?(_.interimTile=u,_.refreshInterimChain(),h.replace(f,_)):h.set(f,_),_},e.prototype.getTileInternal=function(t,i,n,a,s){var o=null,h=lr(t,i,n),l=this.getKey();if(!this.tileCache.containsKey(h))o=this.createTile_(t,i,n,a,s,l),this.tileCache.set(h,o);else if(o=this.tileCache.get(h),o.key!=l){var u=o;o=this.createTile_(t,i,n,a,s,l),u.getState()==G.IDLE?o.interimTile=u.interimTile:o.interimTile=u,o.refreshInterimChain(),this.tileCache.replace(h,o)}return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(var i in this.tileCacheForProjection)this.tileCacheForProjection[i].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,i){{var n=vt(t);if(n){var a=V(n);a in this.tileGridForProjection||(this.tileGridForProjection[a]=i)}}},e}(xl);function pp(r,e){r.getImage().src=e}var vp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),_p=function(r){vp(e,r);function e(t){var i=this,n=t||{},a=n.projection!==void 0?n.projection:"EPSG:3857",s=n.tileGrid!==void 0?n.tileGrid:gl({extent:xa(a),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return i=r.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,imageSmoothing:n.imageSmoothing,opaque:n.opaque,projection:a,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:s,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:n.wrapX!==void 0?n.wrapX:!0,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this,i}return e}(Sl),mp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),gp='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',Il=function(r){mp(e,r);function e(t){var i=this,n=t||{},a;n.attributions!==void 0?a=n.attributions:a=[gp];var s=n.crossOrigin!==void 0?n.crossOrigin:"anonymous",o=n.url!==void 0?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return i=r.call(this,{attributions:a,attributionsCollapsible:!1,cacheSize:n.cacheSize,crossOrigin:s,imageSmoothing:n.imageSmoothing,maxZoom:n.maxZoom!==void 0?n.maxZoom:19,opaque:n.opaque!==void 0?n.opaque:!0,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,transition:n.transition,url:o,wrapX:n.wrapX,zDirection:n.zDirection})||this,i}return e}(_p);var yp=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(i[a]=n[a])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),Ea=function(r){yp(e,r);function e(t,i,n){var a=r.call(this)||this;if(a.ends_=[],a.maxDelta_=-1,a.maxDeltaRevision_=-1,Array.isArray(t[0]))a.setCoordinates(t,i);else if(i!==void 0&&n)a.setFlatCoordinates(i,t),a.ends_=n;else{for(var s=a.getLayout(),o=t,h=[],l=[],u=0,f=o.length;u<f;++u){var c=o[u];u===0&&(s=c.getLayout()),ye(h,c.getFlatCoordinates()),l.push(h.length)}a.setFlatCoordinates(s,h),a.ends_=l}return a}return e.prototype.appendLineString=function(t){this.flatCoordinates?ye(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,i,n,a){return a<Ei(this.getExtent(),t,i)?a:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Bn(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Xn(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,i,n,a))},e.prototype.getCoordinateAtM=function(t,i,n){if(this.layout!=J.XYM&&this.layout!=J.XYZM||this.flatCoordinates.length===0)return null;var a=i!==void 0?i:!1,s=n!==void 0?n:!1;return oh(this.flatCoordinates,0,this.ends_,this.stride,t,a,s)},e.prototype.getCoordinates=function(){return ei(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new $i(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,i=this.ends_,n=this.layout,a=[],s=0,o=0,h=i.length;o<h;++o){var l=i[o],u=new $i(t.slice(s,l),n);a.push(u),s=l}return a},e.prototype.getFlatMidpoints=function(){for(var t=[],i=this.flatCoordinates,n=0,a=this.ends_,s=this.stride,o=0,h=a.length;o<h;++o){var l=a[o],u=zn(i,n,l,s,.5);ye(t,u),n=l}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=ah(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,J.XY,n)},e.prototype.getType=function(){return k.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return ih(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,i){this.setLayout(i,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=Un(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()},e}(Fe);var Qr=1,Ol=2,Rl=3,Ma=4,wl=5,Ys=-1,xp=/\s/,Ep=/[A-Za-z]/,Mp=/[A-Za-z84]/,Ta=/[,\]]/,Ll=/[\d\.E\-\+]/;function Xe(r){if(typeof r!="string")throw new Error("not a string");this.text=r.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Qr}Xe.prototype.readCharicter=function(){var r=this.text[this.place++];if(this.state!==Ma)for(;xp.test(r);){if(this.place>=this.text.length)return;r=this.text[this.place++]}switch(this.state){case Qr:return this.neutral(r);case Ol:return this.keyword(r);case Ma:return this.quoted(r);case wl:return this.afterquote(r);case Rl:return this.number(r);case Ys:return}};Xe.prototype.afterquote=function(r){if(r==='"'){this.word+='"',this.state=Ma;return}if(Ta.test(r)){this.word=this.word.trim(),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in afterquote yet, index '+this.place)};Xe.prototype.afterItem=function(r){if(r===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Qr;return}if(r==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Qr,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Ys);return}};Xe.prototype.number=function(r){if(Ll.test(r)){this.word+=r;return}if(Ta.test(r)){this.word=parseFloat(this.word),this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in number yet, index '+this.place)};Xe.prototype.quoted=function(r){if(r==='"'){this.state=wl;return}this.word+=r};Xe.prototype.keyword=function(r){if(Mp.test(r)){this.word+=r;return}if(r==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=Qr;return}if(Ta.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in keyword yet, index '+this.place)};Xe.prototype.neutral=function(r){if(Ep.test(r)){this.word=r,this.state=Ol;return}if(r==='"'){this.word="",this.state=Ma;return}if(Ll.test(r)){this.word=r,this.state=Rl;return}if(Ta.test(r)){this.afterItem(r);return}throw new Error(`havn't handled "`+r+'" in neutral yet, index '+this.place)};Xe.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Ys)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Tp(r){var e=new Xe(r);return e.output()}function Pl(r,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var i=e?{}:r,n=t.reduce(function(a,s){return ur(s,a),a},i);e&&(r[e]=n)}function ur(r,e){if(!Array.isArray(r)){e[r]=!0;return}var t=r.shift();if(t==="PARAMETER"&&(t=r.shift()),r.length===1){if(Array.isArray(r[0])){e[t]={},ur(r[0],e[t]);return}e[t]=r[0];return}if(!r.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=r;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(r);return}Array.isArray(t)||(e[t]={});var i;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:r[0].toLowerCase(),convert:r[1]},r.length===3&&ur(r[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:r[0],a:r[1],rf:r[2]},r.length===4&&ur(r[3],e[t]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":r[0]=["name",r[0]],Pl(e,t,r);return;default:for(i=-1;++i<r.length;)if(!Array.isArray(r[i]))return ur(r,e[t]);return Pl(e,t,r)}}var Cp=.017453292519943295;function Sp(r,e){var t=e[0],i=e[1];!(t in r)&&i in r&&(r[t]=r[i],e.length===3&&(r[t]=e[2](r[t])))}function Ue(r){return r*Cp}function Ip(r){if(r.type==="GEOGCS"?r.projName="longlat":r.type==="LOCAL_CS"?(r.projName="identity",r.local=!0):typeof r.PROJECTION=="object"?r.projName=Object.keys(r.PROJECTION)[0]:r.projName=r.PROJECTION,r.AXIS){for(var e="",t=0,i=r.AXIS.length;t<i;++t){var n=[r.AXIS[t][0].toLowerCase(),r.AXIS[t][1].toLowerCase()];n[0].indexOf("north")!==-1||(n[0]==="y"||n[0]==="lat")&&n[1]==="north"?e+="n":n[0].indexOf("south")!==-1||(n[0]==="y"||n[0]==="lat")&&n[1]==="south"?e+="s":n[0].indexOf("east")!==-1||(n[0]==="x"||n[0]==="lon")&&n[1]==="east"?e+="e":(n[0].indexOf("west")!==-1||(n[0]==="x"||n[0]==="lon")&&n[1]==="west")&&(e+="w")}e.length===2&&(e+="u"),e.length===3&&(r.axis=e)}r.UNIT&&(r.units=r.UNIT.name.toLowerCase(),r.units==="metre"&&(r.units="meter"),r.UNIT.convert&&(r.type==="GEOGCS"?r.DATUM&&r.DATUM.SPHEROID&&(r.to_meter=r.UNIT.convert*r.DATUM.SPHEROID.a):r.to_meter=r.UNIT.convert));var a=r.GEOGCS;r.type==="GEOGCS"&&(a=r),a&&(a.DATUM?r.datumCode=a.DATUM.name.toLowerCase():r.datumCode=a.name.toLowerCase(),r.datumCode.slice(0,2)==="d_"&&(r.datumCode=r.datumCode.slice(2)),(r.datumCode==="new_zealand_geodetic_datum_1949"||r.datumCode==="new_zealand_1949")&&(r.datumCode="nzgd49"),(r.datumCode==="wgs_1984"||r.datumCode==="world_geodetic_system_1984")&&(r.PROJECTION==="Mercator_Auxiliary_Sphere"&&(r.sphere=!0),r.datumCode="wgs84"),r.datumCode.slice(-6)==="_ferro"&&(r.datumCode=r.datumCode.slice(0,-6)),r.datumCode.slice(-8)==="_jakarta"&&(r.datumCode=r.datumCode.slice(0,-8)),~r.datumCode.indexOf("belge")&&(r.datumCode="rnb72"),a.DATUM&&a.DATUM.SPHEROID&&(r.ellps=a.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),r.ellps.toLowerCase().slice(0,13)==="international"&&(r.ellps="intl"),r.a=a.DATUM.SPHEROID.a,r.rf=parseFloat(a.DATUM.SPHEROID.rf,10)),a.DATUM&&a.DATUM.TOWGS84&&(r.datum_params=a.DATUM.TOWGS84),~r.datumCode.indexOf("osgb_1936")&&(r.datumCode="osgb36"),~r.datumCode.indexOf("osni_1952")&&(r.datumCode="osni52"),(~r.datumCode.indexOf("tm65")||~r.datumCode.indexOf("geodetic_datum_of_1965"))&&(r.datumCode="ire65"),r.datumCode==="ch1903+"&&(r.datumCode="ch1903"),~r.datumCode.indexOf("israel")&&(r.datumCode="isr93")),r.b&&!isFinite(r.b)&&(r.b=r.a);function s(l){var u=r.to_meter||1;return l*u}var o=function(l){return Sp(r,l)},h=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Ue],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Ue],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",Ue],["lat0","latitude_of_origin",Ue],["lat0","standard_parallel_1",Ue],["lat1","standard_parallel_1",Ue],["lat2","standard_parallel_2",Ue],["azimuth","Azimuth"],["alpha","azimuth",Ue],["srsCode","name"]];h.forEach(o),!r.long0&&r.longc&&(r.projName==="Albers_Conic_Equal_Area"||r.projName==="Lambert_Azimuthal_Equal_Area")&&(r.long0=r.longc),!r.lat_ts&&r.lat1&&(r.projName==="Stereographic_South_Pole"||r.projName==="Polar Stereographic (variant B)")&&(r.lat0=Ue(r.lat1>0?90:-90),r.lat_ts=r.lat1)}function Vs(r){var e=Tp(r),t=e.shift(),i=e.shift();e.unshift(["name",i]),e.unshift(["type",t]);var n={};return ur(e,n),Ip(n),n}var Al=6,bl="AJSAJS",jl="AFAFAF",fr=65,Xt=73,ne=79,tn=86,en=90,Fl={forward:Zs,inverse:Op,toPoint:qs};function Zs(r,e){return e=e||5,wp(Rp({lat:r[1],lon:r[0]}),e)}function Op(r){var e=Ks(Dl(r.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function qs(r){var e=Ks(Dl(r.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function Hs(r){return r*(Math.PI/180)}function Nl(r){return 180*(r/Math.PI)}function Rp(r){var e=r.lat,t=r.lon,i=6378137,n=.00669438,a=.9996,s,o,h,l,u,f,c,p=Hs(e),d=Hs(t),v,_;_=Math.floor((t+180)/6)+1,t===180&&(_=60),e>=56&&e<64&&t>=3&&t<12&&(_=32),e>=72&&e<84&&(t>=0&&t<9?_=31:t>=9&&t<21?_=33:t>=21&&t<33?_=35:t>=33&&t<42&&(_=37)),s=(_-1)*6-180+3,v=Hs(s),o=n/(1-n),h=i/Math.sqrt(1-n*Math.sin(p)*Math.sin(p)),l=Math.tan(p)*Math.tan(p),u=o*Math.cos(p)*Math.cos(p),f=Math.cos(p)*(d-v),c=i*((1-n/4-3*n*n/64-5*n*n*n/256)*p-(3*n/8+3*n*n/32+45*n*n*n/1024)*Math.sin(2*p)+(15*n*n/256+45*n*n*n/1024)*Math.sin(4*p)-35*n*n*n/3072*Math.sin(6*p));var m=a*h*(f+(1-l+u)*f*f*f/6+(5-18*l+l*l+72*u-58*o)*f*f*f*f*f/120)+5e5,g=a*(c+h*Math.tan(p)*(f*f/2+(5-l+9*u+4*u*u)*f*f*f*f/24+(61-58*l+l*l+600*u-330*o)*f*f*f*f*f*f/720));return e<0&&(g+=1e7),{northing:Math.round(g),easting:Math.round(m),zoneNumber:_,zoneLetter:Lp(e)}}function Ks(r){var e=r.northing,t=r.easting,i=r.zoneLetter,n=r.zoneNumber;if(n<0||n>60)return null;var a=.9996,s=6378137,o=.00669438,h,l=(1-Math.sqrt(1-o))/(1+Math.sqrt(1-o)),u,f,c,p,d,v,_,m,g,y=t-5e5,x=e;i<"N"&&(x-=1e7),_=(n-1)*6-180+3,h=o/(1-o),v=x/a,m=v/(s*(1-o/4-3*o*o/64-5*o*o*o/256)),g=m+(3*l/2-27*l*l*l/32)*Math.sin(2*m)+(21*l*l/16-55*l*l*l*l/32)*Math.sin(4*m)+151*l*l*l/96*Math.sin(6*m),u=s/Math.sqrt(1-o*Math.sin(g)*Math.sin(g)),f=Math.tan(g)*Math.tan(g),c=h*Math.cos(g)*Math.cos(g),p=s*(1-o)/Math.pow(1-o*Math.sin(g)*Math.sin(g),1.5),d=y/(u*a);var E=g-u*Math.tan(g)/p*(d*d/2-(5+3*f+10*c-4*c*c-9*h)*d*d*d*d/24+(61+90*f+298*c+45*f*f-252*h-3*c*c)*d*d*d*d*d*d/720);E=Nl(E);var M=(d-(1+2*f+c)*d*d*d/6+(5-2*c+28*f-3*c*c+8*h+24*f*f)*d*d*d*d*d/120)/Math.cos(g);M=_+Nl(M);var C;if(r.accuracy){var T=Ks({northing:r.northing+r.accuracy,easting:r.easting+r.accuracy,zoneLetter:r.zoneLetter,zoneNumber:r.zoneNumber});C={top:T.lat,right:T.lon,bottom:E,left:M}}else C={lat:E,lon:M};return C}function Lp(r){var e="Z";return 84>=r&&r>=72?e="X":72>r&&r>=64?e="W":64>r&&r>=56?e="V":56>r&&r>=48?e="U":48>r&&r>=40?e="T":40>r&&r>=32?e="S":32>r&&r>=24?e="R":24>r&&r>=16?e="Q":16>r&&r>=8?e="P":8>r&&r>=0?e="N":0>r&&r>=-8?e="M":-8>r&&r>=-16?e="L":-16>r&&r>=-24?e="K":-24>r&&r>=-32?e="J":-32>r&&r>=-40?e="H":-40>r&&r>=-48?e="G":-48>r&&r>=-56?e="F":-56>r&&r>=-64?e="E":-64>r&&r>=-72?e="D":-72>r&&r>=-80&&(e="C"),e}function wp(r,e){var t="00000"+r.easting,i="00000"+r.northing;return r.zoneNumber+r.zoneLetter+Pp(r.easting,r.northing,r.zoneNumber)+t.substr(t.length-5,e)+i.substr(i.length-5,e)}function Pp(r,e,t){var i=Gl(t),n=Math.floor(r/1e5),a=Math.floor(e/1e5)%20;return Ap(n,a,i)}function Gl(r){var e=r%Al;return e===0&&(e=Al),e}function Ap(r,e,t){var i=t-1,n=bl.charCodeAt(i),a=jl.charCodeAt(i),s=n+r-1,o=a+e,h=!1;s>en&&(s=s-en+fr-1,h=!0),(s===Xt||n<Xt&&s>Xt||(s>Xt||n<Xt)&&h)&&s++,(s===ne||n<ne&&s>ne||(s>ne||n<ne)&&h)&&(s++,s===Xt&&s++),s>en&&(s=s-en+fr-1),o>tn?(o=o-tn+fr-1,h=!0):h=!1,(o===Xt||a<Xt&&o>Xt||(o>Xt||a<Xt)&&h)&&o++,(o===ne||a<ne&&o>ne||(o>ne||a<ne)&&h)&&(o++,o===Xt&&o++),o>tn&&(o=o-tn+fr-1);var l=String.fromCharCode(s)+String.fromCharCode(o);return l}function Dl(r){if(r&&r.length===0)throw"MGRSPoint coverting from nothing";for(var e=r.length,t=null,i="",n,a=0;!/[A-Z]/.test(n=r.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+r;i+=n,a++}var s=parseInt(i,10);if(a===0||a+3>e)throw"MGRSPoint bad conversion from: "+r;var o=r.charAt(a++);if(o<="A"||o==="B"||o==="Y"||o>="Z"||o==="I"||o==="O")throw"MGRSPoint zone letter "+o+" not handled: "+r;t=r.substring(a,a+=2);for(var h=Gl(s),l=bp(t.charAt(0),h),u=jp(t.charAt(1),h);u<Fp(o);)u+=2e6;var f=e-a;if(f%2!=0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+r;var c=f/2,p=0,d=0,v,_,m,g,y;return c>0&&(v=1e5/Math.pow(10,c),_=r.substring(a,a+c),p=parseFloat(_)*v,m=r.substring(a+c),d=parseFloat(m)*v),g=p+l,y=d+u,{easting:g,northing:y,zoneLetter:o,zoneNumber:s,accuracy:v}}function bp(r,e){for(var t=bl.charCodeAt(e-1),i=1e5,n=!1;t!==r.charCodeAt(0);){if(t++,t===Xt&&t++,t===ne&&t++,t>en){if(n)throw"Bad character: "+r;t=fr,n=!0}i+=1e5}return i}function jp(r,e){if(r>"V")throw"MGRSPoint given invalid Northing "+r;for(var t=jl.charCodeAt(e-1),i=0,n=!1;t!==r.charCodeAt(0);){if(t++,t===Xt&&t++,t===ne&&t++,t>tn){if(n)throw"Bad character: "+r;t=fr,n=!0}i+=1e5}return i}function Fp(r){var e;switch(r){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+r}function Dp(r){r("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),r("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),r("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),r.WGS84=r["EPSG:4326"],r["EPSG:3785"]=r["EPSG:3857"],r.GOOGLE=r["EPSG:3857"],r["EPSG:900913"]=r["EPSG:3857"],r["EPSG:102113"]=r["EPSG:3857"]}var Ri=1,wi=2,Ca=3,Np=4,$s=5,kl=6378137,Gp=6356752314e-3,Bl=.0066943799901413165,rn=484813681109536e-20,I=Math.PI/2,kp=.16666666666666666,Bp=.04722222222222222,Xp=.022156084656084655,L=1e-10,St=.017453292519943295,Le=57.29577951308232,it=Math.PI/4,nn=Math.PI*2,dt=3.14159265359,Ut={};Ut.greenwich=0;Ut.lisbon=-9.131906111111;Ut.paris=2.337229166667;Ut.bogota=-74.080916666667;Ut.madrid=-3.687938888889;Ut.rome=12.452333333333;Ut.bern=7.439583333333;Ut.jakarta=106.807719444444;Ut.ferro=-17.666666666667;Ut.brussels=4.367975;Ut.stockholm=18.058277777778;Ut.athens=23.7163375;Ut.oslo=10.722916666667;var Up={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},Xl=/[\s_\-\/\(\)]/g;function ci(r,e){if(r[e])return r[e];for(var t=Object.keys(r),i=e.toLowerCase().replace(Xl,""),n=-1,a,s;++n<t.length;)if(a=t[n],s=a.toLowerCase().replace(Xl,""),s===i)return r[a]}function Js(r){var e={},t=r.split("+").map(function(o){return o.trim()}).filter(function(o){return o}).reduce(function(o,h){var l=h.split("=");return l.push(!0),o[l[0].toLowerCase()]=l[1],o},{}),i,n,a,s={proj:"projName",datum:"datumCode",rf:function(o){e.rf=parseFloat(o)},lat_0:function(o){e.lat0=o*St},lat_1:function(o){e.lat1=o*St},lat_2:function(o){e.lat2=o*St},lat_ts:function(o){e.lat_ts=o*St},lon_0:function(o){e.long0=o*St},lon_1:function(o){e.long1=o*St},lon_2:function(o){e.long2=o*St},alpha:function(o){e.alpha=parseFloat(o)*St},gamma:function(o){e.rectified_grid_angle=parseFloat(o)},lonc:function(o){e.longc=o*St},x_0:function(o){e.x0=parseFloat(o)},y_0:function(o){e.y0=parseFloat(o)},k_0:function(o){e.k0=parseFloat(o)},k:function(o){e.k0=parseFloat(o)},a:function(o){e.a=parseFloat(o)},b:function(o){e.b=parseFloat(o)},r_a:function(){e.R_A=!0},zone:function(o){e.zone=parseInt(o,10)},south:function(){e.utmSouth=!0},towgs84:function(o){e.datum_params=o.split(",").map(function(h){return parseFloat(h)})},to_meter:function(o){e.to_meter=parseFloat(o)},units:function(o){e.units=o;var h=ci(Up,o);h&&(e.to_meter=h.to_meter)},from_greenwich:function(o){e.from_greenwich=o*St},pm:function(o){var h=ci(Ut,o);e.from_greenwich=(h||parseFloat(o))*St},nadgrids:function(o){o==="@null"?e.datumCode="none":e.nadgrids=o},axis:function(o){var h="ewnsud";o.length===3&&h.indexOf(o.substr(0,1))!==-1&&h.indexOf(o.substr(1,1))!==-1&&h.indexOf(o.substr(2,1))!==-1&&(e.axis=o)},approx:function(){e.approx=!0}};for(i in t)n=t[i],i in s?(a=s[i],typeof a=="function"?a(n):e[a]=n):e[i]=n;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}function Ft(r){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?Ft[r]=Js(arguments[1]):Ft[r]=Vs(arguments[1]):Ft[r]=t}else if(arguments.length===1){if(Array.isArray(r))return r.map(function(i){Array.isArray(i)?Ft.apply(e,i):Ft(i)});if(typeof r=="string"){if(r in Ft)return Ft[r]}else"EPSG"in r?Ft["EPSG:"+r.EPSG]=r:"ESRI"in r?Ft["ESRI:"+r.ESRI]=r:"IAU2000"in r?Ft["IAU2000:"+r.IAU2000]=r:console.log(r);return}}Dp(Ft);function zp(r){return typeof r=="string"}function Wp(r){return r in Ft}var Yp=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Vp(r){return Yp.some(function(e){return r.indexOf(e)>-1})}var Zp=["3857","900913","3785","102113"];function qp(r){var e=ci(r,"authority");if(!!e){var t=ci(e,"epsg");return t&&Zp.indexOf(t)>-1}}function Kp(r){var e=ci(r,"extension");if(!!e)return ci(e,"proj4")}function Hp(r){return r[0]==="+"}function $p(r){if(zp(r)){if(Wp(r))return Ft[r];if(Vp(r)){var e=Vs(r);if(qp(e))return Ft["EPSG:3857"];var t=Kp(e);return t?Js(t):e}if(Hp(r))return Js(r)}else return r}function Ul(r,e){r=r||{};var t,i;if(!e)return r;for(i in e)t=e[i],t!==void 0&&(r[i]=t);return r}function Pe(r,e,t){var i=r*e;return t/Math.sqrt(1-i*i)}function an(r){return r<0?-1:1}function b(r){return Math.abs(r)<=dt?r:r-an(r)*nn}function _e(r,e,t){var i=r*t,n=.5*r;return i=Math.pow((1-i)/(1+i),n),Math.tan(.5*(I-e))/i}function sn(r,e){for(var t=.5*r,i,n,a=I-2*Math.atan(e),s=0;s<=15;s++)if(i=r*Math.sin(a),n=I-2*Math.atan(e*Math.pow((1-i)/(1+i),t))-a,a+=n,Math.abs(n)<=1e-10)return a;return-9999}function Jp(){var r=this.b/this.a;this.es=1-r*r,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Pe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Qp(r){var e=r.x,t=r.y;if(t*Le>90&&t*Le<-90&&e*Le>180&&e*Le<-180)return null;var i,n;if(Math.abs(Math.abs(t)-I)<=L)return null;if(this.sphere)i=this.x0+this.a*this.k0*b(e-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(it+.5*t));else{var a=Math.sin(t),s=_e(this.e,t,a);i=this.x0+this.a*this.k0*b(e-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return r.x=i,r.y=n,r}function tv(r){var e=r.x-this.x0,t=r.y-this.y0,i,n;if(this.sphere)n=I-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var a=Math.exp(-t/(this.a*this.k0));if(n=sn(this.e,a),n===-9999)return null}return i=b(this.long0+e/(this.a*this.k0)),r.x=i,r.y=n,r}var ev=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],iv={init:Jp,forward:Qp,inverse:tv,names:ev};function rv(){}function zl(r){return r}var nv=["longlat","identity"],av={init:rv,forward:zl,inverse:zl,names:nv},sv=[iv,av],Sa={},Ia=[];function Wl(r,e){var t=Ia.length;return r.names?(Ia[t]=r,r.names.forEach(function(i){Sa[i.toLowerCase()]=t}),this):(console.log(e),!0)}function ov(r){if(!r)return!1;var e=r.toLowerCase();if(typeof Sa[e]!="undefined"&&Ia[Sa[e]])return Ia[Sa[e]]}function hv(){sv.forEach(Wl)}var lv={start:hv,add:Wl,get:ov},W={};W.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};W.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};W.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};W.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};W.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};W.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};W.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};W.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};W.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};W.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};W.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};W.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};W.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};W.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};W.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};W.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};W.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};W.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};W.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};W.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};W.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};W.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};W.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};W.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};W.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};W.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};W.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};W.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};W.hough={a:6378270,rf:297,ellipseName:"Hough"};W.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};W.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};W.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};W.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};W.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};W.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};W.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};W.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};W.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};W.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};W.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};W.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var uv=W.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};W.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function fv(r,e,t,i){var n=r*r,a=e*e,s=(n-a)/n,o=0;i?(r*=1-s*(kp+s*(Bp+s*Xp)),n=r*r,s=0):o=Math.sqrt(s);var h=(n-a)/a;return{es:s,e:o,ep2:h}}function cv(r,e,t,i,n){if(!r){var a=ci(W,i);a||(a=uv),r=a.a,e=a.b,t=a.rf}return t&&!e&&(e=(1-1/t)*r),(t===0||Math.abs(r-e)<L)&&(n=!0,e=r),{a:r,b:e,rf:t,sphere:n}}var Mt={};Mt.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};Mt.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};Mt.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};Mt.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};Mt.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};Mt.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};Mt.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};Mt.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};Mt.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};Mt.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};Mt.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};Mt.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};Mt.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};Mt.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};Mt.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};Mt.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};Mt.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function dv(r,e,t,i,n,a,s){var o={};return r===void 0||r==="none"?o.datum_type=$s:o.datum_type=Np,e&&(o.datum_params=e.map(parseFloat),(o.datum_params[0]!==0||o.datum_params[1]!==0||o.datum_params[2]!==0)&&(o.datum_type=Ri),o.datum_params.length>3&&(o.datum_params[3]!==0||o.datum_params[4]!==0||o.datum_params[5]!==0||o.datum_params[6]!==0)&&(o.datum_type=wi,o.datum_params[3]*=rn,o.datum_params[4]*=rn,o.datum_params[5]*=rn,o.datum_params[6]=o.datum_params[6]/1e6+1)),s&&(o.datum_type=Ca,o.grids=s),o.a=t,o.b=i,o.es=n,o.ep2=a,o}var Yl={};function mv(r,e){var t=new DataView(e),i=pv(t),n=vv(t,i);n.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var a=_v(t,n,i),s={header:n,subgrids:a};return Yl[r]=s,s}function yv(r){if(r===void 0)return null;var e=r.split(",");return e.map(gv)}function gv(r){if(r.length===0)return null;var e=r[0]==="@";return e&&(r=r.slice(1)),r==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:r,mandatory:!e,grid:Yl[r]||null,isNull:!1}}function cr(r){return r/3600*Math.PI/180}function pv(r){var e=r.getInt32(8,!1);return e===11?!1:(e=r.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function vv(r,e){return{nFields:r.getInt32(8,e),nSubgridFields:r.getInt32(24,e),nSubgrids:r.getInt32(40,e),shiftType:Qs(r,56,56+8).trim(),fromSemiMajorAxis:r.getFloat64(120,e),fromSemiMinorAxis:r.getFloat64(136,e),toSemiMajorAxis:r.getFloat64(152,e),toSemiMinorAxis:r.getFloat64(168,e)}}function Qs(r,e,t){return String.fromCharCode.apply(null,new Uint8Array(r.buffer.slice(e,t)))}function _v(r,e,t){for(var i=176,n=[],a=0;a<e.nSubgrids;a++){var s=Ev(r,i,t),o=Mv(r,i,s,t),h=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),l=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);n.push({ll:[cr(s.lowerLongitude),cr(s.lowerLatitude)],del:[cr(s.longitudeInterval),cr(s.latitudeInterval)],lim:[h,l],count:s.gridNodeCount,cvs:xv(o)})}return n}function xv(r){return r.map(function(e){return[cr(e.longitudeShift),cr(e.latitudeShift)]})}function Ev(r,e,t){return{name:Qs(r,e+8,e+16).trim(),parent:Qs(r,e+24,e+24+8).trim(),lowerLatitude:r.getFloat64(e+72,t),upperLatitude:r.getFloat64(e+88,t),lowerLongitude:r.getFloat64(e+104,t),upperLongitude:r.getFloat64(e+120,t),latitudeInterval:r.getFloat64(e+136,t),longitudeInterval:r.getFloat64(e+152,t),gridNodeCount:r.getInt32(e+168,t)}}function Mv(r,e,t,i){for(var n=e+176,a=16,s=[],o=0;o<t.gridNodeCount;o++){var h={latitudeShift:r.getFloat32(n+o*a,i),longitudeShift:r.getFloat32(n+o*a+4,i),latitudeAccuracy:r.getFloat32(n+o*a+8,i),longitudeAccuracy:r.getFloat32(n+o*a+12,i)};s.push(h)}return s}function Ae(r,e){if(!(this instanceof Ae))return new Ae(r);e=e||function(l){if(l)throw l};var t=$p(r);if(typeof t!="object"){e(r);return}var i=Ae.projections.get(t.projName);if(!i){e(r);return}if(t.datumCode&&t.datumCode!=="none"){var n=ci(Mt,t.datumCode);n&&(t.datum_params=t.datum_params||(n.towgs84?n.towgs84.split(","):null),t.ellps=n.ellipse,t.datumName=n.datumName?n.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var a=cv(t.a,t.b,t.rf,t.ellps,t.sphere),s=fv(a.a,a.b,a.rf,t.R_A),o=yv(t.nadgrids),h=t.datum||dv(t.datumCode,t.datum_params,a.a,a.b,s.es,s.ep2,o);Ul(this,t),Ul(this,i),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=h,this.init(),e(null,this)}Ae.projections=lv;Ae.projections.start();function Tv(r,e){return r.datum_type!==e.datum_type||r.a!==e.a||Math.abs(r.es-e.es)>5e-11?!1:r.datum_type===Ri?r.datum_params[0]===e.datum_params[0]&&r.datum_params[1]===e.datum_params[1]&&r.datum_params[2]===e.datum_params[2]:r.datum_type===wi?r.datum_params[0]===e.datum_params[0]&&r.datum_params[1]===e.datum_params[1]&&r.datum_params[2]===e.datum_params[2]&&r.datum_params[3]===e.datum_params[3]&&r.datum_params[4]===e.datum_params[4]&&r.datum_params[5]===e.datum_params[5]&&r.datum_params[6]===e.datum_params[6]:!0}function Vl(r,e,t){var i=r.x,n=r.y,a=r.z?r.z:0,s,o,h,l;if(n<-I&&n>-1.001*I)n=-I;else if(n>I&&n<1.001*I)n=I;else{if(n<-I)return{x:-Infinity,y:-Infinity,z:r.z};if(n>I)return{x:Infinity,y:Infinity,z:r.z}}return i>Math.PI&&(i-=2*Math.PI),o=Math.sin(n),l=Math.cos(n),h=o*o,s=t/Math.sqrt(1-e*h),{x:(s+a)*l*Math.cos(i),y:(s+a)*l*Math.sin(i),z:(s*(1-e)+a)*o}}function Zl(r,e,t,i){var n=1e-12,a=n*n,s=30,o,h,l,u,f,c,p,d,v,_,m,g,y,x=r.x,E=r.y,M=r.z?r.z:0,C,T,S;if(o=Math.sqrt(x*x+E*E),h=Math.sqrt(x*x+E*E+M*M),o/t<n){if(C=0,h/t<n)return T=I,S=-i,{x:r.x,y:r.y,z:r.z}}else C=Math.atan2(E,x);l=M/h,u=o/h,f=1/Math.sqrt(1-e*(2-e)*u*u),d=u*(1-e)*f,v=l*f,y=0;do y++,p=t/Math.sqrt(1-e*v*v),S=o*d+M*v-p*(1-e*v*v),c=e*p/(p+S),f=1/Math.sqrt(1-c*(2-c)*u*u),_=u*(1-c)*f,m=l*f,g=m*d-_*v,d=_,v=m;while(g*g>a&&y<s);return T=Math.atan(m/Math.abs(_)),{x:C,y:T,z:S}}function Cv(r,e,t){if(e===Ri)return{x:r.x+t[0],y:r.y+t[1],z:r.z+t[2]};if(e===wi){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],h=t[5],l=t[6];return{x:l*(r.x-h*r.y+o*r.z)+i,y:l*(h*r.x+r.y-s*r.z)+n,z:l*(-o*r.x+s*r.y+r.z)+a}}}function Sv(r,e,t){if(e===Ri)return{x:r.x-t[0],y:r.y-t[1],z:r.z-t[2]};if(e===wi){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],h=t[5],l=t[6],u=(r.x-i)/l,f=(r.y-n)/l,c=(r.z-a)/l;return{x:u+h*f-o*c,y:-h*u+f+s*c,z:o*u-s*f+c}}}function Oa(r){return r===Ri||r===wi}function Iv(r,e,t){if(Tv(r,e)||r.datum_type===$s||e.datum_type===$s)return t;var i=r.a,n=r.es;if(r.datum_type===Ca){var a=ql(r,!1,t);if(a!==0)return;i=kl,n=Bl}var s=e.a,o=e.b,h=e.es;if(e.datum_type===Ca&&(s=kl,o=Gp,h=Bl),n===h&&i===s&&!Oa(r.datum_type)&&!Oa(e.datum_type))return t;if(t=Vl(t,n,i),Oa(r.datum_type)&&(t=Cv(t,r.datum_type,r.datum_params)),Oa(e.datum_type)&&(t=Sv(t,e.datum_type,e.datum_params)),t=Zl(t,h,s,o),e.datum_type===Ca){var l=ql(e,!0,t);if(l!==0)return}return t}function ql(r,e,t){if(r.grids===null||r.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var i={x:-t.x,y:t.y},n={x:Number.NaN,y:Number.NaN},a=[],s=0;s<r.grids.length;s++){var o=r.grids[s];if(a.push(o.name),o.isNull){n=i;break}if(o.mandatory,o.grid===null){if(o.mandatory)return console.log("Unable to find mandatory grid '"+o.name+"'"),-1;continue}var h=o.grid.subgrids[0],l=(Math.abs(h.del[1])+Math.abs(h.del[0]))/1e4,u=h.ll[0]-l,f=h.ll[1]-l,c=h.ll[0]+(h.lim[0]-1)*h.del[0]+l,p=h.ll[1]+(h.lim[1]-1)*h.del[1]+l;if(!(f>i.y||u>i.x||p<i.y||c<i.x)&&(n=Ov(i,e,h),!isNaN(n.x)))break}return isNaN(n.x)?(console.log("Failed to find a grid shift table for location '"+-i.x*Le+" "+i.y*Le+" tried: '"+a+"'"),-1):(t.x=-n.x,t.y=n.y,0)}function Ov(r,e,t){var i={x:Number.NaN,y:Number.NaN};if(isNaN(r.x))return i;var n={x:r.x,y:r.y};n.x-=t.ll[0],n.y-=t.ll[1],n.x=b(n.x-Math.PI)+Math.PI;var a=Kl(n,t);if(e){if(isNaN(a.x))return i;a.x=n.x-a.x,a.y=n.y-a.y;var s=9,o=1e-12,h,l;do{if(l=Kl(a,t),isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}h={x:n.x-(l.x+a.x),y:n.y-(l.y+a.y)},a.x+=h.x,a.y+=h.y}while(s--&&Math.abs(h.x)>o&&Math.abs(h.y)>o);if(s<0)return console.log("Inverse grid shift iterator failed to converge."),i;i.x=b(a.x+t.ll[0]),i.y=a.y+t.ll[1]}else isNaN(a.x)||(i.x=r.x+a.x,i.y=r.y+a.y);return i}function Kl(r,e){var t={x:r.x/e.del[0],y:r.y/e.del[1]},i={x:Math.floor(t.x),y:Math.floor(t.y)},n={x:t.x-1*i.x,y:t.y-1*i.y},a={x:Number.NaN,y:Number.NaN},s;if(i.x<0||i.x>=e.lim[0]||i.y<0||i.y>=e.lim[1])return a;s=i.y*e.lim[0]+i.x;var o={x:e.cvs[s][0],y:e.cvs[s][1]};s++;var h={x:e.cvs[s][0],y:e.cvs[s][1]};s+=e.lim[0];var l={x:e.cvs[s][0],y:e.cvs[s][1]};s--;var u={x:e.cvs[s][0],y:e.cvs[s][1]},f=n.x*n.y,c=n.x*(1-n.y),p=(1-n.x)*(1-n.y),d=(1-n.x)*n.y;return a.x=p*o.x+c*h.x+d*u.x+f*l.x,a.y=p*o.y+c*h.y+d*u.y+f*l.y,a}function Hl(r,e,t){var i=t.x,n=t.y,a=t.z||0,s,o,h,l={};for(h=0;h<3;h++)if(!(e&&h===2&&t.z===void 0))switch(h===0?(s=i,"ew".indexOf(r.axis[h])!==-1?o="x":o="y"):h===1?(s=n,"ns".indexOf(r.axis[h])!==-1?o="y":o="x"):(s=a,o="z"),r.axis[h]){case"e":l[o]=s;break;case"w":l[o]=-s;break;case"n":l[o]=s;break;case"s":l[o]=-s;break;case"u":t[o]!==void 0&&(l.z=s);break;case"d":t[o]!==void 0&&(l.z=-s);break;default:return null}return l}function $l(r){var e={x:r[0],y:r[1]};return r.length>2&&(e.z=r[2]),r.length>3&&(e.m=r[3]),e}function Rv(r){Jl(r.x),Jl(r.y)}function Jl(r){if(typeof Number.isFinite=="function"){if(Number.isFinite(r))return;throw new TypeError("coordinates must be finite numbers")}if(typeof r!="number"||r!==r||!isFinite(r))throw new TypeError("coordinates must be finite numbers")}function wv(r,e){return(r.datum.datum_type===Ri||r.datum.datum_type===wi)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Ri||e.datum.datum_type===wi)&&r.datumCode!=="WGS84"}function Ra(r,e,t,i){var n;if(Array.isArray(t)&&(t=$l(t)),Rv(t),r.datum&&e.datum&&wv(r,e)&&(n=new Ae("WGS84"),t=Ra(r,n,t,i),r=n),i&&r.axis!=="enu"&&(t=Hl(r,!1,t)),r.projName==="longlat")t={x:t.x*St,y:t.y*St,z:t.z||0};else if(r.to_meter&&(t={x:t.x*r.to_meter,y:t.y*r.to_meter,z:t.z||0}),t=r.inverse(t),!t)return;if(r.from_greenwich&&(t.x+=r.from_greenwich),t=Iv(r.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*Le,y:t.y*Le,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),i&&e.axis!=="enu"?Hl(e,!0,t):t}var Ql=Ae("WGS84");function to(r,e,t,i){var n,a,s;return Array.isArray(t)?(n=Ra(r,e,t,i)||{x:NaN,y:NaN},t.length>2?typeof r.name!="undefined"&&r.name==="geocent"||typeof e.name!="undefined"&&e.name==="geocent"?typeof n.z=="number"?[n.x,n.y,n.z].concat(t.splice(3)):[n.x,n.y,t[2]].concat(t.splice(3)):[n.x,n.y].concat(t.splice(2)):[n.x,n.y]):(a=Ra(r,e,t,i),s=Object.keys(t),s.length===2||s.forEach(function(o){if(typeof r.name!="undefined"&&r.name==="geocent"||typeof e.name!="undefined"&&e.name==="geocent"){if(o==="x"||o==="y"||o==="z")return}else if(o==="x"||o==="y")return;a[o]=t[o]}),a)}function tu(r){return r instanceof Ae?r:r.oProj?r.oProj:Ae(r)}function Ht(r,e,t){r=tu(r);var i=!1,n;return typeof e=="undefined"?(e=r,r=Ql,i=!0):(typeof e.x!="undefined"||Array.isArray(e))&&(t=e,e=r,r=Ql,i=!0),e=tu(e),t?to(r,e,t):(n={forward:function(a,s){return to(r,e,a,s)},inverse:function(a,s){return to(e,r,a,s)}},i&&(n.oProj=e),n)}function dr(r,e,t){if(!(this instanceof dr))return new dr(r,e,t);if(Array.isArray(r))this.x=r[0],this.y=r[1],this.z=r[2]||0;else if(typeof r=="object")this.x=r.x,this.y=r.y,this.z=r.z||0;else if(typeof r=="string"&&typeof e=="undefined"){var i=r.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=r,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}dr.fromMGRS=function(r){return new dr(qs(r))};dr.prototype.toMGRS=function(r){return Zs([this.x,this.y],r)};var Lv=1,Pv=.25,eu=.046875,iu=.01953125,ru=.01068115234375,Av=.75,bv=.46875,jv=.013020833333333334,Fv=.007120768229166667,Dv=.3645833333333333,Nv=.005696614583333333,Gv=.3076171875;function nu(r){var e=[];e[0]=Lv-r*(Pv+r*(eu+r*(iu+r*ru))),e[1]=r*(Av-r*(eu+r*(iu+r*ru)));var t=r*r;return e[2]=t*(bv-r*(jv+r*Fv)),t*=r,e[3]=t*(Dv-r*Nv),e[4]=t*r*Gv,e}function wa(r,e,t,i){return t*=e,e*=e,i[0]*r-t*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}var kv=20;function au(r,e,t){for(var i=1/(1-e),n=r,a=kv;a;--a){var s=Math.sin(n),o=1-e*s*s;if(o=(wa(n,s,Math.cos(n),t)-r)*(o*Math.sqrt(o))*i,n-=o,Math.abs(o)<L)return n}return n}function Bv(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=nu(this.es),this.ml0=wa(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Xv(r){var e=r.x,t=r.y,i=b(e-this.long0),n,a,s,o=Math.sin(t),h=Math.cos(t);if(this.es){var u=h*i,f=Math.pow(u,2),c=this.ep2*Math.pow(h,2),p=Math.pow(c,2),d=Math.abs(h)>L?Math.tan(t):0,v=Math.pow(d,2),_=Math.pow(v,2);n=1-this.es*Math.pow(o,2),u=u/Math.sqrt(n);var m=wa(t,o,h,this.en);a=this.a*(this.k0*u*(1+f/6*(1-v+c+f/20*(5-18*v+_+14*c-58*v*c+f/42*(61+179*_-_*v-479*v)))))+this.x0,s=this.a*(this.k0*(m-this.ml0+o*i*u/2*(1+f/12*(5-v+9*c+4*p+f/30*(61+_-58*v+270*c-330*v*c+f/56*(1385+543*_-_*v-3111*v))))))+this.y0}else{var l=h*Math.sin(i);if(Math.abs(Math.abs(l)-1)<L)return 93;if(a=.5*this.a*this.k0*Math.log((1+l)/(1-l))+this.x0,s=h*Math.cos(i)/Math.sqrt(1-Math.pow(l,2)),l=Math.abs(s),l>=1){if(l-1>L)return 93;s=0}else s=Math.acos(s);t<0&&(s=-s),s=this.a*this.k0*(s-this.lat0)+this.y0}return r.x=a,r.y=s,r}function Uv(r){var e,t,i,n,a=(r.x-this.x0)*(1/this.a),s=(r.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,t=au(e,this.es,this.en),Math.abs(t)<I){var f=Math.sin(t),c=Math.cos(t),p=Math.abs(c)>L?Math.tan(t):0,d=this.ep2*Math.pow(c,2),v=Math.pow(d,2),_=Math.pow(p,2),m=Math.pow(_,2);e=1-this.es*Math.pow(f,2);var g=a*Math.sqrt(e)/this.k0,y=Math.pow(g,2);e=e*p,i=t-e*y/(1-this.es)*.5*(1-y/12*(5+3*_-9*d*_+d-4*v-y/30*(61+90*_-252*d*_+45*m+46*d-y/56*(1385+3633*_+4095*m+1574*m*_)))),n=b(this.long0+g*(1-y/6*(1+2*_+d-y/20*(5+28*_+24*m+8*d*_+6*d-y/42*(61+662*_+1320*m+720*m*_))))/c)}else i=I*an(s),n=0;else{var o=Math.exp(a/this.k0),h=.5*(o-1/o),l=this.lat0+s/this.k0,u=Math.cos(l);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(h,2))),i=Math.asin(e),s<0&&(i=-i),h===0&&u===0?n=0:n=b(Math.atan2(h,u)+this.long0)}return r.x=n,r.y=i,r}var zv=["Fast_Transverse_Mercator","Fast Transverse Mercator"],La={init:Bv,forward:Xv,inverse:Uv,names:zv};function su(r){var e=Math.exp(r);return e=(e-1/e)/2,e}function Pa(r,e){r=Math.abs(r),e=Math.abs(e);var t=Math.max(r,e),i=Math.min(r,e)/(t||1);return t*Math.sqrt(1+Math.pow(i,2))}function Wv(r){var e=1+r,t=e-1;return t===0?r:r*Math.log(e)/t}function Yv(r){var e=Math.abs(r);return e=Wv(e*(1+e/(Pa(1,e)+1))),r<0?-e:e}function eo(r,e){for(var t=2*Math.cos(2*e),i=r.length-1,n=r[i],a=0,s;--i>=0;)s=-a+t*n+r[i],a=n,n=s;return e+s*Math.sin(2*e)}function Vv(r,e){for(var t=2*Math.cos(e),i=r.length-1,n=r[i],a=0,s;--i>=0;)s=-a+t*n+r[i],a=n,n=s;return Math.sin(e)*s}function Zv(r){var e=Math.exp(r);return e=(e+1/e)/2,e}function ou(r,e,t){for(var i=Math.sin(e),n=Math.cos(e),a=su(t),s=Zv(t),o=2*n*s,h=-2*i*a,l=r.length-1,u=r[l],f=0,c=0,p=0,d,v;--l>=0;)d=c,v=f,c=u,f=p,u=-d+o*c-h*f+r[l],p=-v+h*c+o*f;return o=i*s,h=n*a,[o*u-h*p,o*p+h*u]}function qv(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(La.init.apply(this),this.forward=La.forward,this.inverse=La.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var r=this.es/(1+Math.sqrt(1-this.es)),e=r/(2-r),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var i=eo(this.cbg,this.lat0);this.Zb=-this.Qn*(i+Vv(this.gtu,2*i))}function Kv(r){var e=b(r.x-this.long0),t=r.y;t=eo(this.cbg,t);var i=Math.sin(t),n=Math.cos(t),a=Math.sin(e),s=Math.cos(e);t=Math.atan2(i,s*n),e=Math.atan2(a*n,Pa(i,n*s)),e=Yv(Math.tan(e));var o=ou(this.gtu,2*t,2*e);t=t+o[0],e=e+o[1];var h,l;return Math.abs(e)<=2.623395162778?(h=this.a*(this.Qn*e)+this.x0,l=this.a*(this.Qn*t+this.Zb)+this.y0):(h=Infinity,l=Infinity),r.x=h,r.y=l,r}function Hv(r){var e=(r.x-this.x0)*(1/this.a),t=(r.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var i,n;if(Math.abs(e)<=2.623395162778){var a=ou(this.utg,2*t,2*e);t=t+a[0],e=e+a[1],e=Math.atan(su(e));var s=Math.sin(t),o=Math.cos(t),h=Math.sin(e),l=Math.cos(e);t=Math.atan2(s*l,Pa(h,l*o)),e=Math.atan2(h,l*o),i=b(e+this.long0),n=eo(this.cgb,t)}else i=Infinity,n=Infinity;return r.x=i,r.y=n,r}var $v=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"],Aa={init:qv,forward:Kv,inverse:Hv,names:$v};function Jv(r,e){if(r===void 0){if(r=Math.floor((b(e)+Math.PI)*30/Math.PI)+1,r<0)return 0;if(r>60)return 60}return r}var Qv="etmerc";function t_(){var r=Jv(this.zone,this.long0);if(r===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(r)-183)*St,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Aa.init.apply(this),this.forward=Aa.forward,this.inverse=Aa.inverse}var e_=["Universal Transverse Mercator System","utm"],i_={init:t_,names:e_,dependsOn:Qv};function io(r,e){return Math.pow((1-r)/(1+r),e)}var r_=20;function n_(){var r=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*r*r),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(r/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+it)/(Math.pow(Math.tan(.5*this.lat0+it),this.C)*io(this.e*r,this.ratexp))}function a_(r){var e=r.x,t=r.y;return r.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+it),this.C)*io(this.e*Math.sin(t),this.ratexp))-I,r.x=this.C*e,r}function s_(r){for(var e=1e-14,t=r.x/this.C,i=r.y,n=Math.pow(Math.tan(.5*i+it)/this.K,1/this.C),a=r_;a>0&&(i=2*Math.atan(n*io(this.e*Math.sin(r.y),-.5*this.e))-I,!(Math.abs(i-r.y)<e));--a)r.y=i;return a?(r.x=t,r.y=i,r):null}var o_=["gauss"],ro={init:n_,forward:a_,inverse:s_,names:o_};function h_(){ro.init.apply(this),!!this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function l_(r){var e,t,i,n;return r.x=b(r.x-this.long0),ro.forward.apply(this,[r]),e=Math.sin(r.y),t=Math.cos(r.y),i=Math.cos(r.x),n=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*i),r.x=n*t*Math.sin(r.x),r.y=n*(this.cosc0*e-this.sinc0*t*i),r.x=this.a*r.x+this.x0,r.y=this.a*r.y+this.y0,r}function u_(r){var e,t,i,n,a;if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,a=Math.sqrt(r.x*r.x+r.y*r.y)){var s=2*Math.atan2(a,this.R2);e=Math.sin(s),t=Math.cos(s),n=Math.asin(t*this.sinc0+r.y*e*this.cosc0/a),i=Math.atan2(r.x*e,a*this.cosc0*t-r.y*this.sinc0*e)}else n=this.phic0,i=0;return r.x=i,r.y=n,ro.inverse.apply(this,[r]),r.x=b(r.x+this.long0),r}var f_=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],c_={init:h_,forward:l_,inverse:u_,names:f_};function d_(r,e,t){return e*=t,Math.tan(.5*(I+r))*Math.pow((1-e)/(1+e),.5*t)}function p_(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=L&&(this.k0=.5*(1+an(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=L&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=L&&(this.k0=.5*this.cons*Pe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/_e(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Pe(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-I,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function v_(r){var e=r.x,t=r.y,i=Math.sin(t),n=Math.cos(t),a,s,o,h,l,u,f=b(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=L&&Math.abs(t+this.lat0)<=L?(r.x=NaN,r.y=NaN,r):this.sphere?(a=2*this.k0/(1+this.sinlat0*i+this.coslat0*n*Math.cos(f)),r.x=this.a*a*n*Math.sin(f)+this.x0,r.y=this.a*a*(this.coslat0*i-this.sinlat0*n*Math.cos(f))+this.y0,r):(s=2*Math.atan(this.ssfn_(t,i,this.e))-I,h=Math.cos(s),o=Math.sin(s),Math.abs(this.coslat0)<=L?(l=_e(this.e,t*this.con,this.con*i),u=2*this.a*this.k0*l/this.cons,r.x=this.x0+u*Math.sin(e-this.long0),r.y=this.y0-this.con*u*Math.cos(e-this.long0),r):(Math.abs(this.sinlat0)<L?(a=2*this.a*this.k0/(1+h*Math.cos(f)),r.y=a*o):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*o+this.cosX0*h*Math.cos(f))),r.y=a*(this.cosX0*o-this.sinX0*h*Math.cos(f))+this.y0),r.x=a*h*Math.sin(f)+this.x0,r))}function __(r){r.x-=this.x0,r.y-=this.y0;var e,t,i,n,a,s=Math.sqrt(r.x*r.x+r.y*r.y);if(this.sphere){var o=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,t=this.lat0,s<=L?(r.x=e,r.y=t,r):(t=Math.asin(Math.cos(o)*this.sinlat0+r.y*Math.sin(o)*this.coslat0/s),Math.abs(this.coslat0)<L?this.lat0>0?e=b(this.long0+Math.atan2(r.x,-1*r.y)):e=b(this.long0+Math.atan2(r.x,r.y)):e=b(this.long0+Math.atan2(r.x*Math.sin(o),s*this.coslat0*Math.cos(o)-r.y*this.sinlat0*Math.sin(o))),r.x=e,r.y=t,r)}else if(Math.abs(this.coslat0)<=L){if(s<=L)return t=this.lat0,e=this.long0,r.x=e,r.y=t,r;r.x*=this.con,r.y*=this.con,i=s*this.cons/(2*this.a*this.k0),t=this.con*sn(this.e,i),e=this.con*b(this.con*this.long0+Math.atan2(r.x,-1*r.y))}else n=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=L?a=this.X0:(a=Math.asin(Math.cos(n)*this.sinX0+r.y*Math.sin(n)*this.cosX0/s),e=b(this.long0+Math.atan2(r.x*Math.sin(n),s*this.cosX0*Math.cos(n)-r.y*this.sinX0*Math.sin(n)))),t=-1*sn(this.e,Math.tan(.5*(I+a)));return r.x=e,r.y=t,r}var m_=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],g_={init:p_,forward:v_,inverse:__,names:m_,ssfn_:d_};function y_(){var r=this.lat0;this.lambda0=this.long0;var e=Math.sin(r),t=this.a,i=this.rf,n=1/i,a=2*n-Math.pow(n,2),s=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(e,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(r),4)),this.b0=Math.asin(e/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),h=Math.log(Math.tan(Math.PI/4+r/2)),l=Math.log((1+s*e)/(1-s*e));this.K=o-this.alpha*h+this.alpha*s/2*l}function x_(r){var e=Math.log(Math.tan(Math.PI/4-r.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(r.y))/(1-this.e*Math.sin(r.y))),i=-this.alpha*(e+t)+this.K,n=2*(Math.atan(Math.exp(i))-Math.PI/4),a=this.alpha*(r.x-this.lambda0),s=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(n)+Math.cos(this.b0)*Math.cos(a))),o=Math.asin(Math.cos(this.b0)*Math.sin(n)-Math.sin(this.b0)*Math.cos(n)*Math.cos(a));return r.y=this.R/2*Math.log((1+Math.sin(o))/(1-Math.sin(o)))+this.y0,r.x=this.R*s+this.x0,r}function E_(r){for(var e=r.x-this.x0,t=r.y-this.y0,i=e/this.R,n=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(n)+Math.sin(this.b0)*Math.cos(n)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(n))),o=this.lambda0+s/this.alpha,h=0,l=a,u=-1e3,f=0;Math.abs(l-u)>1e-7;){if(++f>20)return;h=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(h))-Math.PI/2}return r.x=o,r.y=l,r}var M_=["somerc"],T_={init:y_,forward:x_,inverse:E_,names:M_},pr=1e-7;function C_(r){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof r.PROJECTION=="object"?Object.keys(r.PROJECTION)[0]:r.PROJECTION;return"no_uoff"in r||"no_off"in r||e.indexOf(t)!==-1}function S_(){var r,e,t,i,n,a,s,o,h,l,u=0,f,c=0,p=0,d=0,v=0,_=0,m=0;this.no_off=C_(this),this.no_rot="no_rot"in this;var g=!1;"alpha"in this&&(g=!0);var y=!1;if("rectified_grid_angle"in this&&(y=!0),g&&(m=this.alpha),y&&(u=this.rectified_grid_angle*St),g||y)c=this.longc;else if(p=this.long1,v=this.lat1,d=this.long2,_=this.lat2,Math.abs(v-_)<=pr||(r=Math.abs(v))<=pr||Math.abs(r-I)<=pr||Math.abs(Math.abs(this.lat0)-I)<=pr||Math.abs(Math.abs(_)-I)<=pr)throw new Error;var x=1-this.es;e=Math.sqrt(x),Math.abs(this.lat0)>L?(o=Math.sin(this.lat0),t=Math.cos(this.lat0),r=1-this.es*o*o,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/x),this.A=this.B*this.k0*e/r,i=this.B*e/(t*Math.sqrt(r)),n=i*i-1,n<=0?n=0:(n=Math.sqrt(n),this.lat0<0&&(n=-n)),this.E=n+=i,this.E*=Math.pow(_e(this.e,this.lat0,o),this.B)):(this.B=1/e,this.A=this.k0,this.E=i=n=1),g||y?(g?(f=Math.asin(Math.sin(m)/i),y||(u=m)):(f=u,m=Math.asin(i*Math.sin(f))),this.lam0=c-Math.asin(.5*(n-1/n)*Math.tan(f))/this.B):(a=Math.pow(_e(this.e,v,Math.sin(v)),this.B),s=Math.pow(_e(this.e,_,Math.sin(_)),this.B),n=this.E/a,h=(s-a)/(s+a),l=this.E*this.E,l=(l-s*a)/(l+s*a),r=p-d,r<-Math.pi?d-=nn:r>Math.pi&&(d+=nn),this.lam0=b(.5*(p+d)-Math.atan(l*Math.tan(.5*this.B*(p-d))/h)/this.B),f=Math.atan(2*Math.sin(this.B*b(p-this.lam0))/(n-1/n)),u=m=Math.asin(i*Math.sin(f))),this.singam=Math.sin(f),this.cosgam=Math.cos(f),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(i*i-1)/Math.cos(m))),this.lat0<0&&(this.u_0=-this.u_0)),n=.5*f,this.v_pole_n=this.ArB*Math.log(Math.tan(it-n)),this.v_pole_s=this.ArB*Math.log(Math.tan(it+n))}function I_(r){var e={},t,i,n,a,s,o,h,l;if(r.x=r.x-this.lam0,Math.abs(Math.abs(r.y)-I)>L){if(s=this.E/Math.pow(_e(this.e,r.y,Math.sin(r.y)),this.B),o=1/s,t=.5*(s-o),i=.5*(s+o),a=Math.sin(this.B*r.x),n=(t*this.singam-a*this.cosgam)/i,Math.abs(Math.abs(n)-1)<L)throw new Error;l=.5*this.ArB*Math.log((1-n)/(1+n)),o=Math.cos(this.B*r.x),Math.abs(o)<pr?h=this.A*r.x:h=this.ArB*Math.atan2(t*this.cosgam+a*this.singam,o)}else l=r.y>0?this.v_pole_n:this.v_pole_s,h=this.ArB*r.y;return this.no_rot?(e.x=h,e.y=l):(h-=this.u_0,e.x=l*this.cosrot+h*this.sinrot,e.y=h*this.cosrot-l*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function O_(r){var e,t,i,n,a,s,o,h={};if(r.x=(r.x-this.x0)*(1/this.a),r.y=(r.y-this.y0)*(1/this.a),this.no_rot?(t=r.y,e=r.x):(t=r.x*this.cosrot-r.y*this.sinrot,e=r.y*this.cosrot+r.x*this.sinrot+this.u_0),i=Math.exp(-this.BrA*t),n=.5*(i-1/i),a=.5*(i+1/i),s=Math.sin(this.BrA*e),o=(s*this.cosgam+n*this.singam)/a,Math.abs(Math.abs(o)-1)<L)h.x=0,h.y=o<0?-I:I;else{if(h.y=this.E/Math.sqrt((1+o)/(1-o)),h.y=sn(this.e,Math.pow(h.y,1/this.B)),h.y===Infinity)throw new Error;h.x=-this.rB*Math.atan2(n*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return h.x+=this.lam0,h}var R_=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],w_={init:S_,forward:I_,inverse:O_,names:R_};function L_(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<L)){var r=this.b/this.a;this.e=Math.sqrt(1-r*r);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),i=Pe(this.e,e,t),n=_e(this.e,this.lat1,e),a=Math.sin(this.lat2),s=Math.cos(this.lat2),o=Pe(this.e,a,s),h=_e(this.e,this.lat2,a),l=_e(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>L?this.ns=Math.log(i/o)/Math.log(n/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(n,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function P_(r){var e=r.x,t=r.y;Math.abs(2*Math.abs(t)-Math.PI)<=L&&(t=an(t)*(I-2*L));var i=Math.abs(Math.abs(t)-I),n,a;if(i>L)n=_e(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(n,this.ns);else{if(i=t*this.ns,i<=0)return null;a=0}var s=this.ns*b(e-this.long0);return r.x=this.k0*(a*Math.sin(s))+this.x0,r.y=this.k0*(this.rh-a*Math.cos(s))+this.y0,r}function A_(r){var e,t,i,n,a,s=(r.x-this.x0)/this.k0,o=this.rh-(r.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+o*o),t=1):(e=-Math.sqrt(s*s+o*o),t=-1);var h=0;if(e!==0&&(h=Math.atan2(t*s,t*o)),e!==0||this.ns>0){if(t=1/this.ns,i=Math.pow(e/(this.a*this.f0),t),n=sn(this.e,i),n===-9999)return null}else n=-I;return a=b(h/this.ns+this.long0),r.x=a,r.y=n,r}var b_=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc"],j_={init:L_,forward:P_,inverse:A_,names:b_};function F_(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function D_(r){var e,t,i,n,a,s,o,h=r.x,l=r.y,u=b(h-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),i=-u*this.alfa,n=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(i)),a=Math.asin(Math.cos(t)*Math.sin(i)/Math.cos(n)),s=this.n*a,o=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(n/2+this.s45),this.n),r.y=o*Math.cos(s)/1,r.x=o*Math.sin(s)/1,this.czech||(r.y*=-1,r.x*=-1),r}function N_(r){var e,t,i,n,a,s,o,h,l=r.x;r.x=r.y,r.y=l,this.czech||(r.y*=-1,r.x*=-1),s=Math.sqrt(r.x*r.x+r.y*r.y),a=Math.atan2(r.y,r.x),n=a/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(n)),t=Math.asin(Math.cos(i)*Math.sin(n)/Math.cos(e)),r.x=this.long0-t/this.alfa,o=e,h=0;var u=0;do r.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-r.y)<1e-10&&(h=1),o=r.y,u+=1;while(h===0&&u<15);return u>=15?null:r}var G_=["Krovak","krovak"],k_={init:F_,forward:D_,inverse:N_,names:G_};function Dt(r,e,t,i,n){return r*n-e*Math.sin(2*n)+t*Math.sin(4*n)-i*Math.sin(6*n)}function on(r){return 1-.25*r*(1+r/16*(3+1.25*r))}function hn(r){return .375*r*(1+.25*r*(1+.46875*r))}function ln(r){return .05859375*r*r*(1+.75*r)}function un(r){return r*r*r*(35/3072)}function vr(r,e,t){var i=e*t;return r/Math.sqrt(1-i*i)}function _r(r){return Math.abs(r)<I?r:r-an(r)*Math.PI}function ba(r,e,t,i,n){var a,s;a=r/e;for(var o=0;o<15;o++)if(s=(r-(e*a-t*Math.sin(2*a)+i*Math.sin(4*a)-n*Math.sin(6*a)))/(e-2*t*Math.cos(2*a)+4*i*Math.cos(4*a)-6*n*Math.cos(6*a)),a+=s,Math.abs(s)<=1e-10)return a;return NaN}function B_(){this.sphere||(this.e0=on(this.es),this.e1=hn(this.es),this.e2=ln(this.es),this.e3=un(this.es),this.ml0=this.a*Dt(this.e0,this.e1,this.e2,this.e3,this.lat0))}function X_(r){var e,t,i=r.x,n=r.y;if(i=b(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(n)*Math.sin(i)),t=this.a*(Math.atan2(Math.tan(n),Math.cos(i))-this.lat0);else{var a=Math.sin(n),s=Math.cos(n),o=vr(this.a,this.e,a),h=Math.tan(n)*Math.tan(n),l=i*Math.cos(n),u=l*l,f=this.es*s*s/(1-this.es),c=this.a*Dt(this.e0,this.e1,this.e2,this.e3,n);e=o*l*(1-u*h*(1/6-(8-h+8*f)*u/120)),t=c-this.ml0+o*a/s*u*(.5+(5-h+6*f)*u/24)}return r.x=e+this.x0,r.y=t+this.y0,r}function U_(r){r.x-=this.x0,r.y-=this.y0;var e=r.x/this.a,t=r.y/this.a,i,n;if(this.sphere){var a=t+this.lat0;i=Math.asin(Math.sin(a)*Math.cos(e)),n=Math.atan2(Math.tan(e),Math.cos(a))}else{var s=this.ml0/this.a+t,o=ba(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(o)-I)<=L)return r.x=this.long0,r.y=I,t<0&&(r.y*=-1),r;var h=vr(this.a,this.e,Math.sin(o)),l=h*h*h/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(o),2),f=e*this.a/h,c=f*f;i=o-h*Math.tan(o)/l*f*f*(.5-(1+3*u)*f*f/24),n=f*(1-c*(u/3+(1+3*u)*u*c/15))/Math.cos(o)}return r.x=b(n+this.long0),r.y=_r(i),r}var z_=["Cassini","Cassini_Soldner","cass"],W_={init:B_,forward:X_,inverse:U_,names:z_};function di(r,e){var t;return r>1e-7?(t=r*e,(1-r*r)*(e/(1-t*t)-.5/r*Math.log((1-t)/(1+t)))):2*e}var Y_=1,V_=2,Z_=3,q_=4;function H_(){var r=Math.abs(this.lat0);if(Math.abs(r-I)<L?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(r)<L?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=di(this.e,1),this.mmf=.5/(1-this.es),this.apa=K_(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=di(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function $_(r){var e,t,i,n,a,s,o,h,l,u,f=r.x,c=r.y;if(f=b(f-this.long0),this.sphere){if(a=Math.sin(c),u=Math.cos(c),i=Math.cos(f),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+u*i:1+this.sinph0*a+this.cosph0*u*i,t<=L)return null;t=Math.sqrt(2/t),e=t*u*Math.sin(f),t*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*u*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(c+this.lat0)<L)return null;t=it-c*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(f),t*=i}}else{switch(o=0,h=0,l=0,i=Math.cos(f),n=Math.sin(f),a=Math.sin(c),s=di(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(o=s/this.qp,h=Math.sqrt(1-o*o)),this.mode){case this.OBLIQ:l=1+this.sinb1*o+this.cosb1*h*i;break;case this.EQUIT:l=1+h*i;break;case this.N_POLE:l=I+c,s=this.qp-s;break;case this.S_POLE:l=c-I,s=this.qp+s;break}if(Math.abs(l)<L)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),this.mode===this.OBLIQ?t=this.ymf*l*(this.cosb1*o-this.sinb1*h*i):t=(l=Math.sqrt(2/(1+h*i)))*o*this.ymf,e=this.xmf*l*h*n;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(l=Math.sqrt(s))*n,t=i*(this.mode===this.S_POLE?l:-l)):e=t=0;break}}return r.x=this.a*e+this.x0,r.y=this.a*t+this.y0,r}function Q_(r){r.x-=this.x0,r.y-=this.y0;var e=r.x/this.a,t=r.y/this.a,i,n,a,s,o,h,l;if(this.sphere){var u=0,f,c=0;if(f=Math.sqrt(e*e+t*t),n=f*.5,n>1)return null;switch(n=2*Math.asin(n),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=Math.sin(n),u=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(f)<=L?0:Math.asin(t*c/f),e*=c,t=u*f;break;case this.OBLIQ:n=Math.abs(f)<=L?this.lat0:Math.asin(u*this.sinph0+t*c*this.cosph0/f),e*=c*this.cosph0,t=(u-Math.sin(n)*this.sinph0)*f;break;case this.N_POLE:t=-t,n=I-n;break;case this.S_POLE:n-=I;break}i=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,h=Math.sqrt(e*e+t*t),h<L)return r.x=this.long0,r.y=this.lat0,r;s=2*Math.asin(.5*h/this.rq),a=Math.cos(s),e*=s=Math.sin(s),this.mode===this.OBLIQ?(l=a*this.sinb1+t*s*this.cosb1/h,o=this.qp*l,t=h*this.cosb1*a-t*this.sinb1*s):(l=t*s/h,o=this.qp*l,t=h*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),o=e*e+t*t,!o)return r.x=this.long0,r.y=this.lat0,r;l=1-o/this.qp,this.mode===this.S_POLE&&(l=-l)}i=Math.atan2(e,t),n=J_(Math.asin(l),this.apa)}return r.x=b(this.long0+i),r.y=n,r}var tm=.3333333333333333,em=.17222222222222222,im=.10257936507936508,rm=.06388888888888888,nm=.0664021164021164,am=.016415012942191543;function K_(r){var e,t=[];return t[0]=r*tm,e=r*r,t[0]+=e*em,t[1]=e*rm,e*=r,t[0]+=e*im,t[1]+=e*nm,t[2]=e*am,t}function J_(r,e){var t=r+r;return r+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var sm=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],om={init:H_,forward:$_,inverse:Q_,names:sm,S_POLE:Y_,N_POLE:V_,EQUIT:Z_,OBLIQ:q_};function pi(r){return Math.abs(r)>1&&(r=r>1?1:-1),Math.asin(r)}function hm(){Math.abs(this.lat1+this.lat2)<L||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Pe(this.e3,this.sin_po,this.cos_po),this.qs1=di(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Pe(this.e3,this.sin_po,this.cos_po),this.qs2=di(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=di(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>L?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function lm(r){var e=r.x,t=r.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var i=di(this.e3,this.sin_phi,this.cos_phi),n=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,a=this.ns0*b(e-this.long0),s=n*Math.sin(a)+this.x0,o=this.rh-n*Math.cos(a)+this.y0;return r.x=s,r.y=o,r}function um(r){var e,t,i,n,a,s;return r.x-=this.x0,r.y=this.rh-r.y+this.y0,this.ns0>=0?(e=Math.sqrt(r.x*r.x+r.y*r.y),i=1):(e=-Math.sqrt(r.x*r.x+r.y*r.y),i=-1),n=0,e!==0&&(n=Math.atan2(i*r.x,i*r.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(t=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,t)),a=b(n/this.ns0+this.long0),r.x=a,r.y=s,r}function fm(r,e){var t,i,n,a,s,o=pi(.5*e);if(r<L)return o;for(var h=r*r,l=1;l<=25;l++)if(t=Math.sin(o),i=Math.cos(o),n=r*t,a=1-n*n,s=.5*a*a/i*(e/(1-h)-t/a+.5/r*Math.log((1-n)/(1+n))),o=o+s,Math.abs(s)<=1e-7)return o;return null}var cm=["Albers_Conic_Equal_Area","Albers","aea"],dm={init:hm,forward:lm,inverse:um,names:cm,phi1z:fm};function pm(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function vm(r){var e,t,i,n,a,s,o,h,l=r.x,u=r.y;return i=b(l-this.long0),e=Math.sin(u),t=Math.cos(u),n=Math.cos(i),s=this.sin_p14*e+this.cos_p14*t*n,a=1,s>0||Math.abs(s)<=L?(o=this.x0+this.a*a*t*Math.sin(i)/s,h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*n)/s):(o=this.x0+this.infinity_dist*t*Math.sin(i),h=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*n)),r.x=o,r.y=h,r}function _m(r){var e,t,i,n,a,s;return r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,r.x/=this.k0,r.y/=this.k0,(e=Math.sqrt(r.x*r.x+r.y*r.y))?(n=Math.atan2(e,this.rc),t=Math.sin(n),i=Math.cos(n),s=pi(i*this.sin_p14+r.y*t*this.cos_p14/e),a=Math.atan2(r.x*t,e*this.cos_p14*i-r.y*this.sin_p14*t),a=b(this.long0+a)):(s=this.phic0,a=0),r.x=a,r.y=s,r}var mm=["gnom"],gm={init:pm,forward:vm,inverse:_m,names:mm};function ym(r,e){var t=1-(1-r*r)/(2*r)*Math.log((1-r)/(1+r));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*I:I;for(var i=Math.asin(.5*e),n,a,s,o,h=0;h<30;h++)if(a=Math.sin(i),s=Math.cos(i),o=r*a,n=Math.pow(1-o*o,2)/(2*s)*(e/(1-r*r)-a/(1-o*o)+.5/r*Math.log((1-o)/(1+o))),i+=n,Math.abs(n)<=1e-10)return i;return NaN}function xm(){this.sphere||(this.k0=Pe(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Em(r){var e=r.x,t=r.y,i,n,a=b(e-this.long0);if(this.sphere)i=this.x0+this.a*a*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var s=di(this.e,Math.sin(t));i=this.x0+this.a*this.k0*a,n=this.y0+this.a*s*.5/this.k0}return r.x=i,r.y=n,r}function Mm(r){r.x-=this.x0,r.y-=this.y0;var e,t;return this.sphere?(e=b(this.long0+r.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(r.y/this.a*Math.cos(this.lat_ts))):(t=ym(this.e,2*r.y*this.k0/this.a),e=b(this.long0+r.x/(this.a*this.k0))),r.x=e,r.y=t,r}var Tm=["cea"],Cm={init:xm,forward:Em,inverse:Mm,names:Tm};function Sm(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Im(r){var e=r.x,t=r.y,i=b(e-this.long0),n=_r(t-this.lat0);return r.x=this.x0+this.a*i*this.rc,r.y=this.y0+this.a*n,r}function Om(r){var e=r.x,t=r.y;return r.x=b(this.long0+(e-this.x0)/(this.a*this.rc)),r.y=_r(this.lat0+(t-this.y0)/this.a),r}var Rm=["Equirectangular","Equidistant_Cylindrical","eqc"],wm={init:Sm,forward:Im,inverse:Om,names:Rm},hu=20;function Lm(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=on(this.es),this.e1=hn(this.es),this.e2=ln(this.es),this.e3=un(this.es),this.ml0=this.a*Dt(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Pm(r){var e=r.x,t=r.y,i,n,a,s=b(e-this.long0);if(a=s*Math.sin(t),this.sphere)Math.abs(t)<=L?(i=this.a*s,n=-1*this.a*this.lat0):(i=this.a*Math.sin(a)/Math.tan(t),n=this.a*(_r(t-this.lat0)+(1-Math.cos(a))/Math.tan(t)));else if(Math.abs(t)<=L)i=this.a*s,n=-1*this.ml0;else{var o=vr(this.a,this.e,Math.sin(t))/Math.tan(t);i=o*Math.sin(a),n=this.a*Dt(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+o*(1-Math.cos(a))}return r.x=i+this.x0,r.y=n+this.y0,r}function Am(r){var e,t,i,n,a,s,o,h,l;if(i=r.x-this.x0,n=r.y-this.y0,this.sphere)if(Math.abs(n+this.a*this.lat0)<=L)e=b(i/this.a+this.long0),t=0;else{s=this.lat0+n/this.a,o=i*i/this.a/this.a+s*s,h=s;var u;for(a=hu;a;--a)if(u=Math.tan(h),l=-1*(s*(h*u+1)-h-.5*(h*h+o)*u)/((h-s)/u-1),h+=l,Math.abs(l)<=L){t=h;break}e=b(this.long0+Math.asin(i*Math.tan(h)/this.a)/Math.sin(t))}else if(Math.abs(n+this.ml0)<=L)t=0,e=b(this.long0+i/this.a);else{s=(this.ml0+n)/this.a,o=i*i/this.a/this.a+s*s,h=s;var f,c,p,d,v;for(a=hu;a;--a)if(v=this.e*Math.sin(h),f=Math.sqrt(1-v*v)*Math.tan(h),c=this.a*Dt(this.e0,this.e1,this.e2,this.e3,h),p=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),d=c/this.a,l=(s*(f*d+1)-d-.5*f*(d*d+o))/(this.es*Math.sin(2*h)*(d*d+o-2*s*d)/(4*f)+(s-d)*(f*p-2/Math.sin(2*h))-p),h-=l,Math.abs(l)<=L){t=h;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=b(this.long0+Math.asin(i*f/this.a)/Math.sin(t))}return r.x=e,r.y=t,r}var bm=["Polyconic","poly"],jm={init:Lm,forward:Pm,inverse:Am,names:bm};function Fm(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Dm(r){var e,t=r.x,i=r.y,n=i-this.lat0,a=t-this.long0,s=n/rn*1e-5,o=a,h=1,l=0;for(e=1;e<=10;e++)h=h*s,l=l+this.A[e]*h;var u=l,f=o,c=1,p=0,d,v,_=0,m=0;for(e=1;e<=6;e++)d=c*u-p*f,v=p*u+c*f,c=d,p=v,_=_+this.B_re[e]*c-this.B_im[e]*p,m=m+this.B_im[e]*c+this.B_re[e]*p;return r.x=m*this.a+this.x0,r.y=_*this.a+this.y0,r}function Nm(r){var e,t=r.x,i=r.y,n=t-this.x0,a=i-this.y0,s=a/this.a,o=n/this.a,h=1,l=0,u,f,c=0,p=0;for(e=1;e<=6;e++)u=h*s-l*o,f=l*s+h*o,h=u,l=f,c=c+this.C_re[e]*h-this.C_im[e]*l,p=p+this.C_im[e]*h+this.C_re[e]*l;for(var d=0;d<this.iterations;d++){var v=c,_=p,m,g,y=s,x=o;for(e=2;e<=6;e++)m=v*c-_*p,g=_*c+v*p,v=m,_=g,y=y+(e-1)*(this.B_re[e]*v-this.B_im[e]*_),x=x+(e-1)*(this.B_im[e]*v+this.B_re[e]*_);v=1,_=0;var E=this.B_re[1],M=this.B_im[1];for(e=2;e<=6;e++)m=v*c-_*p,g=_*c+v*p,v=m,_=g,E=E+e*(this.B_re[e]*v-this.B_im[e]*_),M=M+e*(this.B_im[e]*v+this.B_re[e]*_);var C=E*E+M*M;c=(y*E+x*M)/C,p=(x*E-y*M)/C}var T=c,S=p,P=1,O=0;for(e=1;e<=9;e++)P=P*T,O=O+this.D[e]*P;var w=this.lat0+O*rn*1e5,j=this.long0+S;return r.x=j,r.y=w,r}var Gm=["New_Zealand_Map_Grid","nzmg"],km={init:Fm,forward:Dm,inverse:Nm,names:Gm};function Bm(){}function Xm(r){var e=r.x,t=r.y,i=b(e-this.long0),n=this.x0+this.a*i,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return r.x=n,r.y=a,r}function Um(r){r.x-=this.x0,r.y-=this.y0;var e=b(this.long0+r.x/this.a),t=2.5*(Math.atan(Math.exp(.8*r.y/this.a))-Math.PI/4);return r.x=e,r.y=t,r}var zm=["Miller_Cylindrical","mill"],Wm={init:Bm,forward:Xm,inverse:Um,names:zm},Ym=20;function Vm(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=nu(this.es)}function Zm(r){var e,t,i=r.x,n=r.y;if(i=b(i-this.long0),this.sphere){if(!this.m)n=this.n!==1?Math.asin(this.n*Math.sin(n)):n;else for(var a=this.n*Math.sin(n),s=Ym;s;--s){var o=(this.m*n+Math.sin(n)-a)/(this.m+Math.cos(n));if(n-=o,Math.abs(o)<L)break}e=this.a*this.C_x*i*(this.m+Math.cos(n)),t=this.a*this.C_y*n}else{var h=Math.sin(n),l=Math.cos(n);t=this.a*wa(n,h,l,this.en),e=this.a*i*l/Math.sqrt(1-this.es*h*h)}return r.x=e,r.y=t,r}function qm(r){var e,t,i,n;return r.x-=this.x0,i=r.x/this.a,r.y-=this.y0,e=r.y/this.a,this.sphere?(e/=this.C_y,i=i/(this.C_x*(this.m+Math.cos(e))),this.m?e=pi((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=pi(Math.sin(e)/this.n)),i=b(i+this.long0),e=_r(e)):(e=au(r.y/this.a,this.es,this.en),n=Math.abs(e),n<I?(n=Math.sin(e),t=this.long0+r.x*Math.sqrt(1-this.es*n*n)/(this.a*Math.cos(e)),i=b(t)):n-L<I&&(i=this.long0)),r.x=i,r.y=e,r}var Km=["Sinusoidal","sinu"],Hm={init:Vm,forward:Zm,inverse:qm,names:Km};function $m(){}function Jm(r){for(var e=r.x,t=r.y,i=b(e-this.long0),n=t,a=Math.PI*Math.sin(t);;){var s=-(n+Math.sin(n)-a)/(1+Math.cos(n));if(n+=s,Math.abs(s)<L)break}n/=2,Math.PI/2-Math.abs(t)<L&&(i=0);var o=.900316316158*this.a*i*Math.cos(n)+this.x0,h=1.4142135623731*this.a*Math.sin(n)+this.y0;return r.x=o,r.y=h,r}function Qm(r){var e,t;r.x-=this.x0,r.y-=this.y0,t=r.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var i=b(this.long0+r.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var n=Math.asin(t);return r.x=i,r.y=n,r}var tg=["Mollweide","moll"],eg={init:$m,forward:Jm,inverse:Qm,names:tg};function ig(){Math.abs(this.lat1+this.lat2)<L||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=on(this.es),this.e1=hn(this.es),this.e2=ln(this.es),this.e3=un(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Pe(this.e,this.sinphi,this.cosphi),this.ml1=Dt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<L?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Pe(this.e,this.sinphi,this.cosphi),this.ml2=Dt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Dt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function rg(r){var e=r.x,t=r.y,i;if(this.sphere)i=this.a*(this.g-t);else{var n=Dt(this.e0,this.e1,this.e2,this.e3,t);i=this.a*(this.g-n)}var a=this.ns*b(e-this.long0),s=this.x0+i*Math.sin(a),o=this.y0+this.rh-i*Math.cos(a);return r.x=s,r.y=o,r}function ng(r){r.x-=this.x0,r.y=this.rh-r.y+this.y0;var e,t,i,n;this.ns>=0?(t=Math.sqrt(r.x*r.x+r.y*r.y),e=1):(t=-Math.sqrt(r.x*r.x+r.y*r.y),e=-1);var a=0;if(t!==0&&(a=Math.atan2(e*r.x,e*r.y)),this.sphere)return n=b(this.long0+a/this.ns),i=_r(this.g-t/this.a),r.x=n,r.y=i,r;var s=this.g-t/this.a;return i=ba(s,this.e0,this.e1,this.e2,this.e3),n=b(this.long0+a/this.ns),r.x=n,r.y=i,r}var ag=["Equidistant_Conic","eqdc"],sg={init:ig,forward:rg,inverse:ng,names:ag};function og(){this.R=this.a}function hg(r){var e=r.x,t=r.y,i=b(e-this.long0),n,a;Math.abs(t)<=L&&(n=this.x0+this.R*i,a=this.y0);var s=pi(2*Math.abs(t/Math.PI));(Math.abs(i)<=L||Math.abs(Math.abs(t)-I)<=L)&&(n=this.x0,t>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*s):a=this.y0+Math.PI*this.R*-Math.tan(.5*s));var o=.5*Math.abs(Math.PI/i-i/Math.PI),h=o*o,l=Math.sin(s),u=Math.cos(s),f=u/(l+u-1),c=f*f,p=f*(2/l-1),d=p*p,v=Math.PI*this.R*(o*(f-d)+Math.sqrt(h*(f-d)*(f-d)-(d+h)*(c-d)))/(d+h);i<0&&(v=-v),n=this.x0+v;var _=h+f;return v=Math.PI*this.R*(p*_-o*Math.sqrt((d+h)*(h+1)-_*_))/(d+h),t>=0?a=this.y0+v:a=this.y0-v,r.x=n,r.y=a,r}function lg(r){var e,t,i,n,a,s,o,h,l,u,f,c,p;return r.x-=this.x0,r.y-=this.y0,f=Math.PI*this.R,i=r.x/f,n=r.y/f,a=i*i+n*n,s=-Math.abs(n)*(1+a),o=s-2*n*n+i*i,h=-2*s+1+2*n*n+a*a,p=n*n/h+(2*o*o*o/h/h/h-9*s*o/h/h)/27,l=(s-o*o/3/h)/h,u=2*Math.sqrt(-l/3),f=3*p/l/u,Math.abs(f)>1&&(f>=0?f=1:f=-1),c=Math.acos(f)/3,r.y>=0?t=(-u*Math.cos(c+Math.PI/3)-o/3/h)*Math.PI:t=-(-u*Math.cos(c+Math.PI/3)-o/3/h)*Math.PI,Math.abs(i)<L?e=this.long0:e=b(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(i*i-n*n)+a*a))/2/i),r.x=e,r.y=t,r}var ug=["Van_der_Grinten_I","VanDerGrinten","vandg"],fg={init:og,forward:hg,inverse:lg,names:ug};function cg(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function dg(r){var e=r.x,t=r.y,i=Math.sin(r.y),n=Math.cos(r.y),a=b(e-this.long0),s,o,h,l,u,f,c,p,d,v,_,m,g,y,x,E,M,C,T,S,P,O,w;return this.sphere?Math.abs(this.sin_p12-1)<=L?(r.x=this.x0+this.a*(I-t)*Math.sin(a),r.y=this.y0-this.a*(I-t)*Math.cos(a),r):Math.abs(this.sin_p12+1)<=L?(r.x=this.x0+this.a*(I+t)*Math.sin(a),r.y=this.y0+this.a*(I+t)*Math.cos(a),r):(C=this.sin_p12*i+this.cos_p12*n*Math.cos(a),E=Math.acos(C),M=E?E/Math.sin(E):1,r.x=this.x0+this.a*M*n*Math.sin(a),r.y=this.y0+this.a*M*(this.cos_p12*i-this.sin_p12*n*Math.cos(a)),r):(s=on(this.es),o=hn(this.es),h=ln(this.es),l=un(this.es),Math.abs(this.sin_p12-1)<=L?(u=this.a*Dt(s,o,h,l,I),f=this.a*Dt(s,o,h,l,t),r.x=this.x0+(u-f)*Math.sin(a),r.y=this.y0-(u-f)*Math.cos(a),r):Math.abs(this.sin_p12+1)<=L?(u=this.a*Dt(s,o,h,l,I),f=this.a*Dt(s,o,h,l,t),r.x=this.x0+(u+f)*Math.sin(a),r.y=this.y0+(u+f)*Math.cos(a),r):(c=i/n,p=vr(this.a,this.e,this.sin_p12),d=vr(this.a,this.e,i),v=Math.atan((1-this.es)*c+this.es*p*this.sin_p12/(d*n)),_=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(v)-this.sin_p12*Math.cos(a)),_===0?T=Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v)):Math.abs(Math.abs(_)-Math.PI)<=L?T=-Math.asin(this.cos_p12*Math.sin(v)-this.sin_p12*Math.cos(v)):T=Math.asin(Math.sin(a)*Math.cos(v)/Math.sin(_)),m=this.e*this.sin_p12/Math.sqrt(1-this.es),g=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),y=m*g,x=g*g,S=T*T,P=S*T,O=P*T,w=O*T,E=p*T*(1-S*x*(1-x)/6+P/8*y*(1-2*x)+O/120*(x*(4-7*x)-3*m*m*(1-7*x))-w/48*y),r.x=this.x0+E*Math.sin(_),r.y=this.y0+E*Math.cos(_),r))}function pg(r){r.x-=this.x0,r.y-=this.y0;var e,t,i,n,a,s,o,h,l,u,f,c,p,d,v,_,m,g,y,x,E,M,C,T;return this.sphere?(e=Math.sqrt(r.x*r.x+r.y*r.y),e>2*I*this.a?void 0:(t=e/this.a,i=Math.sin(t),n=Math.cos(t),a=this.long0,Math.abs(e)<=L?s=this.lat0:(s=pi(n*this.sin_p12+r.y*i*this.cos_p12/e),o=Math.abs(this.lat0)-I,Math.abs(o)<=L?this.lat0>=0?a=b(this.long0+Math.atan2(r.x,-r.y)):a=b(this.long0-Math.atan2(-r.x,r.y)):a=b(this.long0+Math.atan2(r.x*i,e*this.cos_p12*n-r.y*this.sin_p12*i))),r.x=a,r.y=s,r)):(h=on(this.es),l=hn(this.es),u=ln(this.es),f=un(this.es),Math.abs(this.sin_p12-1)<=L?(c=this.a*Dt(h,l,u,f,I),e=Math.sqrt(r.x*r.x+r.y*r.y),p=c-e,s=ba(p/this.a,h,l,u,f),a=b(this.long0+Math.atan2(r.x,-1*r.y)),r.x=a,r.y=s,r):Math.abs(this.sin_p12+1)<=L?(c=this.a*Dt(h,l,u,f,I),e=Math.sqrt(r.x*r.x+r.y*r.y),p=e-c,s=ba(p/this.a,h,l,u,f),a=b(this.long0+Math.atan2(r.x,r.y)),r.x=a,r.y=s,r):(e=Math.sqrt(r.x*r.x+r.y*r.y),_=Math.atan2(r.x,r.y),d=vr(this.a,this.e,this.sin_p12),m=Math.cos(_),g=this.e*this.cos_p12*m,y=-g*g/(1-this.es),x=3*this.es*(1-y)*this.sin_p12*this.cos_p12*m/(1-this.es),E=e/d,M=E-y*(1+y)*Math.pow(E,3)/6-x*(1+3*y)*Math.pow(E,4)/24,C=1-y*M*M/2-E*M*M*M/6,v=Math.asin(this.sin_p12*Math.cos(M)+this.cos_p12*Math.sin(M)*m),a=b(this.long0+Math.asin(Math.sin(_)*Math.sin(M)/Math.cos(v))),T=Math.sin(v),s=Math.atan2((T-this.es*C*this.sin_p12)*Math.tan(v),T*(1-this.es)),r.x=a,r.y=s,r))}var vg=["Azimuthal_Equidistant","aeqd"],_g={init:cg,forward:dg,inverse:pg,names:vg};function mg(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function gg(r){var e,t,i,n,a,s,o,h,l=r.x,u=r.y;return i=b(l-this.long0),e=Math.sin(u),t=Math.cos(u),n=Math.cos(i),s=this.sin_p14*e+this.cos_p14*t*n,a=1,(s>0||Math.abs(s)<=L)&&(o=this.a*a*t*Math.sin(i),h=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*t*n)),r.x=o,r.y=h,r}function yg(r){var e,t,i,n,a,s,o;return r.x-=this.x0,r.y-=this.y0,e=Math.sqrt(r.x*r.x+r.y*r.y),t=pi(e/this.a),i=Math.sin(t),n=Math.cos(t),s=this.long0,Math.abs(e)<=L?(o=this.lat0,r.x=s,r.y=o,r):(o=pi(n*this.sin_p14+r.y*i*this.cos_p14/e),a=Math.abs(this.lat0)-I,Math.abs(a)<=L?(this.lat0>=0?s=b(this.long0+Math.atan2(r.x,-r.y)):s=b(this.long0-Math.atan2(-r.x,r.y)),r.x=s,r.y=o,r):(s=b(this.long0+Math.atan2(r.x*i,e*this.cos_p14*n-r.y*this.sin_p14*i)),r.x=s,r.y=o,r))}var xg=["ortho"],Eg={init:mg,forward:gg,inverse:yg,names:xg},ut={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},rt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Mg(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=I-it/2?this.face=ut.TOP:this.lat0<=-(I-it/2)?this.face=ut.BOTTOM:Math.abs(this.long0)<=it?this.face=ut.FRONT:Math.abs(this.long0)<=I+it?this.face=this.long0>0?ut.RIGHT:ut.LEFT:this.face=ut.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Tg(r){var e={x:0,y:0},t,i,n,a,s,o,h={value:0};if(r.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(r.y)):t=r.y,i=r.x,this.face===ut.TOP)a=I-t,i>=it&&i<=I+it?(h.value=rt.AREA_0,n=i-I):i>I+it||i<=-(I+it)?(h.value=rt.AREA_1,n=i>0?i-dt:i+dt):i>-(I+it)&&i<=-it?(h.value=rt.AREA_2,n=i+I):(h.value=rt.AREA_3,n=i);else if(this.face===ut.BOTTOM)a=I+t,i>=it&&i<=I+it?(h.value=rt.AREA_0,n=-i+I):i<it&&i>=-it?(h.value=rt.AREA_1,n=-i):i<-it&&i>=-(I+it)?(h.value=rt.AREA_2,n=-i-I):(h.value=rt.AREA_3,n=i>0?-i+dt:-i-dt);else{var l,u,f,c,p,d,v;this.face===ut.RIGHT?i=mr(i,+I):this.face===ut.BACK?i=mr(i,+dt):this.face===ut.LEFT&&(i=mr(i,-I)),c=Math.sin(t),p=Math.cos(t),d=Math.sin(i),v=Math.cos(i),l=p*v,u=p*d,f=c,this.face===ut.FRONT?(a=Math.acos(l),n=ja(a,f,u,h)):this.face===ut.RIGHT?(a=Math.acos(u),n=ja(a,f,-l,h)):this.face===ut.BACK?(a=Math.acos(-l),n=ja(a,f,-u,h)):this.face===ut.LEFT?(a=Math.acos(-u),n=ja(a,f,l,h)):(a=n=0,h.value=rt.AREA_0)}return o=Math.atan(12/dt*(n+Math.acos(Math.sin(n)*Math.cos(it))-I)),s=Math.sqrt((1-Math.cos(a))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(n))))),h.value===rt.AREA_1?o+=I:h.value===rt.AREA_2?o+=dt:h.value===rt.AREA_3&&(o+=1.5*dt),e.x=s*Math.cos(o),e.y=s*Math.sin(o),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,r.x=e.x,r.y=e.y,r}function Cg(r){var e={lam:0,phi:0},t,i,n,a,s,o,h,l,u,f={value:0};if(r.x=(r.x-this.x0)/this.a,r.y=(r.y-this.y0)/this.a,i=Math.atan(Math.sqrt(r.x*r.x+r.y*r.y)),t=Math.atan2(r.y,r.x),r.x>=0&&r.x>=Math.abs(r.y)?f.value=rt.AREA_0:r.y>=0&&r.y>=Math.abs(r.x)?(f.value=rt.AREA_1,t-=I):r.x<0&&-r.x>=Math.abs(r.y)?(f.value=rt.AREA_2,t=t<0?t+dt:t-dt):(f.value=rt.AREA_3,t+=I),u=dt/12*Math.tan(t),s=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),o=Math.atan(s),n=Math.cos(t),a=Math.tan(i),h=1-n*n*a*a*(1-Math.cos(Math.atan(1/Math.cos(o)))),h<-1?h=-1:h>1&&(h=1),this.face===ut.TOP)l=Math.acos(h),e.phi=I-l,f.value===rt.AREA_0?e.lam=o+I:f.value===rt.AREA_1?e.lam=o<0?o+dt:o-dt:f.value===rt.AREA_2?e.lam=o-I:e.lam=o;else if(this.face===ut.BOTTOM)l=Math.acos(h),e.phi=l-I,f.value===rt.AREA_0?e.lam=-o+I:f.value===rt.AREA_1?e.lam=-o:f.value===rt.AREA_2?e.lam=-o-I:e.lam=o<0?-o-dt:-o+dt;else{var c,p,d;c=h,u=c*c,u>=1?d=0:d=Math.sqrt(1-u)*Math.sin(o),u+=d*d,u>=1?p=0:p=Math.sqrt(1-u),f.value===rt.AREA_1?(u=p,p=-d,d=u):f.value===rt.AREA_2?(p=-p,d=-d):f.value===rt.AREA_3&&(u=p,p=d,d=-u),this.face===ut.RIGHT?(u=c,c=-p,p=u):this.face===ut.BACK?(c=-c,p=-p):this.face===ut.LEFT&&(u=c,c=p,p=-u),e.phi=Math.acos(-d)-I,e.lam=Math.atan2(p,c),this.face===ut.RIGHT?e.lam=mr(e.lam,-I):this.face===ut.BACK?e.lam=mr(e.lam,-dt):this.face===ut.LEFT&&(e.lam=mr(e.lam,+I))}if(this.es!==0){var v,_,m;v=e.phi<0?1:0,_=Math.tan(e.phi),m=this.b/Math.sqrt(_*_+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-m*m)/(this.one_minus_f*m)),v&&(e.phi=-e.phi)}return e.lam+=this.long0,r.x=e.lam,r.y=e.phi,r}function ja(r,e,t,i){var n;return r<L?(i.value=rt.AREA_0,n=0):(n=Math.atan2(e,t),Math.abs(n)<=it?i.value=rt.AREA_0:n>it&&n<=I+it?(i.value=rt.AREA_1,n-=I):n>I+it||n<=-(I+it)?(i.value=rt.AREA_2,n=n>=0?n-dt:n+dt):(i.value=rt.AREA_3,n+=I)),n}function mr(r,e){var t=r+e;return t<-dt?t+=nn:t>+dt&&(t-=nn),t}var Sg=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],Ig={init:Mg,forward:Tg,inverse:Cg,names:Sg},no=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],fn=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],lu=.8487,uu=1.3523,fu=Le/5,Og=1/fu,gr=18,Fa=function(r,e){return r[0]+e*(r[1]+e*(r[2]+e*r[3]))},Rg=function(r,e){return r[1]+e*(2*r[2]+e*3*r[3])};function wg(r,e,t,i){for(var n=e;i;--i){var a=r(n);if(n-=a,Math.abs(a)<t)break}return n}function Lg(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Pg(r){var e=b(r.x-this.long0),t=Math.abs(r.y),i=Math.floor(t*fu);i<0?i=0:i>=gr&&(i=gr-1),t=Le*(t-Og*i);var n={x:Fa(no[i],t)*e,y:Fa(fn[i],t)};return r.y<0&&(n.y=-n.y),n.x=n.x*this.a*lu+this.x0,n.y=n.y*this.a*uu+this.y0,n}function Ag(r){var e={x:(r.x-this.x0)/(this.a*lu),y:Math.abs(r.y-this.y0)/(this.a*uu)};if(e.y>=1)e.x/=no[gr][0],e.y=r.y<0?-I:I;else{var t=Math.floor(e.y*gr);for(t<0?t=0:t>=gr&&(t=gr-1);;)if(fn[t][0]>e.y)--t;else if(fn[t+1][0]<=e.y)++t;else break;var i=fn[t],n=5*(e.y-i[0])/(fn[t+1][0]-i[0]);n=wg(function(a){return(Fa(i,a)-e.y)/Rg(i,a)},n,L,100),e.x/=Fa(no[t],n),e.y=(5*t+n)*St,r.y<0&&(e.y=-e.y)}return e.x=b(e.x+this.long0),e}var bg=["Robinson","robin"],jg={init:Lg,forward:Pg,inverse:Ag,names:bg};function Fg(){this.name="geocent"}function Dg(r){var e=Vl(r,this.es,this.a);return e}function Ng(r){var e=Zl(r,this.es,this.a,this.b);return e}var Gg=["Geocentric","geocentric","geocent","Geocent"],kg={init:Fg,forward:Dg,inverse:Ng,names:Gg},Pt={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},cn={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Bg(){if(Object.keys(cn).forEach(function(t){if(typeof this[t]=="undefined")this[t]=cn[t].def;else{if(cn[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);cn[t].num&&(this[t]=parseFloat(this[t]))}cn[t].degrees&&(this[t]=this[t]*St)}.bind(this)),Math.abs(Math.abs(this.lat0)-I)<L?this.mode=this.lat0<0?Pt.S_POLE:Pt.N_POLE:Math.abs(this.lat0)<L?this.mode=Pt.EQUIT:(this.mode=Pt.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var r=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(r),this.sw=Math.sin(r)}function Xg(r){r.x-=this.long0;var e=Math.sin(r.y),t=Math.cos(r.y),i=Math.cos(r.x),n,a;switch(this.mode){case Pt.OBLIQ:a=this.sinph0*e+this.cosph0*t*i;break;case Pt.EQUIT:a=t*i;break;case Pt.S_POLE:a=-e;break;case Pt.N_POLE:a=e;break}switch(a=this.pn1/(this.p-a),n=a*t*Math.sin(r.x),this.mode){case Pt.OBLIQ:a*=this.cosph0*e-this.sinph0*t*i;break;case Pt.EQUIT:a*=e;break;case Pt.N_POLE:a*=-(t*i);break;case Pt.S_POLE:a*=t*i;break}var s,o;return s=a*this.cg+n*this.sg,o=1/(s*this.sw*this.h1+this.cw),n=(n*this.cg-a*this.sg)*this.cw*o,a=s*o,r.x=n*this.a,r.y=a*this.a,r}function Ug(r){r.x/=this.a,r.y/=this.a;var e={x:r.x,y:r.y},t,i,n;n=1/(this.pn1-r.y*this.sw),t=this.pn1*r.x*n,i=this.pn1*r.y*this.cw*n,r.x=t*this.cg+i*this.sg,r.y=i*this.cg-t*this.sg;var a=Pa(r.x,r.y);if(Math.abs(a)<L)e.x=0,e.y=r.y;else{var s,o;switch(o=1-a*a*this.pfact,o=(this.p-Math.sqrt(o))/(this.pn1/a+a/this.pn1),s=Math.sqrt(1-o*o),this.mode){case Pt.OBLIQ:e.y=Math.asin(s*this.sinph0+r.y*o*this.cosph0/a),r.y=(s-this.sinph0*Math.sin(e.y))*a,r.x*=o*this.cosph0;break;case Pt.EQUIT:e.y=Math.asin(r.y*o/a),r.y=s*a,r.x*=o;break;case Pt.N_POLE:e.y=Math.asin(s),r.y=-r.y;break;case Pt.S_POLE:e.y=-Math.asin(s);break}e.x=Math.atan2(r.x,r.y)}return r.x=e.x+this.long0,r.y=e.y,r}var zg=["Tilted_Perspective","tpers"],Wg={init:Bg,forward:Xg,inverse:Ug,names:zg};function Yg(r){r.Proj.projections.add(La),r.Proj.projections.add(Aa),r.Proj.projections.add(i_),r.Proj.projections.add(c_),r.Proj.projections.add(g_),r.Proj.projections.add(T_),r.Proj.projections.add(w_),r.Proj.projections.add(j_),r.Proj.projections.add(k_),r.Proj.projections.add(W_),r.Proj.projections.add(om),r.Proj.projections.add(dm),r.Proj.projections.add(gm),r.Proj.projections.add(Cm),r.Proj.projections.add(wm),r.Proj.projections.add(jm),r.Proj.projections.add(km),r.Proj.projections.add(Wm),r.Proj.projections.add(Hm),r.Proj.projections.add(eg),r.Proj.projections.add(sg),r.Proj.projections.add(fg),r.Proj.projections.add(_g),r.Proj.projections.add(Eg),r.Proj.projections.add(Ig),r.Proj.projections.add(jg),r.Proj.projections.add(kg),r.Proj.projections.add(Wg)}Ht.defaultDatum="WGS84";Ht.Proj=Ae;Ht.WGS84=new Ht.Proj("WGS84");Ht.Point=dr;Ht.toPoint=$l;Ht.defs=Ft;Ht.nadgrid=mv;Ht.transform=Ra;Ht.mgrs=Fl;Ht.version="__VERSION__";Yg(Ht);var ze=Ht;var Vg=new Ie({color:"rgba(0,0,0,0.2)",width:3}),cu=class extends fl{constructor(e){let t=e||{},i="zones"in t?t.zones:["34V","35V"];ze.defs(i.map(n=>{let a=n.replace(/\D+/g,"");return[`MGRS:${a}`,`+proj=utm +zone=${a} +datum=WGS84 +units=m +no_defs`]})),t.showLabels=!0,super(t),this.zones=i,this.gridZoneDesignatorLabels_=[],this.lineStyleBold_=new Ne({stroke:Vg}),this.zoneLabelStyleBase_=new Ne({text:new ir({font:"40px Calibri,sans-serif",textAlign:"center",fill:new xe({color:"rgba(0,0,0,0.2)"}),stroke:new Ie({color:"rgba(255,255,255,0)",width:0})})}),this.gridZoneLabelStyle_=function(n){let a=n.get("zone_label");return this.zoneLabelStyleBase_.getText().setText(a),this.zoneLabelStyleBase_}.bind(this)}loaderFunction(e,t,i){this.loadedExtent_=e;let n=this.getSource(),a=this.getExtent()||[-Infinity,-Infinity,Infinity,Infinity],s=qt(a,e);if(this.renderedExtent_&&Zt(this.renderedExtent_,s)||(this.renderedExtent_=s,Te(s)))return;let o=xt(s),h=t*t/4;(!this.projection_||!Vt(this.projection_,i))&&this.updateProjectionInfo_(i),this.createGraticule_(s,o,t,h);let u=this.meridians_.length+this.parallels_.length;this.meridiansLabels_&&(u+=this.meridians_.length),this.parallelsLabels_&&(u+=this.parallels_.length),this.gridZoneDesignatorLabels_&&(u+=this.gridZoneDesignatorLabels_.length);let f;for(;u>this.featurePool_.length;)f=new Gi,this.featurePool_.push(f);let c=n.getFeaturesCollection();c.clear();let p=0,d,v;for(d=0,v=this.meridians_.length;d<v;++d)f=this.featurePool_[p++],f.setGeometry(this.meridians_[d]),f.setStyle(this.meridians_[d].get("isGridZone")?this.lineStyleBold_:this.lineStyle_),c.push(f);for(d=0,v=this.parallels_.length;d<v;++d)f=this.featurePool_[p++],f.setGeometry(this.parallels_[d]),f.setStyle(this.parallels_[d].get("isGridZone")?this.lineStyleBold_:this.lineStyle_),c.push(f)}createGraticule_(e,t,i){let n=this.getInterval_(i);if(n==-1){this.meridians_.length=0,this.parallels_.length=0,console.log(feature),this.meridiansLabels_&&(this.meridiansLabels_.length=0),this.parallelsLabels_&&(this.parallelsLabels_.length=0);return}let a=!1,s=this.projection_.getExtent(),o=Z(s);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!wt(s,e)&&(Z(e)>=o?(e[0]=s[0],e[2]=s[2]):a=!0);let h=[A(t[0],this.minX_,this.maxX_),A(t[1],this.minY_,this.maxY_)],l=this.toLonLatTransform_(h);isNaN(l[1])&&(l[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);let u=A(l[0],this.minLon_,this.maxLon_),f=A(l[1],this.minLat_,this.maxLat_),c=e;a||(c=[A(e[0],this.minX_,this.maxX_),A(e[1],this.minY_,this.maxY_),A(e[2],this.minX_,this.maxX_),A(e[3],this.minY_,this.maxY_)]);let p=Hi(c,this.toLonLatTransform_,void 0,8),d=p[3],v=p[2],_=p[1],m=p[0];a||(mt(c,this.bottomLeft_)&&(m=this.minLon_,_=this.minLat_),mt(c,this.bottomRight_)&&(v=this.maxLon_,_=this.minLat_),mt(c,this.topLeft_)&&(m=this.minLon_,d=this.maxLat_),mt(c,this.topRight_)&&(v=this.maxLon_,d=this.maxLat_),d=A(d,f,this.maxLat_),v=A(v,u,this.maxLon_),_=A(_,this.minLat_,f),m=A(m,this.minLon_,u));let g=1e5;n===.5?g=5e4:n<=.2&&n>.05?g=1e4:n<=.05&&n>.01?g=5e3:n<=.01&&(g=1e3);let y=0,x=0,E=0;this.zones.forEach(M=>{let{numAddedMeridians:C,numAddedParallels:T,numAddedGridZoneLabels:S}=this.getZoneGraticule_(M,[m,_,v,d],g,y,x,E);y+=C,x+=T,E+=S}),this.meridians_.length=y,this.meridiansLabels_.length=y,this.parallels_.length=x,this.parallelsLabels_.length=x,this.gridZoneDesignatorLabels_.length=E}getZoneGraticule_(e,t,i,n,a,s){let o=e.slice(-1),h=e.slice(0,2),l=parseInt(h)*6-180,u=["N","P","Q","R","S","T","U","V","W"].indexOf(o)*8,[f,c]=[l-6,u+8],p=`MGRS:${h}`,d=[...ze("EPSG:4326",p,[t[0],t[1]]),...ze("EPSG:4326",p,[t[2],t[3]])],v=d[0]-d[0]%i-i,_=d[2]-d[2]%i+i,m=d[1]-d[1]%i-i,g=d[3]-d[3]%i+i,y=(_-v)/i,x=(g-m)/i,E=ze("EPSG:4326","EPSG:3857",[f,u]),M=ze("EPSG:4326","EPSG:3857",[l,c]),C=[...E,...M],T=0;for(;T<=y;T++){let O=[];for(let j=0;j<=x;j++){let Y=ze(p,"EPSG:3857",[v+i*T,m+i*j]);O.push([A(Y[0],E[0],M[0]),A(Y[1],E[1],M[1])])}let w=this.meridians_[T+n];w?(w.setCoordinates([O]),w.changed()):(w=new Ea([O],J.XY),this.meridians_.push(w)),w.set("isGridZone",(v+i*T)%1e5==0),this.meridiansLabels_&&(T+n in this.meridiansLabels_?this.meridiansLabels_[T+n].text=v+i*T:this.meridiansLabels_[T+n]={geom:new Se([]),text:v+i*T})}let S=0;for(;S<=x;S++){let O=[];for(let j=0;j<=y;j++){let[Y,B]=[v+i*j,m+i*S],U=ze(p,"EPSG:3857",[Y,B]),F=A(U[0],E[0],M[0]),$=A(U[1],E[1],M[1]),q=O.length>0&&O[O.length-1],et=q&&F.toPrecision(8)===q[0].toPrecision(8);q&&et?O.length===1&&(O[0]=[F,$]):O.push([F,$])}let w=this.parallels_[S+a];if(w?(w.setCoordinates([O]),w.changed()):(w=new Ea([O],J.XY),this.parallels_.push(w)),w.set("isGridZone",(m+i*S)%1e5==0),this.parallelsLabels_){let j=2;i===1e4?j=2:i===5e3?j=3:i===1e3&&(j=4);let Y=`${m+i*S}`.substring(-j);S+a in this.parallelsLabels_?this.parallelsLabels_[S+a].text=Y:this.parallelsLabels_[S+a]={geom:new Se([]),text:Y}}}let P=this.getZoneCodeLabels_(d,h,p,C,s);return{numAddedMeridians:T,numAddedParallels:S,numAddedGridZoneLabels:P}}getZoneCodeLabels_(e,t,i,n,a){let s=1e5,o=e[0]-e[0]%s,h=e[2]-e[2]%s,l=e[1]-e[1]%s,u=e[3]-e[3]%s,f=(h-o)/s,c=(u-l)/s,p=0;for(let d=0;d<=f;d++){let v=o+d*s,_=v+s/2,m=v<e[0],g=v+s>e[2];m&&g?_=(e[0]+e[2])/2:m?_=(o+s+e[0])/2:g&&(_=(v+e[2])/2);for(let y=0;y<=c;y++){let x=l+y*s,E=x+s/2,M=x<e[1],C=x+s>e[3];M&&C?E=(e[1]+e[3])/2:M?E=(l+s+e[1])/2:C&&(E=(x+e[3])/2);let T=ze(i,"EPSG:3857",[_,E]);if(!Yi(n,...T))continue;let S=A(T[0],n[0],n[2]),P=A(T[1],n[1],n[3]),O=this.getZoneCode_(_,E,+t),w=p+a;typeof this.gridZoneDesignatorLabels_[w]!="undefined"?(this.gridZoneDesignatorLabels_[w].text=O,this.gridZoneDesignatorLabels_[w].geom.setCoordinates([S,P])):this.gridZoneDesignatorLabels_[w]={geom:new Se([S,P]),text:O},p++}}return p}getZoneCode_(e,t,i){let n="ABCDEFGHJKLMNPQRSTUVWXYZ",a=["ABCDEFGH","JKLMNPQR","STUVWXYZ"],s=i%2==0,o=i%3;return a[o-1][+`${e}`[0]-1]+n[+`${t}`[1]+(s?5:0)]}drawLabels_(e){let t=e.frameState.viewState.rotation,i=e.frameState.extent,n=xt(i),a=i;if(t){let c=Z(i),p=ft(i),d=Math.abs(Math.cos(t)),v=Math.abs(Math.sin(t)),_=(v*p-d*c)/(v*v-d*d),m=(v*c-d*p)/(v*v-d*d);a=[n[0]-_/2,n[1]-m/2,n[0]+_/2,n[1]+m/2]}let s=0,o=0,h=this.latLabelPosition_<.5,l=this.projection_.getExtent(),u=Z(l);if(this.getSource().getWrapX()&&this.projection_.canWrapX()&&!wt(l,i)){s=Math.floor((i[0]-l[0])/u),o=Math.ceil((i[2]-l[2])/u);let c=Math.abs(t)>Math.PI/2;h=h!==c}let f=qr(e);for(let c=s;c<=o;++c){let p=this.meridians_.length+this.parallels_.length,d,v,_,m;if(this.meridiansLabels_)for(v=0,_=this.meridiansLabels_.length;v<_;++v){let g=this.meridians_[v];if(!t&&c===0)m=this.getMeridianPoint_(g,i,v);else{let y=g.clone();y.translate(c*u,0),y.rotate(-t,n),m=this.getMeridianPoint_(y,a,v),m.rotate(t,n)}d=this.featurePool_[p++],d.setGeometry(m),d.set("graticule_label",this.meridiansLabels_[v].text),f.drawFeature(d,this.lonLabelStyle_(d))}if(this.parallelsLabels_&&(c===s&&h||c===o&&!h))for(v=0,_=this.parallels_.length;v<_;++v){let g=this.parallels_[v];if(!t&&c===0)m=this.getParallelPoint_(g,i,v);else{let y=g.clone();y.translate(c*u,0),y.rotate(-t,n),m=this.getParallelPoint_(y,a,v),m.rotate(t,n)}d=this.featurePool_[p++],d.setGeometry(m),d.set("graticule_label",this.parallelsLabels_[v].text),f.drawFeature(d,this.latLabelStyle_(d))}if(this.gridZoneDesignatorLabels_){let g=[...this.gridZoneDesignatorLabels_];for(v=0,_=g.length;v<_;++v)d=this.featurePool_[p++],d.setGeometry(g[v].geom),d.set("zone_label",g[v].text),d.setStyle(this.gridZoneLabelStyle_),f.drawFeature(d,this.gridZoneLabelStyle_(d))}}}},du=cu;var Zg=[new Gs({source:new Il}),new du({showLabels:!0})],qg=new ve({center:qa([26.782902616310984,58.35466388765607]),zoom:10,projection:"EPSG:3857"}),zO=new Ds({target:"kaart",layers:Zg,view:qg});
//# sourceMappingURL=kaart.js.map
